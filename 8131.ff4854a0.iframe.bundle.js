/*! For license information please see 8131.ff4854a0.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkpassbolt_styleguide=self.webpackChunkpassbolt_styleguide||[]).push([[8131],{"./src/react-extension/components/Common/Inputs/Autocomplete/Autocomplete.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>Autocomplete_Autocomplete});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),dist=__webpack_require__("./node_modules/debounce-promise/dist/index.js"),dist_default=__webpack_require__.n(dist),UserAvatar=__webpack_require__("./src/react-extension/components/Common/Avatar/UserAvatar.js"),GroupAvatar=__webpack_require__("./src/react-extension/components/Common/Avatar/GroupAvatar.js"),userUtils=__webpack_require__("./src/shared/utils/userUtils.js"),es=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),AppContext=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),TooltipPortal=__webpack_require__("./src/react-extension/components/Common/Tooltip/TooltipPortal.js"),TooltipMessageFingerprintLoading=__webpack_require__("./src/react-extension/components/Common/Tooltip/TooltipMessageFingerprintLoading.js"),Fingerprint=__webpack_require__("./src/react-extension/components/Common/Fingerprint/Fingerprint.js"),fingerprint=__webpack_require__("./src/img/svg/fingerprint.svg");class AutocompleteItem extends react.Component{constructor(props){super(props),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{tooltipFingerprintMessage:null}}bindCallbacks(){this.handleClick=this.handleClick.bind(this),this.onTooltipFingerprintMouseHover=this.onTooltipFingerprintMouseHover.bind(this)}getTitle(){return this.props.user?`${this.props.user.profile.first_name} ${this.props.user.profile.last_name}`:`${this.props.group.name}`}getSubtitle(){return this.props.user?this.props.user.username:this.props.group?this.props.t("{{count}} group member",{count:this.props.group.user_count}):""}async onTooltipFingerprintMouseHover(){if(this.state.tooltipFingerprintMessage)return;const gpgkey=await this.props.context.port.request("passbolt.keyring.get-public-key-info-by-user",this.props.user.id),tooltipFingerprintMessage=react.createElement(Fingerprint.A,{fingerprint:gpgkey.fingerprint});this.setState({tooltipFingerprintMessage})}getClassName(){return this.props.selected?"row selected":"row"}handleClick(){this.props.onClick(this.props.id)}get isCurrentUserSuspended(){return this.props.canShowUserAsSuspended&&(0,userUtils.B7)(this.props.user)}render(){return react.createElement("li",{className:"autocomplete-item "+(this.isCurrentUserSuspended?"suspended":"")},react.createElement("div",{className:this.getClassName()},react.createElement("div",{className:"main-cell-wrapper"},react.createElement("div",{className:"main-cell "},react.createElement("button",{type:"button",className:"link no-border",onClick:this.handleClick},this.props.user&&react.createElement(UserAvatar.A,{user:this.props.user,baseUrl:this.props.baseUrl}),this.props.group&&react.createElement(GroupAvatar.A,{group:this.props.group}),react.createElement("div",{className:"user"},react.createElement("span",{className:"user-fullname-container"},react.createElement("span",{className:"name ellipsis"},this.getTitle(),this.isCurrentUserSuspended&&react.createElement("span",{className:"suspended"}," ",react.createElement(es.x6,null,"(suspended)"))),this.props.user&&react.createElement(TooltipPortal.A,{message:this.state.tooltipFingerprintMessage||react.createElement(TooltipMessageFingerprintLoading.A,null),onMouseHover:this.onTooltipFingerprintMouseHover},react.createElement(fingerprint.A,null))),react.createElement("span",{className:"details ellipsis"},this.getSubtitle())))))))}}AutocompleteItem.defaultProps={canShowUserAsSuspended:!1},AutocompleteItem.propTypes={context:prop_types_default().object,baseUrl:prop_types_default().string,id:prop_types_default().number,user:prop_types_default().object,group:prop_types_default().object,selected:prop_types_default().bool,onClick:prop_types_default().func,canShowUserAsSuspended:prop_types_default().bool.isRequired,t:prop_types_default().func};const Autocomplete_AutocompleteItem=(0,AppContext.L)((0,es.CI)("common")(AutocompleteItem));AutocompleteItem.__docgenInfo={description:"",methods:[{name:"defaultState",docblock:"Returns the component default state",modifiers:["get"],params:[],returns:null,description:"Returns the component default state"},{name:"bindCallbacks",docblock:"Bind callbacks methods\n@return {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Bind callbacks methods"},{name:"getTitle",docblock:"Get the item title\n@returns {string}",modifiers:[],params:[],returns:{type:{name:"string"}},description:"Get the item title"},{name:"getSubtitle",docblock:"Get the item subtitle\n@returns {string}",modifiers:[],params:[],returns:{type:{name:"string"}},description:"Get the item subtitle"},{name:"onTooltipFingerprintMouseHover",docblock:"Handle whenever the user passes its mouse hover the tooltip.\n@returns {Promise<JSX>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"JSX"}]}},description:"Handle whenever the user passes its mouse hover the tooltip."},{name:"getClassName",docblock:"Get the autocomplete item classname\n@returns {string}",modifiers:[],params:[],returns:{type:{name:"string"}},description:"Get the autocomplete item classname"},{name:"handleClick",docblock:"Handle click on an autocomplete item",modifiers:[],params:[],returns:null,description:"Handle click on an autocomplete item"},{name:"isCurrentUserSuspended",docblock:"Returns true if the disableUser feature is enabled and the user is suspended",modifiers:["get"],params:[],returns:null,description:"Returns true if the disableUser feature is enabled and the user is suspended"}],displayName:"AutocompleteItem",props:{canShowUserAsSuspended:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},context:{description:"",type:{name:"object"},required:!1},baseUrl:{description:"",type:{name:"string"},required:!1},id:{description:"",type:{name:"number"},required:!1},user:{description:"",type:{name:"object"},required:!1},group:{description:"",type:{name:"object"},required:!1},selected:{description:"",type:{name:"bool"},required:!1},onClick:{description:"",type:{name:"func"},required:!1},t:{description:"",type:{name:"func"},required:!1}}};class AutocompleteItemEmpty extends react.Component{render(){return react.createElement("li",null,react.createElement("div",{className:"row"},react.createElement("div",{className:"main-cell-wrapper"},react.createElement("div",{className:"main-cell"},react.createElement("p",null,"No one found")))))}}const Autocomplete_AutocompleteItemEmpty=AutocompleteItemEmpty;AutocompleteItemEmpty.__docgenInfo={description:"",methods:[],displayName:"AutocompleteItemEmpty"};var spinner=__webpack_require__("./src/img/svg/spinner.svg");class AutocompleteItemLoading extends react.Component{render(){return react.createElement("li",null,react.createElement("div",{className:"row loading"},react.createElement("div",{className:"main-cell-wrapper"},react.createElement("div",{className:"main-cell"},react.createElement("div",{className:"loading"},react.createElement(spinner.A,null)),react.createElement("div",{className:"info"},react.createElement("span",{className:"name"},"Loading..."),react.createElement("span",{className:"details"},"Please wait."))))))}}const Autocomplete_AutocompleteItemLoading=AutocompleteItemLoading;AutocompleteItemLoading.__docgenInfo={description:"",methods:[],displayName:"AutocompleteItemLoading"};class Autocomplete extends react.Component{constructor(props){super(props),this.bindCallbacks(),this.createInputRefs(),this.state=this.getDefaultState(),this.cache={},this.cacheExpiry=1e4}getDefaultState(){return{loading:!0,processing:!1,selected:null,autocompleteItems:null,name:"loading...",nameError:!1}}componentDidMount(){this.setState({loading:!1,name:""},()=>{this.inputRef.current.focus()}),document.addEventListener("keydown",this.handleKeyDown,{capture:!0})}componentDidUpdate(prevProps){prevProps.disabled!==this.props.disabled&&this.inputRef.current.focus()}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown,{capture:!0})}createInputRefs(){this.listRef=react.createRef(),this.inputRef=react.createRef()}bindCallbacks(){this.handleKeyDown=this.handleKeyDown.bind(this),this.selectNext=this.selectNext.bind(this),this.selectPrevious=this.selectPrevious.bind(this),this.handleAutocompleteChangeDebounced=dist_default()(this.handleAutocompleteChange.bind(this),300),this.handleSelect=this.handleSelect.bind(this),this.handleInputChange=this.handleInputChange.bind(this)}async getItems(keyword){return this.setState({processing:!0}),await this.props.searchCallback(keyword)}async autocompleteSearch(keyword){if(!this.cache[keyword]||this.cache[keyword].cacheExpiry<(new Date).getTime()){const results=await this.getItems(keyword);this.cache[keyword]=results,this.cache[keyword].cacheExpiry=(new Date).getTime()+this.cacheExpiry}return this.cache[keyword]}closeAutocomplete(){this.cache={},this.setState({processing:!1,autocompleteItems:null,selected:null}),this.props.onClose()}handleKeyDown(event){if(!this.state.disabled&&!this.state.processing&&null!==this.state.autocompleteItems){if(40===event.keyCode)return event.preventDefault(),void this.selectNext();if(38===event.keyCode)return event.preventDefault(),void this.selectPrevious();if(13===event.keyCode||9===event.keyCode){if(null===this.state.selected)return;event.preventDefault(),this.handleSelect(this.state.selected)}}}handleSelect(selected){const obj=this.state.autocompleteItems[selected];this.cache={},this.setState({name:""}),this.props.onSelect(obj),this.closeAutocomplete()}handleInputChange(event){const target=event.target,value="checkbox"===target.type?target.checked:target.value,name=target.name;this.setState({[name]:value}),"name"===name&&this.handleNameUpdate(value)}handleNameUpdate(value){value?value.endsWith(" ")||this.handleAutocompleteChangeDebounced(value):this.closeAutocomplete()}async handleAutocompleteChange(keyword){if(keyword)try{const autocompleteItems=await this.autocompleteSearch(keyword);let selected=null;if(autocompleteItems.length>0&&(selected=0),this.props.onOpen(),keyword===this.state.name)return new Promise(resolve=>{this.setState({autocompleteItems,processing:!1,selected},resolve())})}catch(error){console.error(error),this.closeAutocomplete(),this.setState({serviceError:error.message})}else this.closeAutocomplete()}selectPrevious(){0===this.state.selected||null===this.state.selected?this.setState({selected:this.state.autocompleteItems.length-1}):this.setState({selected:this.state.selected-1}),this.scrollToSelectedItem()}selectNext(){null===this.state.selected||this.state.selected===this.state.autocompleteItems.length-1?this.setState({selected:0}):this.setState({selected:this.state.selected+1}),this.scrollToSelectedItem()}isItemSelected(key){return null!==this.state.selected&&key===this.state.selected}getPlaceholder(){return this.props.disabled?"please wait...":this.props.placeholder}isInputDisabled(){return this.state.loading||this.props.disabled}scrollToSelectedItem(){if(this.state.autocompleteItems&&0!==this.state.autocompleteItems.length){const itemHeight=this.listRef.current.scrollHeight/this.state.autocompleteItems.length,visibleHeight=this.listRef.current.clientHeight,fitOffset=visibleHeight-itemHeight*Math.round(visibleHeight/itemHeight),currentItemPosition=itemHeight*this.state.selected,currentScroll=this.listRef.current.scrollTop;0===currentItemPosition?this.listRef.current.scrollTop=0:currentItemPosition-fitOffset<currentScroll?this.listRef.current.scrollTop=this.listRef.current.scrollTop-visibleHeight:currentItemPosition>currentScroll+visibleHeight&&(this.listRef.current.scrollTop=currentItemPosition)}else this.listRef.current.scrollTop=0}get shouldShowAutocompleteContent(){return Boolean(this.state.name&&(this.state.processing||this.state.autocompleteItems))}static get DISPLAY_LIMIT(){return 10}render(){return react.createElement("div",null,react.createElement("div",null,react.createElement("div",{className:`input text autocomplete ${this.isInputDisabled()?"disabled":""} ${this.shouldShowAutocompleteContent?"no-focus":""}`},react.createElement("label",{htmlFor:this.props.id},this.props.label),react.createElement("input",{id:this.props.id,name:this.props.name,ref:this.inputRef,maxLength:"64",type:"text",placeholder:this.getPlaceholder(),autoComplete:"off",value:this.state.name,disabled:this.isInputDisabled(),onChange:this.handleInputChange})),this.shouldShowAutocompleteContent&&react.createElement("div",{className:"autocomplete-wrapper"},react.createElement("div",{className:"autocomplete-content scroll",ref:this.listRef},react.createElement("ul",null,this.state.processing&&this.state.name&&react.createElement(Autocomplete_AutocompleteItemLoading,null),!this.state.processing&&(!this.state.autocompleteItems||!this.state.autocompleteItems.length)&&react.createElement(Autocomplete_AutocompleteItemEmpty,null),!this.state.processing&&this.state.autocompleteItems&&this.state.autocompleteItems.map((item,key)=>item.username?react.createElement(Autocomplete_AutocompleteItem,{key,id:key,onClick:this.handleSelect,baseUrl:this.props.baseUrl,canShowUserAsSuspended:this.props.canShowUserAsSuspended,user:item,selected:this.isItemSelected(key)}):react.createElement(Autocomplete_AutocompleteItem,{key,id:key,group:item,selected:this.isItemSelected(key),onClick:this.handleSelect,baseUrl:this.props.baseUrl})))))))}}Autocomplete.defaultProps={canShowUserAsSuspended:!1},Autocomplete.propTypes={baseUrl:prop_types_default().string,id:prop_types_default().string,searchCallback:prop_types_default().func,onSelect:prop_types_default().func,onOpen:prop_types_default().func,onClose:prop_types_default().func,label:prop_types_default().string,disabled:prop_types_default().bool,name:prop_types_default().string,placeholder:prop_types_default().string,canShowUserAsSuspended:prop_types_default().bool.isRequired};const Autocomplete_Autocomplete=Autocomplete;Autocomplete.__docgenInfo={description:"",methods:[{name:"getDefaultState",docblock:"getDefaultState\n@return {object}",modifiers:[],params:[],returns:{type:{name:"object"}},description:"getDefaultState"},{name:"createInputRefs",docblock:"Create references\n@returns {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Create references"},{name:"bindCallbacks",docblock:"Bind callbacks methods\n@return {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Bind callbacks methods"},{name:"getItems",docblock:"Retrieve the items to display based on a keyword\n@param {string} keyword The keyword to search for\n@returns {Promise<void>}",modifiers:["async"],params:[{name:"keyword",description:"The keyword to search for",type:{name:"string"},optional:!1}],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Retrieve the items to display based on a keyword"},{name:"autocompleteSearch",docblock:"Retrieve the items to display based on keywords.\nCheck in the cache first, or plan a search call.\n@param {string} keyword The keyword to search for\n@returns {Promise<*>}",modifiers:["async"],params:[{name:"keyword",description:"The keyword to search for",type:{name:"string"},optional:!1}],returns:{type:{name:"Promise",elements:[{name:"mixed"}]}},description:"Retrieve the items to display based on keywords.\nCheck in the cache first, or plan a search call."},{name:"closeAutocomplete",docblock:"Close the autocomplete area\n@return {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Close the autocomplete area"},{name:"handleKeyDown",docblock:"Handle the user key down\n@param {ReactEvent} event The triggered event\n@return {void}",modifiers:[],params:[{name:"event",description:"The triggered event",type:{name:"ReactEvent"},optional:!1}],returns:{type:{name:"void"}},description:"Handle the user key down"},{name:"handleSelect",docblock:"Handle a suggested item selection\n@param {Object} selected The selected item\n@return {void}",modifiers:[],params:[{name:"selected",description:"The selected item",type:{name:"Object"},optional:!1}],returns:{type:{name:"void"}},description:"Handle a suggested item selection"},{name:"handleInputChange",docblock:"Handle the search input change\n@param {ReactEvent} event The triggered event\n@return {void}",modifiers:[],params:[{name:"event",description:"The triggered event",type:{name:"ReactEvent"},optional:!1}],returns:{type:{name:"void"}},description:"Handle the search input change"},{name:"handleNameUpdate",docblock:"Handle name update\n@param {string} value\n@return {void}",modifiers:[],params:[{name:"value",type:{name:"string"},optional:!1}],returns:{type:{name:"void"}},description:"Handle name update"},{name:"handleAutocompleteChange",docblock:"Handle autocomplete change\n@param {string} searchedName\n@returns {Promise<void>}",modifiers:["async"],params:[{name:"keyword",optional:!1}],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Handle autocomplete change"},{name:"selectPrevious",docblock:"Select previous item in the list\n@return {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Select previous item in the list"},{name:"selectNext",docblock:"Select next item in the list\n@return {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Select next item in the list"},{name:"isItemSelected",docblock:"Check if an item is selected\n@param {int} key the item key to look for\n@returns {boolean}",modifiers:[],params:[{name:"key",description:"the item key to look for",type:{name:"int"},optional:!1}],returns:{type:{name:"boolean"}},description:"Check if an item is selected"},{name:"getPlaceholder",docblock:"Get the loading placeholder.\n@returns {string}",modifiers:[],params:[],returns:{type:{name:"string"}},description:"Get the loading placeholder."},{name:"isInputDisabled",docblock:"Check if the input search is disabled.\n@returns {Boolean}",modifiers:[],params:[],returns:{type:{name:"Boolean"}},description:"Check if the input search is disabled."},{name:"scrollToSelectedItem",docblock:"Scroll to the selected item\n@return {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Scroll to the selected item"},{name:"shouldShowAutocompleteContent",docblock:"Should show autocomplete content\n@returns {boolean}",modifiers:["get"],params:[],returns:{type:{name:"boolean"}},description:"Should show autocomplete content"},{name:"DISPLAY_LIMIT",docblock:"Returns the maximum count of element the autocomplete list should display.\n@returns {integer}",modifiers:["static","get"],params:[],returns:{type:{name:"integer"}},description:"Returns the maximum count of element the autocomplete list should display."}],displayName:"Autocomplete",props:{canShowUserAsSuspended:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},baseUrl:{description:"",type:{name:"string"},required:!1},id:{description:"",type:{name:"string"},required:!1},searchCallback:{description:"",type:{name:"func"},required:!1},onSelect:{description:"",type:{name:"func"},required:!1},onOpen:{description:"",type:{name:"func"},required:!1},onClose:{description:"",type:{name:"func"},required:!1},label:{description:"",type:{name:"string"},required:!1},disabled:{description:"",type:{name:"bool"},required:!1},name:{description:"",type:{name:"string"},required:!1},placeholder:{description:"",type:{name:"string"},required:!1}}}},"./src/react-extension/components/Common/Inputs/FormSubmitButton/FormCancelButton.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__),react_i18next__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js");class FormCancelButton extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.bindCallbacks()}bindCallbacks(){this.handleClick=this.handleClick.bind(this)}handleClick(){this.props.disabled||this.props.onClick()}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{type:"button",disabled:this.props.disabled,className:"link cancel",onClick:this.handleClick},this.props.value)}}FormCancelButton.defaultProps={value:react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_2__.x6,null,"Cancel")},FormCancelButton.propTypes={disabled:prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool,onClick:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func,value:prop_types__WEBPACK_IMPORTED_MODULE_1___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_1___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_1___default().node),prop_types__WEBPACK_IMPORTED_MODULE_1___default().node,prop_types__WEBPACK_IMPORTED_MODULE_1___default().string])};const __WEBPACK_DEFAULT_EXPORT__=(0,react_i18next__WEBPACK_IMPORTED_MODULE_2__.CI)("common")(FormCancelButton);FormCancelButton.__docgenInfo={description:"",methods:[{name:"bindCallbacks",docblock:"Bind callbacks methods\n@return {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Bind callbacks methods"},{name:"handleClick",docblock:"Handle cancel click\n@return {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Handle cancel click"}],displayName:"FormCancelButton",props:{value:{defaultValue:{value:"<Trans>Cancel</Trans>",computed:!1},description:"",type:{name:"union",value:[{name:"arrayOf",value:{name:"node"}},{name:"node"},{name:"string"}]},required:!1},disabled:{description:"",type:{name:"bool"},required:!1},onClick:{description:"",type:{name:"func"},required:!1}}}}}]);