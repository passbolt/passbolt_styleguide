/*! For license information please see react-extension-components-Administration-DisplaySecretHistoryAdministration-DisplaySecretHistoryAdministration-test-stories.cca033a8.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkpassbolt_styleguide=self.webpackChunkpassbolt_styleguide||[]).push([[7011],{"./src/react-extension/components/Administration/DisplaySecretHistoryAdministration/DisplaySecretHistoryAdministration.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var prop_types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),react_i18next__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),memoize_one__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/memoize-one/dist/memoize-one.esm.js"),_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),_Common_Error_NotifyError_NotifyError__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/react-extension/components/Common/Error/NotifyError/NotifyError.js"),_contexts_DialogContext__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/react-extension/contexts/DialogContext.js"),_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/react-extension/contexts/ActionFeedbackContext.js"),_shared_services_serviceWorker_secretRevision_secretRevisionsSettingsServiceWorkerService__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/shared/services/serviceWorker/secretRevision/secretRevisionsSettingsServiceWorkerService.js"),_shared_models_entity_secretRevision_secretRevisionsSettingsEntity__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./src/shared/models/entity/secretRevision/secretRevisionsSettingsEntity.js");class DisplaySecretHistoryAdministration extends react__WEBPACK_IMPORTED_MODULE_1__.Component{originalSettings=null;formSettings=null;constructor(props){super(props),this.secretRevisionsSettingsServiceWorkerService=new _shared_services_serviceWorker_secretRevision_secretRevisionsSettingsServiceWorkerService__WEBPACK_IMPORTED_MODULE_8__.Ay(props.context.port),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{isProcessing:!0,hasAlreadyBeenValidated:!1,isFeatureEnabled:!1,settings:{}}}bindCallbacks(){this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleEnableFeature=this.handleEnableFeature.bind(this),this.save=this.save.bind(this)}async componentDidMount(){this.originalSettings=await this.secretRevisionsSettingsServiceWorkerService.findSettings(),this.formSettings=new _shared_models_entity_secretRevision_secretRevisionsSettingsEntity__WEBPACK_IMPORTED_MODULE_9__.A(this.originalSettings.toDto(),{validate:!1});const settings=this.formSettings.toDto();this.setState({settings,isFeatureEnabled:this.originalSettings.isFeatureEnabled,isProcessing:!1})}validateForm=(0,memoize_one__WEBPACK_IMPORTED_MODULE_3__.A)(formSettingsDto=>this.formSettings?.validate());hasSettingsChanges=(0,memoize_one__WEBPACK_IMPORTED_MODULE_3__.A)((formSettingsDto,isFeatureEnabled)=>this.originalSettings?.hasDiffProps(this.formSettings)||this.originalSettings?.isFeatureEnabled!==isFeatureEnabled);handleInputChange(event){const{value,name}=event.target,parsedValue=parseInt(value,10)+1;this.setFormPropertyValue(name,parsedValue)}setFormPropertyValue(name,parsedValue){this.formSettings.set(name,parsedValue,{validate:!1}),this.setState({settings:this.formSettings.toDto()})}get maxRevisionsLimit(){return this.props.context.siteSettings.getPluginSettings("secretRevisions")?.maxRevisionsLimit||11}get maxRevisionsLimitToDisplay(){return(this.maxRevisionsLimit-1).toString()}handleEnableFeature(event){const{checked}=event.target;checked&&1===this.state.settings.max_revisions&&this.setFormPropertyValue("max_revisions",2),this.setState({isFeatureEnabled:checked})}hasAllInputDisabled(){return this.state.isProcessing}async handleFormSubmit(event){event.preventDefault(),await this.save()}get hasMaxRevisionsError(){return this.state.settings.max_revisions<2||this.state.settings.max_revisions>this.maxRevisionsLimit}async save(){if(this.state.isProcessing)return;const validationError=this.validateForm(this.state.settings);if(validationError?.hasErrors()||this.hasMaxRevisionsError)this.setState({hasAlreadyBeenValidated:!0});else{this.setState({isProcessing:!0});try{!this.state.isFeatureEnabled?await this.deleteSettings():this.state.isFeatureEnabled&&await this.saveSettings(),await this.props.actionFeedbackContext.displaySuccess(this.props.t("The secret history settings were updated."))}catch(error){console.error(error),this.props.dialogContext.open(_Common_Error_NotifyError_NotifyError__WEBPACK_IMPORTED_MODULE_5__.A,{error})}this.setState({hasAlreadyBeenValidated:!0,isProcessing:!1,settings:this.formSettings.toDto()})}}async deleteSettings(){await this.secretRevisionsSettingsServiceWorkerService.deleteSettings(),this.originalSettings=_shared_models_entity_secretRevision_secretRevisionsSettingsEntity__WEBPACK_IMPORTED_MODULE_9__.A.createFromDefault(),this.formSettings=new _shared_models_entity_secretRevision_secretRevisionsSettingsEntity__WEBPACK_IMPORTED_MODULE_9__.A(this.originalSettings.toDto(),{validate:!1})}async saveSettings(){const settings=this.formSettings.toDto();this.originalSettings=new _shared_models_entity_secretRevision_secretRevisionsSettingsEntity__WEBPACK_IMPORTED_MODULE_9__.A(settings,{validate:!1}),this.originalSettings=await this.secretRevisionsSettingsServiceWorkerService.saveSettings(new _shared_models_entity_secretRevision_secretRevisionsSettingsEntity__WEBPACK_IMPORTED_MODULE_9__.A(settings)),this.formSettings=new _shared_models_entity_secretRevision_secretRevisionsSettingsEntity__WEBPACK_IMPORTED_MODULE_9__.A(this.originalSettings.toDto(),{validate:!1})}render(){const errors=this.state.hasAlreadyBeenValidated?this.validateForm(this.state.settings):null,hasSettingsChanges=this.hasSettingsChanges(this.state.settings,this.state.isFeatureEnabled),hasMaxRevisionsError=errors?.hasError("max_revisions")||this.state.hasAlreadyBeenValidated&&this.hasMaxRevisionsError;return react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",{className:"row"},react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",{id:"secret-history",className:"main-column"},react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",{className:"main-content"},react__WEBPACK_IMPORTED_MODULE_1__.createElement("form",{onSubmit:this.handleFormSubmit},react__WEBPACK_IMPORTED_MODULE_1__.createElement("h3",{id:"secret-history-settings-title",className:"title"},react__WEBPACK_IMPORTED_MODULE_1__.createElement("span",{className:"input toggle-switch form-element"},react__WEBPACK_IMPORTED_MODULE_1__.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"secretHistorySettingsToggle",onChange:this.handleEnableFeature,checked:this.state.isFeatureEnabled,disabled:this.hasAllInputDisabled(),id:"passwordExpirySettingsToggle"}),react__WEBPACK_IMPORTED_MODULE_1__.createElement("label",{htmlFor:"passwordExpirySettingsToggle"},react__WEBPACK_IMPORTED_MODULE_1__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_2__.x6,null,"Secret history")))),!this.state.isFeatureEnabled&&react__WEBPACK_IMPORTED_MODULE_1__.createElement("p",{className:"description"},react__WEBPACK_IMPORTED_MODULE_1__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_2__.x6,null,"No secret history is configured. Enable it to activate and set the number of passwords revisions.")),this.state.isFeatureEnabled&&react__WEBPACK_IMPORTED_MODULE_1__.createElement(react__WEBPACK_IMPORTED_MODULE_1__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_1__.createElement("p",{className:"description"},react__WEBPACK_IMPORTED_MODULE_1__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_2__.x6,null,"Control how many revisions are retained, enabling users to view and restore historical data.")),react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",{className:"input text "+(this.hasAllInputDisabled()?"disabled":"")},react__WEBPACK_IMPORTED_MODULE_1__.createElement("h4",null,react__WEBPACK_IMPORTED_MODULE_1__.createElement("label",{htmlFor:"configure-secret-history-form-length"},react__WEBPACK_IMPORTED_MODULE_1__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_2__.x6,null,"History length"))),react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",{className:"slider"},react__WEBPACK_IMPORTED_MODULE_1__.createElement("input",{name:"max_revisions",min:"1",max:this.maxRevisionsLimit-1,value:this.state.settings.max_revisions-1,step:"1",type:"range",onChange:this.handleInputChange,disabled:this.hasAllInputDisabled()}),react__WEBPACK_IMPORTED_MODULE_1__.createElement("input",{id:"configure-secret-history-form-length",type:"number",name:"max_revisions",min:"1",max:this.maxRevisionsLimit-1,value:this.state.settings.max_revisions-1,onChange:this.handleInputChange,disabled:this.hasAllInputDisabled()})),react__WEBPACK_IMPORTED_MODULE_1__.createElement("p",{className:"description"},react__WEBPACK_IMPORTED_MODULE_1__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_2__.x6,null,"This is the number of revisions kept once users have access.")),hasMaxRevisionsError&&react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",{id:"maxRevisions-error",className:"error-message"},react__WEBPACK_IMPORTED_MODULE_1__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_2__.x6,null,"The history length must be between 1 and ",this.maxRevisionsLimitToDisplay,".")))))),hasSettingsChanges&&react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",{className:"warning message"},react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_1__.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_1__.createElement("b",null,react__WEBPACK_IMPORTED_MODULE_1__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_2__.x6,null,"Warning:"))," ",react__WEBPACK_IMPORTED_MODULE_1__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_2__.x6,null,"Don't forget to save your settings to apply your modification."))))),react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",{className:"actions-wrapper"},react__WEBPACK_IMPORTED_MODULE_1__.createElement("button",{type:"button",className:"button primary",disabled:this.state.isProcessing,onClick:this.handleFormSubmit},react__WEBPACK_IMPORTED_MODULE_1__.createElement("span",null,react__WEBPACK_IMPORTED_MODULE_1__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_2__.x6,null,"Save")))))}}DisplaySecretHistoryAdministration.propTypes={context:prop_types__WEBPACK_IMPORTED_MODULE_0___default().object,dialogContext:prop_types__WEBPACK_IMPORTED_MODULE_0___default().object,actionFeedbackContext:prop_types__WEBPACK_IMPORTED_MODULE_0___default().object,t:prop_types__WEBPACK_IMPORTED_MODULE_0___default().func};const __WEBPACK_DEFAULT_EXPORT__=(0,_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_4__.L)((0,_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_7__.ot)((0,_contexts_DialogContext__WEBPACK_IMPORTED_MODULE_6__.z9)((0,react_i18next__WEBPACK_IMPORTED_MODULE_2__.CI)("common")(DisplaySecretHistoryAdministration))));DisplaySecretHistoryAdministration.__docgenInfo={description:"",methods:[{name:"defaultState",docblock:"Get default state\n@returns {Object}",modifiers:["get"],params:[],returns:{type:{name:"Object"}},description:"Get default state"},{name:"bindCallbacks",docblock:"Bind callbacks methods",modifiers:[],params:[],returns:null,description:"Bind callbacks methods"},{name:"handleInputChange",docblock:"Handle form input changes.\n@params {ReactEvent} The react event\n@returns {void}",modifiers:[],params:[{name:"event",optional:!1}],returns:{type:{name:"void"}},description:"Handle form input changes."},{name:"setFormPropertyValue",docblock:"Set a form property value. Trigger the validation if the form has already been submitted once.\n@param name\n@param parsedValue",modifiers:[],params:[{name:"name",optional:!1},{name:"parsedValue",optional:!1}],returns:null,description:"Set a form property value. Trigger the validation if the form has already been submitted once."},{name:"maxRevisionsLimit",docblock:"Get the max revision limit from the organization settings\n@return {number}",modifiers:["get"],params:[],returns:{type:{name:"number"}},description:"Get the max revision limit from the organization settings"},{name:"maxRevisionsLimitToDisplay",docblock:"Get the max revision limit from the organization settings -1 in string to display at the administrator\n@return {string}",modifiers:["get"],params:[],returns:{type:{name:"string"}},description:"Get the max revision limit from the organization settings -1 in string to display at the administrator"},{name:"handleEnableFeature",docblock:"Handle form enable feature changes.\n@params {ReactEvent} The react event\n@returns {void}",modifiers:[],params:[{name:"event",optional:!1}],returns:{type:{name:"void"}},description:"Handle form enable feature changes."},{name:"hasAllInputDisabled",docblock:"Should input be disabled? True if state is loading or processing\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Should input be disabled? True if state is loading or processing"},{name:"handleFormSubmit",docblock:"Handle form submission that can be trigger when hitting `enter`\n@param {Event} event The html event triggering the form submit.",modifiers:["async"],params:[{name:"event",description:"The html event triggering the form submit.",type:{name:"Event"},optional:!1}],returns:null,description:"Handle form submission that can be trigger when hitting `enter`"},{name:"hasMaxRevisionsError",docblock:"Has max revision error\n@return {boolean}",modifiers:["get"],params:[],returns:{type:{name:"boolean"}},description:"Has max revision error"},{name:"save",docblock:"Save the settings\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Save the settings"},{name:"deleteSettings",docblock:"Delete the settings\n@return {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Delete the settings"},{name:"saveSettings",docblock:"Save the settings\n@return {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Save the settings"}],displayName:"DisplaySecretHistoryAdministration",props:{context:{description:"",type:{name:"object"},required:!1},dialogContext:{description:"",type:{name:"object"},required:!1},actionFeedbackContext:{description:"",type:{name:"object"},required:!1},t:{description:"",type:{name:"func"},required:!1}}}},"./src/react-extension/components/Administration/DisplaySecretHistoryAdministration/DisplaySecretHistoryAdministration.test.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Initial:()=>Initial,NoSettings:()=>NoSettings,__namedExportsOrder:()=>__namedExportsOrder,default:()=>DisplaySecretHistoryAdministration_test_stories});var react=__webpack_require__("./node_modules/react/index.js"),ActionFeedbackContext_test_data=__webpack_require__("./src/react-extension/contexts/ActionFeedbackContext.test.data.js"),ExtAppContext_test_data=__webpack_require__("./src/react-extension/contexts/ExtAppContext.test.data.js"),DialogContext_test_data=__webpack_require__("./src/react-extension/contexts/DialogContext.test.data.js"),AdministrationWorkspaceContext=__webpack_require__("./src/react-extension/contexts/AdministrationWorkspaceContext.js"),AdministrationWorkspaceContext_test_data=__webpack_require__("./src/react-extension/contexts/AdministrationWorkspaceContext.test.data.js");const defaultProps=(props={})=>({context:(0,ExtAppContext_test_data.dO)(),dialogContext:(0,DialogContext_test_data.L)(),actionFeedbackContext:(0,ActionFeedbackContext_test_data.M)(),administrationWorkspaceContext:(0,AdministrationWorkspaceContext_test_data.M)({selectedAdministration:AdministrationWorkspaceContext.UZ.SECRET_HISTORY}),createPortal:jest.fn,...props});var react_router_dom_min=__webpack_require__("./node_modules/react-router-dom/cjs/react-router-dom.min.js"),TranslationProvider=__webpack_require__("./src/react-extension/components/Common/Internationalisation/TranslationProvider.js"),DisplayAdministrationWorkspaceBreadcrumb=__webpack_require__("./src/react-extension/components/Administration/DisplayAdministrationWorkspaceBreadcrumb/DisplayAdministrationWorkspaceBreadcrumb.js"),DisplaySecretHistoryAdministration=__webpack_require__("./src/react-extension/components/Administration/DisplaySecretHistoryAdministration/DisplaySecretHistoryAdministration.js"),secretRevisionsSettingsEntity_test_data=__webpack_require__("./src/shared/models/entity/secretRevision/secretRevisionsSettingsEntity.test.data.js"),secretRevisionsSettingsEntity=__webpack_require__("./src/shared/models/entity/secretRevision/secretRevisionsSettingsEntity.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),es=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),info=__webpack_require__("./src/img/svg/info.svg");class DisplaySecretHistoryAdministrationHelp extends react.Component{render(){return react.createElement("div",{className:"sidebar-help-section"},react.createElement("h3",null,react.createElement(es.x6,null,"Need help?")),react.createElement("p",null,react.createElement(es.x6,null,"For more information about the secret history settings, checkout the dedicated page on the official website.")),react.createElement("a",{className:"button",target:"_blank",rel:"noopener noreferrer",href:"https://passbolt.com/docs/admin/secret-history"},react.createElement(info.A,null),react.createElement("span",null,react.createElement(es.x6,null,"Read the documentation"))))}}DisplaySecretHistoryAdministrationHelp.propTypes={t:prop_types_default().func};const DisplaySecretHistoryAdministration_DisplaySecretHistoryAdministrationHelp=(0,es.CI)("common")(DisplaySecretHistoryAdministrationHelp);DisplaySecretHistoryAdministrationHelp.__docgenInfo={description:"",methods:[],displayName:"DisplaySecretHistoryAdministrationHelp",props:{t:{description:"",type:{name:"func"},required:!1}}};const DisplaySecretHistoryAdministration_test_stories={title:"Components/Administration/DisplaySecretHistoryAdministration",component:DisplaySecretHistoryAdministration.A,decorators:[(Story,{args})=>react.createElement(react_router_dom_min.fS,{initialEntries:["/app/administration/secret-history"]},react.createElement(TranslationProvider.A,{loadingPath:"/webAccessibleResources/locales/{{lng}}/{{ns}}.json"},react.createElement("div",{id:"container",className:"page administration"},react.createElement("div",{id:"app",className:"app",style:{margin:"-1rem"}},react.createElement("div",{className:"panel main"},react.createElement("div",{className:"panel left"},react.createElement("div",{className:"sidebar-content"},react.createElement("div",{className:"top-bar-left-navigation"},react.createElement("div",{className:"navigation"})),react.createElement("div",{className:"sidebar-content-left"}))),react.createElement("div",{className:"panel middle"},react.createElement("div",{className:"header"}),react.createElement("div",{className:"middle-right"},react.createElement("div",{className:"breadcrumbs-and-grid"},react.createElement("div",{className:"top-bar"},react.createElement(DisplayAdministrationWorkspaceBreadcrumb.A,{administrationWorkspaceContext:args.administrationWorkspaceContext})),react.createElement("div",{className:"main-page"},react.createElement(Story,args))),react.createElement("div",{className:"help-panel"},react.createElement("div",{className:"sidebar-help"},react.createElement("div",{id:"administration-help-panel"},react.createElement(DisplaySecretHistoryAdministration_DisplaySecretHistoryAdministrationHelp,null)))))))))))]},props=defaultProps();props.context.port.addRequestListener("passbolt.secret-revisions.find-settings",()=>(0,secretRevisionsSettingsEntity_test_data.C)()),props.context.port.addRequestListener("passbolt.secret-revisions.save-settings",settings=>new secretRevisionsSettingsEntity.A(settings.toDto()));const Initial={args:props},propsWithoutSettings=defaultProps();propsWithoutSettings.context.port.addRequestListener("passbolt.secret-revisions.find-settings",()=>secretRevisionsSettingsEntity.A.createFromDefault().toDto()),propsWithoutSettings.context.port.addRequestListener("passbolt.secret-revisions.save-settings",settings=>new secretRevisionsSettingsEntity.A(settings.toDto()));const NoSettings={args:propsWithoutSettings},__namedExportsOrder=["Initial","NoSettings"];Initial.parameters={...Initial.parameters,docs:{...Initial.parameters?.docs,source:{originalSource:"{\n  args: props\n}",...Initial.parameters?.docs?.source}}},NoSettings.parameters={...NoSettings.parameters,docs:{...NoSettings.parameters?.docs,source:{originalSource:"{\n  args: propsWithoutSettings\n}",...NoSettings.parameters?.docs?.source}}}},"./src/react-extension/contexts/ActionFeedbackContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ay:()=>ActionFeedbackContextProvider,b_:()=>ActionFeedbackContext,ot:()=>withActionFeedback});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__),uuid__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js");const ActionFeedbackContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext({feedbacks:[],displaySuccess:()=>{},displayWarning:()=>{},displayError:()=>{},remove:()=>{}});class ActionFeedbackContextProvider extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.defaultState}get defaultState(){return{feedbacks:[],displaySuccess:this.displaySuccess.bind(this),displayWarning:this.displayWarning.bind(this),displayError:this.displayError.bind(this),remove:this.remove.bind(this)}}displaySuccess(feedbackToAdd){this.setState({feedbacks:[...this.state.feedbacks,{id:(0,uuid__WEBPACK_IMPORTED_MODULE_2__.A)(),type:"success",message:feedbackToAdd}]})}displayWarning(feedbackToAdd){this.setState({feedbacks:[...this.state.feedbacks,{id:(0,uuid__WEBPACK_IMPORTED_MODULE_2__.A)(),type:"warning",message:feedbackToAdd}]})}displayError(feedbackToAdd){this.setState({feedbacks:[...this.state.feedbacks,{id:(0,uuid__WEBPACK_IMPORTED_MODULE_2__.A)(),type:"error",message:feedbackToAdd}]})}remove(feedbackToRemove){this.setState({feedbacks:this.state.feedbacks.filter(feedback=>feedbackToRemove.id!==feedback.id)})}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(ActionFeedbackContext.Provider,{value:this.state},this.props.children)}}function withActionFeedback(WrappedComponent){return class WithActionFeedback extends react__WEBPACK_IMPORTED_MODULE_0__.Component{render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(ActionFeedbackContext.Consumer,null,actionFeedbackContext=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(WrappedComponent,{actionFeedbackContext,...this.props}))}}}ActionFeedbackContextProvider.displayName="ActionFeedbackContextProvider",ActionFeedbackContextProvider.propTypes={children:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any},ActionFeedbackContextProvider.__docgenInfo={description:"The related context provider",methods:[{name:"defaultState",docblock:"Returns the default component state",modifiers:["get"],params:[],returns:null,description:"Returns the default component state"},{name:"displaySuccess",docblock:"Display the feedback in a success mode\n@param feedbackToAdd A feedback",modifiers:[],params:[{name:"feedbackToAdd",description:"A feedback",optional:!1}],returns:null,description:"Display the feedback in a success mode"},{name:"displayWarning",docblock:"Display the feedback in a warning mode\n@param feedbackToAdd A feedback",modifiers:[],params:[{name:"feedbackToAdd",description:"A feedback",optional:!1}],returns:null,description:"Display the feedback in a warning mode"},{name:"displayError",docblock:"Display the feedback in a error mode\n@param feedbackToAdd A feedback",modifiers:[],params:[{name:"feedbackToAdd",description:"A feedback",optional:!1}],returns:null,description:"Display the feedback in a error mode"},{name:"remove",docblock:"Remove the feedback\n@param feedbackToRemove A feedback",modifiers:[],params:[{name:"feedbackToRemove",description:"A feedback",optional:!1}],returns:null,description:"Remove the feedback"}],displayName:"ActionFeedbackContextProvider",props:{children:{description:"",type:{name:"any"},required:!1}}}},"./src/react-extension/contexts/ActionFeedbackContext.test.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function defaultActionFeedbackContext(data={}){const defaultContext={displaySuccess:jest.fn(),displayError:jest.fn(),remove:jest.fn()};return Object.assign(defaultContext,data)}__webpack_require__.d(__webpack_exports__,{M:()=>defaultActionFeedbackContext})},"./src/react-extension/contexts/DialogContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ay:()=>DialogContextProvider,z9:()=>withDialog});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__),uuid__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js");const DialogContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext({dialogs:[],open:()=>{},close:()=>{}});class DialogContextProvider extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.defaultState}get defaultState(){return{dialogs:[],open:(Dialog,DialogProps)=>{const dialogKey=(0,uuid__WEBPACK_IMPORTED_MODULE_2__.A)();return this.setState({dialogs:[...this.state.dialogs,{key:dialogKey,Dialog,DialogProps}]}),dialogKey},close:dialogKey=>this.setState({dialogs:this.state.dialogs.filter(dialog=>dialogKey!==dialog.key)}),closeAll:()=>this.setState({dialogs:[]})}}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DialogContext.Provider,{value:this.state},this.props.children)}}function withDialog(WrappedComponent){return class WithDialog extends react__WEBPACK_IMPORTED_MODULE_0__.Component{render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DialogContext.Consumer,null,dialogContext=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(WrappedComponent,{dialogContext,...this.props}))}}}DialogContextProvider.displayName="DialogContextProvider",DialogContextProvider.propTypes={children:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any},DialogContextProvider.__docgenInfo={description:"The related context provider",methods:[{name:"defaultState",docblock:"Returns the default component state",modifiers:["get"],params:[],returns:null,description:"Returns the default component state"}],displayName:"DialogContextProvider",props:{children:{description:"",type:{name:"any"},required:!1}}}},"./src/react-extension/contexts/DialogContext.test.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function defaultDialogContext(context={}){const defaultContext={dialogs:[],open:jest.fn(),close:jest.fn(),closeAll:jest.fn()};return Object.assign(defaultContext,context)}__webpack_require__.d(__webpack_exports__,{L:()=>defaultDialogContext})},"./src/react-extension/contexts/ExtAppContext.test.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{dO:()=>defaultAdministratorAppContext,st:()=>defaultAppContext,bC:()=>defaultUserAppContext});var UserSettings=__webpack_require__("./src/shared/lib/Settings/UserSettings.js"),Settings_userSettings=__webpack_require__("./src/react-extension/test/fixture/Settings/userSettings.js"),SiteSettings=__webpack_require__("./src/shared/lib/Settings/SiteSettings.js"),Settings_siteSettings=__webpack_require__("./src/react-extension/test/fixture/Settings/siteSettings.js"),MockPort=__webpack_require__("./src/react-extension/test/mock/MockPort.js"),MockStorage=__webpack_require__("./src/react-extension/test/mock/MockStorage.js"),userEntity_test_data=__webpack_require__("./src/shared/models/entity/user/userEntity.test.data.js"),roleEntity_test_data=__webpack_require__("./src/shared/models/entity/role/roleEntity.test.data.js"),accountEntity_test_data=__webpack_require__("./src/shared/models/entity/account/accountEntity.test.data.js"),accountEntity=__webpack_require__("./src/shared/models/entity/account/accountEntity.js");const defaultCeSiteSettings=siteSettings=>Object.assign({app:{url:"http://127.0.0.1:3001",locale:"en-UK",version:{number:"3.11.0",name:"Regular"},server_timezone:"UTC",session_timeout:24,image_storage:{public_path:"img/public/"}},passbolt:{legal:{privacy_policy:{url:""},terms:{url:"https://www.passbolt.com/terms"}},edition:"ce",plugins:{export:{version:"2.0.0",enabled:!0},import:{version:"2.0.1",enabled:!0,config:{format:["kdbx","csv"]}},previewPassword:{enabled:!0},resourceTypes:{version:"1.0.0",enabled:!0},mobile:{version:"1.0.0",enabled:!0},jwtAuthentication:{version:"3.3.0",enabled:!0},accountRecoveryRequestHelp:{enabled:!0},smtpSettings:{version:"1.0.0",enabled:!0},selfRegistration:{version:"1.0.0",enabled:!0},selenium_api:{version:"2.2.0"},passbolt_test_data:{version:"2.0"},accountSettings:{version:"1.0.0"},inFormIntegration:{version:"1.0.0",enabled:!0},locale:{version:"3.2.0",options:[{locale:"de-DE",label:"Deutsch"},{locale:"en-UK",label:"English"},{locale:"es-ES",label:"Español"},{locale:"fr-FR",label:"Français"},{locale:"it-IT",label:"Italiano (beta)"},{locale:"ja-JP",label:"日本語"},{locale:"ko-KR",label:"한국어 (beta)"},{locale:"lt-LT",label:"Lietuvių"},{locale:"nl-NL",label:"Nederlands"},{locale:"pl-PL",label:"Polski"},{locale:"pt-BR",label:"Português Brasil (beta)"},{locale:"ro-RO",label:"Română (beta)"},{locale:"ru-RU",label:"Pусский (beta)"},{locale:"sl-SI",label:"Slovenščina (beta)"},{locale:"sv-SE",label:"Svenska"},{locale:"uk-UA",label:"Українська (beta)"},{locale:"cs-CZ",label:"Čeština (beta)"}]},rememberMe:{version:"2.0.0",options:{300:"5 minutes",900:"15 minutes",1800:"30 minutes",3600:"1 hour","-1":"until I log out"}},emailNotificationSettings:{version:"1.1.0",enabled:!0},emailDigest:{version:"1.0.0",enabled:!0},reports:{version:"1.0.0",enabled:!0},passwordGenerator:{version:"3.3.0",enabled:!0},multiFactorAuthentication:{version:"1.1.0",enabled:!0},log:{version:"1.0.1",enabled:!0},metadata:{version:"1.0.0",enabled:!0,isInBeta:!0}}}},siteSettings);var rbacsCollection=__webpack_require__("./src/shared/models/entity/rbac/rbacsCollection.js"),rbacsCollection_test_data=__webpack_require__("./src/shared/models/entity/rbac/rbacsCollection.test.data.js");function defaultAppContext(appContext={},isCommunityEdition=!1){const userSettings=new UserSettings.A(Settings_userSettings.A),defaultAppContext1={locale:"en-UK",userSettings,siteSettings:isCommunityEdition?new SiteSettings.A(defaultCeSiteSettings()):new SiteSettings.A(Settings_siteSettings.A),port:new MockPort.A,storage:new MockStorage.A,account:new accountEntity.A((0,accountEntity_test_data.q)()),loggedInUser:{id:userSettings.id,role:{id:roleEntity_test_data.ES,name:"admin"}},users:[],roles:[{id:roleEntity_test_data.ES,name:"admin"},{id:roleEntity_test_data.ol,name:"user"}],rbacs:new rbacsCollection.A([]),setContext:jest.fn(),foldersMapById:[],getHierarchyFolderCache:jest.fn(()=>[])};return Object.assign(defaultAppContext1,appContext)}const defaultUserAppContext=(data={})=>{const siteSettings=new SiteSettings.A(Settings_siteSettings.A);return{locale:"en-UK",userSettings:new UserSettings.A(Settings_userSettings.A),siteSettings,port:new MockPort.A,storage:new MockStorage.A,loggedInUser:(0,userEntity_test_data.cI)({},{withRole:!0}),users:[],roles:[(0,roleEntity_test_data.Dm)(),(0,roleEntity_test_data.bd)()],resources:[],folders:[],setContext:jest.fn(),rbacs:new rbacsCollection.A((0,rbacsCollection_test_data.rB)()),foldersMapById:[],getHierarchyFolderCache:jest.fn(()=>[]),...data}},defaultAdministratorAppContext=(data={})=>defaultUserAppContext({loggedInUser:(0,userEntity_test_data.HI)({},{withRole:!0}),...data})},"./src/react-extension/test/mock/MockStorage.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});class LocalStorage{constructor(changeCallbacks){this.storage={},this.changeCallbacks=changeCallbacks}get(keys){return keys.reduce((accumulator,key)=>(this.storage[key]&&(accumulator[key]=this.storage[key]),accumulator),{})}set(data){const storageChangeEventValue={};Object.keys(data).forEach(key=>{this.storage[key]=data[key],storageChangeEventValue[key]={},storageChangeEventValue[key].newValue=data[key]}),this.changeCallbacks.forEach(callback=>callback(storageChangeEventValue))}}const __WEBPACK_DEFAULT_EXPORT__=class MockStorage{constructor(){this.changeCallbacks=[],this.local=new LocalStorage(this.changeCallbacks),this.onChanged={addListener:listener=>{this.changeCallbacks.push(listener)},removeListener:listener=>{const listenerIndex=this.changeCallbacks.indexOf(listener);listenerIndex>-1&&this.changeCallbacks.splice(listenerIndex,1)}}}}},"./src/shared/models/entity/account/accountEntity.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _shared_models_entity_role_roleEntity__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/models/entity/role/roleEntity.js"),_abstract_entityV2__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/shared/models/entity/abstract/entityV2.js"),uuid__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/uuid/dist/esm-browser/v5.js");class AccountEntity extends _abstract_entityV2__WEBPACK_IMPORTED_MODULE_1__.A{marshall(){Object.assign(this._props,{type:AccountEntity.TYPE_ACCOUNT})}static getSchema(){return{type:"object",required:["type","domain","user_id","username","first_name","last_name","user_public_armored_key","server_public_armored_key"],properties:{type:{type:"string",enum:[AccountEntity.TYPE_ACCOUNT]},domain:{type:"string"},user_id:{type:"string",format:"uuid"},user_key_fingerprint:{type:"string",minLength:40,maxLength:40,pattern:/^[A-F0-9]{40}$/},user_public_armored_key:{type:"string"},server_public_armored_key:{type:"string"},username:{type:"string"},first_name:{type:"string"},last_name:{type:"string"},locale:{type:"string",pattern:/^[a-z]{2}-[A-Z]{2}$/,nullable:!0},role_name:{..._shared_models_entity_role_roleEntity__WEBPACK_IMPORTED_MODULE_0__.A.getSchema().properties.name,nullable:!0}}}}get id(){return this.domain&&this.userId?(0,uuid__WEBPACK_IMPORTED_MODULE_2__.A)(`${this.domain}${this.userId}`,"d5447ca1-950f-459d-8b20-86ddfdd0f922"):null}get domain(){return this._props.domain}get userId(){return this._props.user_id}static get ENTITY_NAME(){return"Account"}static get TYPE_ACCOUNT(){return"Account"}}const __WEBPACK_DEFAULT_EXPORT__=AccountEntity},"./src/shared/models/entity/account/accountEntity.test.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{q:()=>defaultAccountDto});var _accountEntity__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/models/entity/account/accountEntity.js"),_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./test/fixture/pgpKeys/keys.js");const defaultAccountDto=(data={})=>{data=JSON.parse(JSON.stringify(data));const defaultData={type:_accountEntity__WEBPACK_IMPORTED_MODULE_0__.A.TYPE_ACCOUNT,domain:"https://passbolt.local",user_id:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_1__.u.ada.userId,username:"ada@passbolt.com",first_name:"Ada",last_name:"Lovelace",user_key_fingerprint:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_1__.u.ada.fingerprint,user_public_armored_key:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_1__.u.ada.public,user_private_armored_key:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_1__.u.ada.private,server_public_armored_key:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_1__.u.server.public,locale:"de-DE"};return Object.assign(defaultData,data)}},"./src/shared/models/entity/secretRevision/secretRevisionsSettingsEntity.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _abstract_entityV2__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/models/entity/abstract/entityV2.js");class SecretRevisionsSettingsEntity extends _abstract_entityV2__WEBPACK_IMPORTED_MODULE_0__.A{static getSchema(){return{type:"object",required:["max_revisions","allow_sharing_revisions"],properties:{id:{type:"string",format:"uuid"},max_revisions:{type:"integer",minimum:1},allow_sharing_revisions:{type:"boolean"}}}}static createFromDefault(data={}){return new SecretRevisionsSettingsEntity({max_revisions:1,allow_sharing_revisions:!1,...data})}get id(){return this._props.id}get maxRevisions(){return this._props.max_revisions}get allowSharingRevisions(){return this._props.allow_sharing_revisions}get isFeatureEnabled(){return this.maxRevisions>1}}const __WEBPACK_DEFAULT_EXPORT__=SecretRevisionsSettingsEntity},"./src/shared/models/entity/secretRevision/secretRevisionsSettingsEntity.test.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>defaultSecretRevisionsSettingsDto});const defaultSecretRevisionsSettingsDto=(data={})=>Object.assign({max_revisions:3,allow_sharing_revisions:!1},data)},"./src/shared/services/serviceWorker/secretRevision/secretRevisionsSettingsServiceWorkerService.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ay:()=>SecretRevisionsSettingsServiceWorkerService});var _models_entity_secretRevision_secretRevisionsSettingsEntity__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/models/entity/secretRevision/secretRevisionsSettingsEntity.js");class SecretRevisionsSettingsServiceWorkerService{constructor(port){this.port=port}async findSettings(){const settings=await this.port.request("passbolt.secret-revisions.find-settings");return new _models_entity_secretRevision_secretRevisionsSettingsEntity__WEBPACK_IMPORTED_MODULE_0__.A(settings)}async saveSettings(secretRevisionSettingsEntity){if(!(secretRevisionSettingsEntity instanceof _models_entity_secretRevision_secretRevisionsSettingsEntity__WEBPACK_IMPORTED_MODULE_0__.A))throw new TypeError("The parameter `secretRevisionSettingsEntity` should be of type SecretRevisionsSettingsEntity.");const settings=await this.port.request("passbolt.secret-revisions.save-settings",secretRevisionSettingsEntity);return new _models_entity_secretRevision_secretRevisionsSettingsEntity__WEBPACK_IMPORTED_MODULE_0__.A(settings)}async deleteSettings(){await this.port.request("passbolt.secret-revisions.delete-settings")}}}}]);