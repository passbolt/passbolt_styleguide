/*! For license information please see react-extension-components-ResourceFolder-DefineResourceFolderMoveStrategy-DefineResourceFolderMoveStrategy-test-stories.d8bf59f9.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkpassbolt_styleguide=self.webpackChunkpassbolt_styleguide||[]).push([[9863],{"./src/react-extension/components/ResourceFolder/DefineResourceFolderMoveStrategy/DefineResourceFolderMoveStrategy.test.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Initial:()=>Initial,__namedExportsOrder:()=>__namedExportsOrder,default:()=>DefineResourceFolderMoveStrategy_test_stories});var react=__webpack_require__("./node_modules/react/index.js"),react_router=__webpack_require__("./node_modules/react-router/esm/react-router.js"),AppContext=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),FormSubmitButton=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormSubmitButton.js"),FormCancelButton=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormCancelButton.js"),DialogWrapper=__webpack_require__("./src/react-extension/components/Common/Dialog/DialogWrapper/DialogWrapper.js"),UserAbortsOperationError=__webpack_require__("./src/react-extension/lib/Error/UserAbortsOperationError.js"),NotifyError=__webpack_require__("./src/react-extension/components/Common/Error/NotifyError/NotifyError.js"),DialogContext=__webpack_require__("./src/react-extension/contexts/DialogContext.js"),es=__webpack_require__("./node_modules/react-i18next/dist/es/index.js");class DefineResourceFolderMoveStrategy extends react.Component{constructor(props){super(props),this.state=this.getStateBasedOnContext(props,this.getDefaultState()),this.moveOptionChangeRef=react.createRef(),this.moveOptionKeepRef=react.createRef(),this.bindEventHandlers()}async componentDidMount(){this.setState({loading:!1,moveOption:"change"}),this.moveOptionChangeRef.current.focus()}getDefaultState(){return{loading:!0,processing:!1,moveOption:"change",cascade:!1}}bindEventHandlers(){this.handleClose=this.handleClose.bind(this),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleInputChange=this.handleInputChange.bind(this)}getStateBasedOnContext(props,defaultState){const folders=props.context.folders,error={message:this.translate("The folder could not be found. Maybe it was deleted or you lost access.")};folders||(console.error("No folders context defined."),this.handleError(error));const folder=props.context.folders.find((item=>item.id===this.props.context.folderMoveStrategyProps.folders[0]))||!1;return folder?defaultState.name=folder.name:(console.error(`Folder ${this.props.context.folderMoveStrategyProps.folders[0]} not found in context.`),this.handleError(error)),defaultState}async handleFormSubmit(event){if(event.preventDefault(),!this.state.processing){await this.toggleProcessing();try{await this.props.context.port.emit(this.props.context.folderMoveStrategyProps.requestId,"SUCCESS",{moveOption:this.state.moveOption}),this.handleSaveSuccess()}catch(error){this.handleSaveError(error)}}}handleSaveSuccess(){this.props.context.setContext({folderMoveStrategyProps:{}}),this.props.onClose()}handleSaveError(error){"UserAbortsOperationError"===error.name||(console.error(error),this.handleError(error)),this.setState({processing:!1})}handleError(error){const errorDialogProps={error};this.props.dialogContext.open(NotifyError.A,errorDialogProps)}async toggleProcessing(){const prev=this.state.processing;return new Promise((resolve=>{this.setState({processing:!prev},resolve())}))}handleInputChange(event){const target=event.target,value="checkbox"===target.type?target.checked:target.value,name=target.name;this.setState({[name]:value})}handleClose(){if(this.state.processing)return;const error=new UserAbortsOperationError.A(this.translate("The dialog has been closed."));this.props.context.port.emit(this.props.context.folderMoveStrategyProps.requestId,"ERROR",error),this.props.context.setContext({folderMoveStrategyProps:{}}),this.props.onClose()}hasAllInputDisabled(){return this.state.processing||this.state.loading}getIntroMessage(){let message="";return message=this.isAboutItems()?react.createElement(es.x6,null,"You are about to move several items."):this.isAboutAFolder()?react.createElement(es.x6,null,"You are about to move a folder."):this.isAboutFolders()?react.createElement(es.x6,null,"You are about to move several folders."):this.isAboutAResource()?react.createElement(es.x6,null,"You are about to move one resource."):react.createElement(es.x6,null,"You are about to move several resources."),message=react.createElement("span",null,message," ",react.createElement(es.x6,null,"The permissions do not match the destination folder permissions.")),message}isAboutItems(){return this.props.context.folderMoveStrategyProps.resources&&this.props.context.folderMoveStrategyProps.folders&&this.props.context.folderMoveStrategyProps.resources.length&&this.props.context.folderMoveStrategyProps.folders.length}isAboutResources(){return this.props.context.folderMoveStrategyProps.resources&&this.props.context.folderMoveStrategyProps.resources.length>1}isAboutFolders(){return this.props.context.folderMoveStrategyProps.folders&&this.props.context.folderMoveStrategyProps.folders.length>1}isAboutAFolder(){return this.props.context.folderMoveStrategyProps.folders&&1===this.props.context.folderMoveStrategyProps.folders.length}isAboutAResource(){return this.props.context.folderMoveStrategyProps.resources&&1===this.props.context.folderMoveStrategyProps.resources.length}get translate(){return this.props.t}render(){return react.createElement(DialogWrapper.A,{className:"move-folder-strategy-dialog",title:this.translate("How do you want to proceed?"),onClose:this.handleClose,disabled:this.hasAllInputDisabled()},react.createElement("form",{className:"folder-create-form",onSubmit:this.handleFormSubmit,noValidate:!0},react.createElement("div",{className:"form-content"},react.createElement("p",null,this.getIntroMessage()),react.createElement("div",{className:"radiolist-alt"},react.createElement("div",{className:"input radio "+("change"===this.state.moveOption?"checked":"")},react.createElement("input",{name:"moveOption",value:"change",id:"moveOptionChange",type:"radio",onChange:this.handleInputChange,ref:this.moveOptionChangeRef,checked:"change"===this.state.moveOption}),react.createElement("label",{htmlFor:"moveOptionChange"},react.createElement("span",{className:"name"},react.createElement(es.x6,null,"Change permissions")),react.createElement("span",{className:"info"},react.createElement(es.x6,null,"Remove old inherited permissions and apply the new destination folder permissions recursively.")))),react.createElement("div",{className:"input radio last "+("keep"===this.state.moveOption?"checked":"")},react.createElement("input",{name:"moveOption",value:"keep",id:"moveOptionKeep",type:"radio",onChange:this.handleInputChange,ref:this.moveOptionKeepRef,checked:"keep"===this.state.moveOption}),react.createElement("label",{htmlFor:"moveOptionKeep"},react.createElement("span",{className:"name"},react.createElement(es.x6,null,"Keep existing permissions")),react.createElement("span",{className:"info"},react.createElement(es.x6,null,"Keep the original permissions, do not apply the destination folder permissions.")))))),react.createElement("div",{className:"submit-wrapper clearfix"},react.createElement(FormCancelButton.A,{disabled:this.hasAllInputDisabled(),onClick:this.handleClose}),react.createElement(FormSubmitButton.A,{disabled:this.hasAllInputDisabled(),processing:this.state.processing,value:this.translate("Move")}))))}}DefineResourceFolderMoveStrategy.propTypes={context:prop_types_default().any,onClose:prop_types_default().func,dialogContext:prop_types_default().any,t:prop_types_default().func};const DefineResourceFolderMoveStrategy_DefineResourceFolderMoveStrategy=(0,AppContext.L)((0,DialogContext.z9)((0,es.CI)("common")(DefineResourceFolderMoveStrategy)));DefineResourceFolderMoveStrategy.__docgenInfo={description:"",methods:[{name:"getDefaultState",docblock:"Return default state\n@returns {Object} default state",modifiers:[],params:[],returns:{description:"default state",type:{name:"Object"}},description:"Return default state"},{name:"bindEventHandlers",docblock:"Bind callbacks methods",modifiers:[],params:[],returns:null,description:"Bind callbacks methods"},{name:"getStateBasedOnContext",docblock:"Return default state based on context and props\nFor example if folder doesn't exist then we show an error message\nOtherwise set the input name value\n\n@param props\n@param defaultState\n@returns {*}",modifiers:[],params:[{name:"props",optional:!1},{name:"defaultState",optional:!1}],returns:{type:{name:"mixed"}},description:"Return default state based on context and props\nFor example if folder doesn't exist then we show an error message\nOtherwise set the input name value"},{name:"handleFormSubmit",docblock:"Handle form submit event.\n@params {ReactEvent} The react event\n@return {Promise}",modifiers:["async"],params:[{name:"event",optional:!1}],returns:{type:{name:"Promise"}},description:"Handle form submit event."},{name:"handleSaveSuccess",docblock:"Handle save operation success.",modifiers:[],params:[],returns:null,description:"Handle save operation success."},{name:"handleSaveError",docblock:"Handle save operation error.\n@param {object} error The returned error",modifiers:[],params:[{name:"error",description:"The returned error",type:{name:"object"},optional:!1}],returns:null,description:"Handle save operation error."},{name:"handleError",docblock:"handle error to display the error\n@param error",modifiers:[],params:[{name:"error",optional:!1}],returns:null,description:"handle error to display the error"},{name:"toggleProcessing",docblock:"Toggle processing state\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Toggle processing state"},{name:"handleInputChange",docblock:"Handle form input change.\n@params {ReactEvent} The react event.",modifiers:[],params:[{name:"event",optional:!1}],returns:null,description:"Handle form input change."},{name:"handleClose",docblock:"Handle close button click.",modifiers:[],params:[],returns:null,description:"Handle close button click."},{name:"hasAllInputDisabled",docblock:"Should input be disabled? True if state is loading or processing\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Should input be disabled? True if state is loading or processing"},{name:"getIntroMessage",docblock:"Return an intro message explaining the context of the move to the user\n@returns {string}",modifiers:[],params:[],returns:{type:{name:"string"}},description:"Return an intro message explaining the context of the move to the user"},{name:"isAboutItems",docblock:"Is this share screen handling sharing of multiple Acos?\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Is this share screen handling sharing of multiple Acos?"},{name:"isAboutResources",docblock:"Is this share screen handling sharing of multiple resources?\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Is this share screen handling sharing of multiple resources?"},{name:"isAboutFolders",docblock:"Is this share screen handling sharing of multiple folders?\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Is this share screen handling sharing of multiple folders?"},{name:"isAboutAFolder",docblock:"Is this share screen handling sharing one folder?\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Is this share screen handling sharing one folder?"},{name:"isAboutAResource",docblock:"Is this share screen handling sharing one resource?\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Is this share screen handling sharing one resource?"},{name:"translate",docblock:"Get the translate function\n@returns {function(...[*]=)}",modifiers:["get"],params:[],returns:{},description:"Get the translate function"}],displayName:"DefineResourceFolderMoveStrategy",props:{context:{description:"",type:{name:"any"},required:!1},onClose:{description:"",type:{name:"func"},required:!1},dialogContext:{description:"",type:{name:"any"},required:!1},t:{description:"",type:{name:"func"},required:!1}}};var MockPort=__webpack_require__("./src/react-extension/test/mock/MockPort.js"),ExtAppContext_test_data=__webpack_require__("./src/react-extension/contexts/ExtAppContext.test.data.js");const DefineResourceFolderMoveStrategy_test_stories={title:"Components/ResourceFolder/DefineResourceFolderMoveStrategy",component:DefineResourceFolderMoveStrategy_DefineResourceFolderMoveStrategy},defaultContext={folders:[{id:1,name:"My folder"}],folderMoveStrategyProps:{folders:[1]},port:new MockPort.A,setContext:()=>{}},Template=({context,...args})=>react.createElement(AppContext.A.Provider,{value:context},react.createElement(react_router.fS,{initialEntries:["/"]},react.createElement(react_router.qh,{component:routerProps=>react.createElement(DefineResourceFolderMoveStrategy_DefineResourceFolderMoveStrategy,{...args,...routerProps})})));Template.propTypes={context:prop_types_default().object};const Initial=Template.bind({});Initial.args={context:(0,ExtAppContext_test_data.st)(defaultContext),onClose:()=>{}},Initial.argTypes={context:{control:{type:"object"}}};const __namedExportsOrder=["Initial"];Initial.parameters={...Initial.parameters,docs:{...Initial.parameters?.docs,source:{originalSource:"({\n  context,\n  ...args\n}) => <AppContext.Provider value={context}>\n    <MemoryRouter initialEntries={['/']}>\n      <Route component={routerProps => <DefineResourceFolderMoveStrategy {...args} {...routerProps} />}></Route>\n    </MemoryRouter>\n  </AppContext.Provider>",...Initial.parameters?.docs?.source}}}},"./src/react-extension/components/Common/Inputs/FormSubmitButton/FormCancelButton.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__),react_i18next__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js");class FormCancelButton extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.bindCallbacks()}bindCallbacks(){this.handleClick=this.handleClick.bind(this)}handleClick(){this.props.disabled||this.props.onClick()}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{type:"button",disabled:this.props.disabled,className:"link cancel",onClick:this.handleClick},this.props.value)}}FormCancelButton.defaultProps={value:react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_1__.x6,null,"Cancel")},FormCancelButton.propTypes={disabled:prop_types__WEBPACK_IMPORTED_MODULE_2___default().bool,onClick:prop_types__WEBPACK_IMPORTED_MODULE_2___default().func,value:prop_types__WEBPACK_IMPORTED_MODULE_2___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_2___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_2___default().node),prop_types__WEBPACK_IMPORTED_MODULE_2___default().node,prop_types__WEBPACK_IMPORTED_MODULE_2___default().string])};const __WEBPACK_DEFAULT_EXPORT__=(0,react_i18next__WEBPACK_IMPORTED_MODULE_1__.CI)("common")(FormCancelButton);FormCancelButton.__docgenInfo={description:"",methods:[{name:"bindCallbacks",docblock:"Bind callbacks methods\n@return {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Bind callbacks methods"},{name:"handleClick",docblock:"Handle cancel click\n@return {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Handle cancel click"}],displayName:"FormCancelButton",props:{value:{defaultValue:{value:"<Trans>Cancel</Trans>",computed:!1},description:"",type:{name:"union",value:[{name:"arrayOf",value:{name:"node"}},{name:"node"},{name:"string"}]},required:!1},disabled:{description:"",type:{name:"bool"},required:!1},onClick:{description:"",type:{name:"func"},required:!1}}}},"./src/react-extension/components/Common/Inputs/FormSubmitButton/FormSubmitButton.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_3__),_shared_components_Icons_Icon__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/shared/components/Icons/Icon.js"),react_i18next__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js");class FormSubmitButton extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.bindCallbacks()}bindCallbacks(){this.getClassName=this.getClassName.bind(this)}getClassName(){let name="button primary";return this.props.warning?name+=" warning":this.props.attention&&(name+=" attention"),this.props.disabled&&(name+=" disabled"),this.props.processing&&(name+=" processing"),this.props.big&&(name+=" big"),this.props.medium&&(name+=" medium"),this.props.fullWidth&&(name+=" full-width"),name}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{type:"submit",className:this.getClassName(),disabled:this.props.disabled},this.props.value||react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_2__.x6,null,"Save"),this.props.processing&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_shared_components_Icons_Icon__WEBPACK_IMPORTED_MODULE_1__.A,{name:"spinner"}))}}FormSubmitButton.defaultProps={warning:!1,attention:!1},FormSubmitButton.propTypes={processing:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,disabled:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,value:prop_types__WEBPACK_IMPORTED_MODULE_3___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_3___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_3___default().node),prop_types__WEBPACK_IMPORTED_MODULE_3___default().node,prop_types__WEBPACK_IMPORTED_MODULE_3___default().string]),warning:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,attention:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,big:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,medium:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,fullWidth:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool};const __WEBPACK_DEFAULT_EXPORT__=(0,react_i18next__WEBPACK_IMPORTED_MODULE_2__.CI)("common")(FormSubmitButton);FormSubmitButton.__docgenInfo={description:"",methods:[{name:"bindCallbacks",docblock:"Bind callbacks methods\n@return {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Bind callbacks methods"},{name:"getClassName",docblock:"Get the input button classname\n@returns {string}",modifiers:[],params:[],returns:{type:{name:"string"}},description:"Get the input button classname"}],displayName:"FormSubmitButton",props:{warning:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},attention:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},processing:{description:"",type:{name:"bool"},required:!1},disabled:{description:"",type:{name:"bool"},required:!1},value:{description:"",type:{name:"union",value:[{name:"arrayOf",value:{name:"node"}},{name:"node"},{name:"string"}]},required:!1},big:{description:"",type:{name:"bool"},required:!1},medium:{description:"",type:{name:"bool"},required:!1},fullWidth:{description:"",type:{name:"bool"},required:!1}}}},"./src/react-extension/contexts/DialogContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ay:()=>DialogContextProvider,z9:()=>withDialog});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__),uuid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js");const DialogContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext({dialogs:[],open:()=>{},close:()=>{}});class DialogContextProvider extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.defaultState}get defaultState(){return{dialogs:[],open:(Dialog,DialogProps)=>{const dialogKey=(0,uuid__WEBPACK_IMPORTED_MODULE_1__.A)();return this.setState({dialogs:[...this.state.dialogs,{key:dialogKey,Dialog,DialogProps}]}),dialogKey},close:dialogKey=>this.setState({dialogs:this.state.dialogs.filter((dialog=>dialogKey!==dialog.key))}),closeAll:()=>this.setState({dialogs:[]})}}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DialogContext.Provider,{value:this.state},this.props.children)}}function withDialog(WrappedComponent){return class WithDialog extends react__WEBPACK_IMPORTED_MODULE_0__.Component{render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DialogContext.Consumer,null,(dialogContext=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(WrappedComponent,{dialogContext,...this.props})))}}}DialogContextProvider.displayName="DialogContextProvider",DialogContextProvider.propTypes={children:prop_types__WEBPACK_IMPORTED_MODULE_2___default().any},DialogContextProvider.__docgenInfo={description:"The related context provider",methods:[{name:"defaultState",docblock:"Returns the default component state",modifiers:["get"],params:[],returns:null,description:"Returns the default component state"}],displayName:"DialogContextProvider",props:{children:{description:"",type:{name:"any"},required:!1}}}}}]);