/*! For license information please see react-extension-components-Administration-DisplaySelfRegistrationAdministration-DisplaySelfRegistrationAdministration-test-stories.a071cbc2.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkpassbolt_styleguide=self.webpackChunkpassbolt_styleguide||[]).push([[7297],{"./src/react-extension/components/Administration/DisplaySelfRegistrationAdministration/DisplaySelfRegistrationAdministration.test.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>DisplaySelfRegistrationAdministration_test_stories,withProfessionalDomains:()=>withProfessionalDomains});var react=__webpack_require__("./node_modules/react/index.js"),mockApiResponse=__webpack_require__("./test/mocks/mockApiResponse.js"),MockFetch=__webpack_require__("./src/react-extension/test/mock/MockFetch.js"),DisplaySelfRegistrationAdministration=__webpack_require__("./src/react-extension/components/Administration/DisplaySelfRegistrationAdministration/DisplaySelfRegistrationAdministration.js"),AdministrationSelfRegistrationContext=__webpack_require__("./src/react-extension/contexts/Administration/AdministrationSelfRegistration/AdministrationSelfRegistrationContext.js"),SelfRegistrationEnumeration=__webpack_require__("./src/shared/models/selfRegistration/SelfRegistrationEnumeration.js"),ApiAppContext_test_data=__webpack_require__("./src/react-extension/contexts/ApiAppContext.test.data.js");function defaultProps(data={}){const defaultProps1={context:(0,ApiAppContext_test_data.s)(data?.context),administrationWorkspaceContext:{setDisplayAdministrationWorkspaceAction:jest.fn(),resetDisplayAdministrationWorkspaceAction:jest.fn()},actionFeedbackContext:{displaySuccess:jest.fn(),displayError:jest.fn()},dialogContext:{open:jest.fn(),close:jest.fn()},t:text=>text};return Object.assign(defaultProps1,data)}function mockResult(domains=allowedDomains,provider=SelfRegistrationEnumeration.y.EMAILDOMAINS){return{id:"287ddd52-8131-4ef0-bdb8-19cf8291bf11",provider,data:{allowed_domains:domains}}}const allowedDomains=["passbolt.com","passbolt.io","passbolt.lu"];allowedDomains[0],allowedDomains[1],allowedDomains[2];let currentStory=null;const DisplaySelfRegistrationAdministration_test_stories={title:"Components/Administration/DisplaySelfRegistrationAdministration",component:DisplaySelfRegistrationAdministration.A,decorators:[(Story,context)=>(currentStory=context.id,react.createElement("div",{className:"page administration"},react.createElement("div",{className:"app"},react.createElement("div",{className:"panel main"},react.createElement("div",{className:"panel middle"},react.createElement("div",{className:"middle-right"},react.createElement("div",{className:"main-page password-policies-settings"},react.createElement(AdministrationSelfRegistrationContext.ji,context.args,react.createElement(Story,context.args)))))))))],parameters:{css:"api_main"}};(new MockFetch.A).addGetFetchRequest(/self-registration\/settings\.json/,(async()=>{switch(currentStory){case"components-administration-displayselfregistrationadministration--default":return(0,mockApiResponse._)(mockResult(null));case"components-administration-displayselfregistrationadministration--with-professional-domains":return(0,mockApiResponse._)(mockResult())}throw new Error("Unsupported story")}));const Default={args:defaultProps()},withProfessionalDomains={args:defaultProps()},__namedExportsOrder=["Default","withProfessionalDomains"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{\n  args: defaultProps()\n}",...Default.parameters?.docs?.source}}},withProfessionalDomains.parameters={...withProfessionalDomains.parameters,docs:{...withProfessionalDomains.parameters?.docs,source:{originalSource:"{\n  args: defaultProps()\n}",...withProfessionalDomains.parameters?.docs?.source}}}},"./src/img/svg/add.svg":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _path,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const __WEBPACK_DEFAULT_EXPORT__=function SvgAdd(props){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:17,height:16,fill:"none",viewBox:"0 0 17 16"},props),_path||(_path=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8.594 2v12M14.597 7.997h-12"})))}},"./src/img/svg/delete.svg":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _path,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const __WEBPACK_DEFAULT_EXPORT__=function SvgDelete(props){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},props),_path||(_path=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.25 4.5h13.5M14.25 4.5V15c0 .75-.75 1.5-1.5 1.5h-7.5c-.75 0-1.5-.75-1.5-1.5V4.5M6 4.5V3c0-.75.75-1.5 1.5-1.5h3c.75 0 1.5.75 1.5 1.5v1.5M7.5 8.25v4.5M10.5 8.25v4.5"})))}},"./src/img/svg/file_text.svg":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _path,_path2,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const __WEBPACK_DEFAULT_EXPORT__=function SvgFileText(props){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},props),_path||(_path=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z"})),_path2||(_path2=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M14 2v4a2 2 0 0 0 2 2h4M10 9H8M16 13H8M16 17H8"})))}},"./src/img/svg/spinner.svg":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _circle,_circle2,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const __WEBPACK_DEFAULT_EXPORT__=function SvgSpinner(props){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",_extends({width:18,height:18,fill:"none",className:"svg-icon spinner",viewBox:"0 0 18 18"},props),_circle||(_circle=react__WEBPACK_IMPORTED_MODULE_0__.createElement("circle",{id:"background",cx:8,cy:8,r:8,fill:"none",stroke:"var(--spinner-background)",strokeWidth:"var(--spinner-stroke-width)",transform:"translate(1 1)"})),_circle2||(_circle2=react__WEBPACK_IMPORTED_MODULE_0__.createElement("circle",{id:"loading",r:8,fill:"none",stroke:"var(--spinner-color)",strokeLinecap:"round",strokeWidth:"var(--spinner-stroke-width)",transform:"translate(9 9)"})))}},"./node_modules/debounce-promise/dist/index.js":module=>{module.exports=function debounce(fn){var wait=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},lastCallAt=void 0,deferred=void 0,timer=void 0,pendingArgs=[];return function debounced(){var currentWait=function getWait(wait){return"function"==typeof wait?wait():wait}(wait),currentTime=(new Date).getTime(),isCold=!lastCallAt||currentTime-lastCallAt>currentWait;lastCallAt=currentTime;for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];if(isCold&&options.leading)return options.accumulate?Promise.resolve(fn.call(this,[args])).then((function(result){return result[0]})):Promise.resolve(fn.call.apply(fn,[this].concat(args)));if(deferred?clearTimeout(timer):deferred=function defer(){var deferred={};return deferred.promise=new Promise((function(resolve,reject){deferred.resolve=resolve,deferred.reject=reject})),deferred}(),pendingArgs.push(args),timer=setTimeout(flush.bind(this),currentWait),options.accumulate){var argsIndex=pendingArgs.length-1;return deferred.promise.then((function(results){return results[argsIndex]}))}return deferred.promise};function flush(){var thisDeferred=deferred;clearTimeout(timer),Promise.resolve(options.accumulate?fn.call(this,pendingArgs):fn.apply(this,pendingArgs[pendingArgs.length-1])).then(thisDeferred.resolve,thisDeferred.reject),pendingArgs=[],deferred=null}}},"./src/react-extension/components/Administration/DisplaySelfRegistrationAdministration/DisplaySelfRegistrationAdministration.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>DisplaySelfRegistrationAdministration_DisplaySelfRegistrationAdministration});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),AdministrationWorkspaceContext=__webpack_require__("./src/react-extension/contexts/AdministrationWorkspaceContext.js"),es=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),AppContext=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),v4=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js"),DomainUtil=__webpack_require__("./src/react-extension/lib/Domain/DomainUtil.js"),MapObject=__webpack_require__("./src/react-extension/lib/Map/MapObject.js"),AdministrationSelfRegistrationContext=__webpack_require__("./src/react-extension/contexts/Administration/AdministrationSelfRegistration/AdministrationSelfRegistrationContext.js");const map=new Map;function setRef(key){if("string"!=typeof key)return console.warn("useDynamicRefs: Cannot set ref without key");const ref=react.createRef();return map.set(key,ref),ref}function getRef(key){return key?map.get(key):console.warn("useDynamicRefs: Cannot get ref without key")}const DynamicRef=function useDynamicRefs(){return{getRef,setRef}};var DialogContext=__webpack_require__("./src/react-extension/contexts/DialogContext.js"),SelfRegistrationDomainsViewModel=__webpack_require__("./src/shared/models/selfRegistration/SelfRegistrationDomainsViewModel.js"),dist=__webpack_require__("./node_modules/debounce-promise/dist/index.js"),dist_default=__webpack_require__.n(dist),portals=__webpack_require__("./src/shared/utils/portals.js"),file_text=__webpack_require__("./src/img/svg/file_text.svg");class DisplayAdministrationSelfRegistrationActions extends react.Component{constructor(props){super(props),this.bindCallbacks()}bindCallbacks(){this.handleSave=this.handleSave.bind(this)}get allowedDomains(){return this.props.adminSelfRegistrationContext.getAllowedDomains()}isSaveEnabled(){let isFirstUsageWithoutChanges=!1;return this.props.adminSelfRegistrationContext.getCurrentSettings()?.provider||(isFirstUsageWithoutChanges=!this.props.adminSelfRegistrationContext.hasSettingsChanges()),!this.props.adminSelfRegistrationContext.isProcessing()&&!isFirstUsageWithoutChanges}async handleSave(){this.isSaveEnabled()&&this.props.adminSelfRegistrationContext.save()}render(){return react.createElement("div",{className:"actions-wrapper"},react.createElement("button",{className:"button primary form",type:"button",disabled:!this.isSaveEnabled(),id:"save-settings",onClick:this.handleSave},react.createElement("span",null,react.createElement(es.x6,null,"Save"))))}}DisplayAdministrationSelfRegistrationActions.propTypes={adminSelfRegistrationContext:prop_types_default().object,t:prop_types_default().func};const DisplayAdministrationSelfRegistrationActions_DisplayAdministrationSelfRegistrationActions=(0,es.CI)("common")((0,AdministrationSelfRegistrationContext.v6)(DisplayAdministrationSelfRegistrationActions));DisplayAdministrationSelfRegistrationActions.__docgenInfo={description:"This component is a container of multiple actions applicable on setting",methods:[{name:"bindCallbacks",docblock:"Bind callbacks methods",modifiers:[],params:[],returns:null,description:"Bind callbacks methods"},{name:"allowedDomains",docblock:"return the allowed domains",modifiers:["get"],params:[],returns:null,description:"return the allowed domains"},{name:"isSaveEnabled",docblock:"Is save button enable\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Is save button enable"},{name:"handleSave",docblock:"Handle the save action.\nIn case we have more than one domain and we have changes, we should display a confirmation dialog to inform the user\n@return {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Handle the save action.\nIn case we have more than one domain and we have changes, we should display a confirmation dialog to inform the user"}],displayName:"DisplayAdministrationSelfRegistrationActions",props:{adminSelfRegistrationContext:{description:"",type:{name:"object"},required:!1},t:{description:"",type:{name:"func"},required:!1}}};var add=__webpack_require__("./src/img/svg/add.svg"),svg_delete=__webpack_require__("./src/img/svg/delete.svg");class DisplaySelfRegistrationAdministration extends react.Component{constructor(props){super(props),this.state=this.defaultState,this.dynamicRefs=DynamicRef(),this.checkForPublicDomainDebounce=dist_default()(this.checkForWarnings,300),this.bindCallbacks()}async componentDidMount(){await this.findSettings()}componentDidUpdate(){this.shouldFocusOnError(),this.shouldCheckWarnings()}componentWillUnmount(){this.props.administrationWorkspaceContext.resetDisplayAdministrationWorkspaceAction(),this.props.adminSelfRegistrationContext.clearContext()}get defaultState(){return{isEnabled:!1,warnings:new Map}}bindCallbacks(){this.handleToggleClicked=this.handleToggleClicked.bind(this),this.handleAddRowClick=this.handleAddRowClick.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleDeleteRow=this.handleDeleteRow.bind(this)}get currentUser(){return this.props.context.loggedInUser}get allowedDomains(){return this.props.adminSelfRegistrationContext.getAllowedDomains()}async findSettings(){await this.props.adminSelfRegistrationContext.findSettings(),this.setState({isEnabled:this.allowedDomains.size>0}),this.checkForWarnings(),this.validateForm()}checkForWarnings(){this.setState({warnings:new Map},(()=>{this.allowedDomains.forEach(((value,key)=>this.checkDomainIsProfessional(key,value)))}))}setupSettings(){if(this.props.adminSelfRegistrationContext.setDomains(new SelfRegistrationDomainsViewModel.A(this.props.adminSelfRegistrationContext.getCurrentSettings())),this.checkForWarnings(),0===this.allowedDomains.size){const domain=DomainUtil.A.extractDomainFromEmail(this.currentUser?.username);DomainUtil.A.checkDomainValidity(domain),this.populateUserDomain(domain)}}shouldFocusOnError(){const onFocus=this.props.adminSelfRegistrationContext.shouldFocus(),[error]=this.props.adminSelfRegistrationContext.getErrors().keys();if(error&&onFocus){this.dynamicRefs.getRef(error).current.focus(),this.props.adminSelfRegistrationContext.setFocus(!1)}}shouldCheckWarnings(){this.props.adminSelfRegistrationContext.isSaved()&&(this.props.adminSelfRegistrationContext.setSaved(!1),this.checkForWarnings())}populateUserDomain(domain){const row=DomainUtil.A.isProfessional(domain)?domain:"";this.addRow(row)}addRow(value=""){const uuid=(0,v4.A)();this.props.adminSelfRegistrationContext.setAllowedDomains(uuid,value,(()=>{const inputRef=this.dynamicRefs.getRef(uuid);inputRef?.current.focus()}))}handleDeleteRow(key){if(this.canDelete()){const domains=this.allowedDomains;domains.delete(key),this.props.adminSelfRegistrationContext.setDomains({allowedDomains:domains}),this.validateForm(),this.checkForWarnings()}}hasWarnings(){return this.state.warnings.size>0}hasAllInputDisabled(){return this.props.adminSelfRegistrationContext.isProcessing()}handleToggleClicked(){this.setState({isEnabled:!this.state.isEnabled},(()=>{this.state.isEnabled?this.setupSettings():(this.props.adminSelfRegistrationContext.setDomains({allowedDomains:new Map}),this.props.adminSelfRegistrationContext.setErrors(new Map))}))}handleAddRowClick(){this.addRow()}checkDomainIsProfessional(uuid,value){this.setState((prevState=>{const warnings=MapObject.A.clone(prevState.warnings);return DomainUtil.A.isProfessional(value)?warnings.delete(uuid):warnings.set(uuid,"This is not a safe professional domain"),{warnings}}))}handleInputChange(event){const value=event.target.value,uuid=event.target.name;this.props.adminSelfRegistrationContext.setAllowedDomains(uuid,value,(()=>this.validateForm())),this.checkForPublicDomainDebounce()}validateForm(){this.props.adminSelfRegistrationContext.validateForm()}canDelete(){return this.allowedDomains.size>1}render(){const isSubmitted=this.props.adminSelfRegistrationContext.isSubmitted(),errors=this.props.adminSelfRegistrationContext.getErrors();return react.createElement("div",{className:"row"},react.createElement(react.Fragment,null,react.createElement("div",{className:"self-registration main-column"},react.createElement("div",{className:"main-content"},react.createElement("h3",null,react.createElement("span",{className:"input toggle-switch form-element"},react.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"settings-toggle",onChange:this.handleToggleClicked,checked:this.state.isEnabled,disabled:this.hasAllInputDisabled(),id:"settings-toggle"}),react.createElement("label",{htmlFor:"settings-toggle"},react.createElement(es.x6,null,"Self Registration")))),!this.state.isEnabled&&react.createElement("p",{className:"description",id:"disabled-description"},react.createElement(es.x6,null,"User self registration is disabled.")," ",react.createElement(es.x6,null,"Only administrators can invite users to register.")),this.state.isEnabled&&react.createElement("div",{className:"self-registration-form"},react.createElement("div",{id:"self-registration-subtitle",className:`input ${this.hasWarnings()&&"warning"} ${isSubmitted&&errors.size>0&&"error"}`},react.createElement("label",{id:"enabled-label"},react.createElement(es.x6,null,"Email domain safe list"))),react.createElement("p",{className:"description",id:"enabled-description"},react.createElement(es.x6,null,"All the users with an email address ending with the domain in the safe list are allowed to register on passbolt.")),MapObject.A.iterators(this.allowedDomains).map((key=>react.createElement("div",{key,className:"input"},react.createElement("div",{className:"domain-row"},react.createElement("input",{type:"text",className:"full-width",onChange:this.handleInputChange,id:`input-${key}`,name:key,value:this.allowedDomains.get(key),disabled:!this.hasAllInputDisabled,ref:this.dynamicRefs.setRef(key),placeholder:this.props.t("domain")}),react.createElement("button",{type:"button",disabled:!this.canDelete(),className:"button-icon",id:`delete-${key}`,onClick:()=>this.handleDeleteRow(key)},react.createElement(svg_delete.A,null))),this.hasWarnings()&&this.state.warnings.get(key)&&react.createElement("div",{id:"domain-name-input-feedback",className:"warning-message"},react.createElement(es.x6,null,this.state.warnings.get(key))),errors.get(key)&&isSubmitted&&react.createElement("div",{className:"error-message"},react.createElement(es.x6,null,errors.get(key)))))),react.createElement("div",{className:"domain-add"},react.createElement("button",{type:"button",onClick:this.handleAddRowClick},react.createElement(add.A,null),react.createElement("span",null,react.createElement(es.x6,null,"Add")))))),this.props.adminSelfRegistrationContext.hasSettingsChanges()&&react.createElement("div",{className:"warning message",id:"self-registration-setting-overridden-banner"},react.createElement("div",null,react.createElement("p",null,react.createElement(es.x6,null,"Don't forget to save your settings to apply your modification."))))),react.createElement(DisplayAdministrationSelfRegistrationActions_DisplayAdministrationSelfRegistrationActions,null)),(0,portals.m)(react.createElement("div",{className:"sidebar-help-section"},react.createElement("h3",null,react.createElement(es.x6,null,"What is user self registration?")),react.createElement("p",null,react.createElement(es.x6,null,"User self registration enables users with an email from a whitelisted domain to create their passbolt account without prior admin invitation.")),react.createElement("a",{className:"button",href:"https://passbolt.com/docs/admin/user-provisioning/self-registration/",target:"_blank",rel:"noopener noreferrer"},react.createElement(file_text.A,null),react.createElement("span",null,react.createElement(es.x6,null,"Read the documentation")))),document.getElementById("administration-help-panel")))}}DisplaySelfRegistrationAdministration.propTypes={dialogContext:prop_types_default().any,context:prop_types_default().any,adminSelfRegistrationContext:prop_types_default().object,administrationWorkspaceContext:prop_types_default().object,t:prop_types_default().func};const DisplaySelfRegistrationAdministration_DisplaySelfRegistrationAdministration=(0,AppContext.L)((0,DialogContext.z9)((0,AdministrationSelfRegistrationContext.v6)((0,AdministrationWorkspaceContext.Kk)((0,es.CI)("common")(DisplaySelfRegistrationAdministration)))));DisplaySelfRegistrationAdministration.__docgenInfo={description:"This component allows to display the Self registration for the administration",methods:[{name:"defaultState",docblock:"Get default state\n@returns {*}",modifiers:["get"],params:[],returns:{type:{name:"mixed"}},description:"Get default state"},{name:"bindCallbacks",docblock:"Bind callbacks methods",modifiers:[],params:[],returns:null,description:"Bind callbacks methods"},{name:"currentUser",docblock:"return the current user",modifiers:["get"],params:[],returns:null,description:"return the current user"},{name:"allowedDomains",docblock:"return the allowed domains",modifiers:["get"],params:[],returns:null,description:"return the allowed domains"},{name:"findSettings",docblock:"Bind callbacks methods",modifiers:["async"],params:[],returns:null,description:"Bind callbacks methods"},{name:"checkForWarnings",docblock:"We check for warnings and errors into the form",modifiers:[],params:[],returns:null,description:"We check for warnings and errors into the form"},{name:"setupSettings",docblock:"setup settings for the first time",modifiers:[],params:[],returns:null,description:"setup settings for the first time"},{name:"shouldFocusOnError",docblock:"set focus to the first input error",modifiers:[],params:[],returns:null,description:"set focus to the first input error"},{name:"shouldCheckWarnings",docblock:"in case of saved settings we should check warnings again",modifiers:[],params:[],returns:null,description:"in case of saved settings we should check warnings again"},{name:"populateUserDomain",docblock:"Check domain and populate it if it is a professional\n@param {string} domain",modifiers:[],params:[{name:"domain",type:{name:"string"},optional:!1}],returns:null,description:"Check domain and populate it if it is a professional"},{name:"addRow",docblock:"Check domain and populate it if is a professional domain\n@param {string} domain",modifiers:[],params:[{name:"value",optional:!0}],returns:null,description:"Check domain and populate it if is a professional domain"},{name:"handleDeleteRow",docblock:"Remove a domain row\n@param {string} key",modifiers:[],params:[{name:"key",type:{name:"string"},optional:!1}],returns:null,description:"Remove a domain row"},{name:"hasWarnings",docblock:"Check if inputs has warnings",modifiers:[],params:[],returns:null,description:"Check if inputs has warnings"},{name:"hasAllInputDisabled",docblock:"Should input be disabled? True if state is loading or processing\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Should input be disabled? True if state is loading or processing"},{name:"handleToggleClicked",docblock:"Handle the click on the self registration title\n@param {UserDirectory} userDirectory state",modifiers:[],params:[],returns:null,description:"Handle the click on the self registration title"},{name:"handleAddRowClick",docblock:"Handle the click on the add button",modifiers:[],params:[],returns:null,description:"Handle the click on the add button"},{name:"checkDomainIsProfessional",docblock:"check if domain is a professional one",modifiers:[],params:[{name:"uuid",optional:!1},{name:"value",optional:!1}],returns:null,description:"check if domain is a professional one"},{name:"handleInputChange",docblock:"Handle input change\n@param event",modifiers:[],params:[{name:"event",optional:!1}],returns:null,description:"Handle input change"},{name:"validateForm",docblock:"validate the form\n@returns {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"validate the form"},{name:"canDelete",docblock:"we cannot delete a row if we have only one domaine\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"we cannot delete a row if we have only one domaine"}],displayName:"DisplaySelfRegistrationAdministration",props:{dialogContext:{description:"",type:{name:"any"},required:!1},context:{description:"",type:{name:"any"},required:!1},adminSelfRegistrationContext:{description:"",type:{name:"object"},required:!1},administrationWorkspaceContext:{description:"",type:{name:"object"},required:!1},t:{description:"",type:{name:"func"},required:!1}}}},"./src/react-extension/components/Common/Inputs/FormSubmitButton/FormCancelButton.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__),react_i18next__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js");class FormCancelButton extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.bindCallbacks()}bindCallbacks(){this.handleClick=this.handleClick.bind(this)}handleClick(){this.props.disabled||this.props.onClick()}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{type:"button",disabled:this.props.disabled,className:"link cancel",onClick:this.handleClick},this.props.value)}}FormCancelButton.defaultProps={value:react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_1__.x6,null,"Cancel")},FormCancelButton.propTypes={disabled:prop_types__WEBPACK_IMPORTED_MODULE_2___default().bool,onClick:prop_types__WEBPACK_IMPORTED_MODULE_2___default().func,value:prop_types__WEBPACK_IMPORTED_MODULE_2___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_2___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_2___default().node),prop_types__WEBPACK_IMPORTED_MODULE_2___default().node,prop_types__WEBPACK_IMPORTED_MODULE_2___default().string])};const __WEBPACK_DEFAULT_EXPORT__=(0,react_i18next__WEBPACK_IMPORTED_MODULE_1__.CI)("common")(FormCancelButton);FormCancelButton.__docgenInfo={description:"",methods:[{name:"bindCallbacks",docblock:"Bind callbacks methods\n@return {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Bind callbacks methods"},{name:"handleClick",docblock:"Handle cancel click\n@return {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Handle cancel click"}],displayName:"FormCancelButton",props:{value:{defaultValue:{value:"<Trans>Cancel</Trans>",computed:!1},description:"",type:{name:"union",value:[{name:"arrayOf",value:{name:"node"}},{name:"node"},{name:"string"}]},required:!1},disabled:{description:"",type:{name:"bool"},required:!1},onClick:{description:"",type:{name:"func"},required:!1}}}},"./src/react-extension/components/Common/Inputs/FormSubmitButton/FormSubmitButton.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_3__),_img_svg_spinner_svg__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/img/svg/spinner.svg"),react_i18next__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js");class FormSubmitButton extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.bindCallbacks()}bindCallbacks(){this.getClassName=this.getClassName.bind(this)}getClassName(){let name="button primary form";return this.props.warning?name+=" warning":this.props.attention&&(name+=" attention"),this.props.disabled&&(name+=" disabled"),this.props.processing&&(name+=" processing"),this.props.big&&(name+=" big"),this.props.medium&&(name+=" medium"),this.props.fullWidth&&(name+=" full-width"),name}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{type:"submit",className:this.getClassName(),disabled:this.props.disabled},this.props.value||react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_2__.x6,null,"Save"),this.props.processing&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_img_svg_spinner_svg__WEBPACK_IMPORTED_MODULE_1__.A,null))}}FormSubmitButton.defaultProps={warning:!1,attention:!1},FormSubmitButton.propTypes={processing:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,disabled:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,value:prop_types__WEBPACK_IMPORTED_MODULE_3___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_3___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_3___default().node),prop_types__WEBPACK_IMPORTED_MODULE_3___default().node,prop_types__WEBPACK_IMPORTED_MODULE_3___default().string]),warning:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,attention:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,big:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,medium:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,fullWidth:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool};const __WEBPACK_DEFAULT_EXPORT__=(0,react_i18next__WEBPACK_IMPORTED_MODULE_2__.CI)("common")(FormSubmitButton);FormSubmitButton.__docgenInfo={description:"",methods:[{name:"bindCallbacks",docblock:"Bind callbacks methods\n@return {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Bind callbacks methods"},{name:"getClassName",docblock:"Get the input button classname\n@returns {string}",modifiers:[],params:[],returns:{type:{name:"string"}},description:"Get the input button classname"}],displayName:"FormSubmitButton",props:{warning:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},attention:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},processing:{description:"",type:{name:"bool"},required:!1},disabled:{description:"",type:{name:"bool"},required:!1},value:{description:"",type:{name:"union",value:[{name:"arrayOf",value:{name:"node"}},{name:"node"},{name:"string"}]},required:!1},big:{description:"",type:{name:"bool"},required:!1},medium:{description:"",type:{name:"bool"},required:!1},fullWidth:{description:"",type:{name:"bool"},required:!1}}}},"./src/react-extension/contexts/ApiAppContext.test.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{s:()=>defaultAppContext});var _shared_lib_Settings_SiteSettings__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/lib/Settings/SiteSettings.js"),_test_fixture_Settings_siteSettings__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/react-extension/test/fixture/Settings/siteSettings.js"),_shared_lib_apiClient_apiClientOptions__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/shared/lib/apiClient/apiClientOptions.js"),_test_mock_MockPort__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/react-extension/test/mock/MockPort.js"),_shared_lib_Settings_UserSettings__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/shared/lib/Settings/UserSettings.js"),_test_fixture_Settings_userSettings__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/react-extension/test/fixture/Settings/userSettings.js");function defaultAppContext(appContext={}){const userSettings=new _shared_lib_Settings_UserSettings__WEBPACK_IMPORTED_MODULE_3__.A(_test_fixture_Settings_userSettings__WEBPACK_IMPORTED_MODULE_2__.A),siteSettings=new _shared_lib_Settings_SiteSettings__WEBPACK_IMPORTED_MODULE_0__.A(_test_fixture_Settings_siteSettings__WEBPACK_IMPORTED_MODULE_1__.A),defaultAppContext1={locale:"en-UK",onRefreshLocaleRequested:jest.fn(),userSettings,siteSettings,trustedDomain:"https://localhost:6006",loggedInUser:{id:userSettings.id,username:"user@passbolt.com",role:{name:"admin"}},port:new _test_mock_MockPort__WEBPACK_IMPORTED_MODULE_4__.A,setContext:jest.fn(),baseUrl:"https://localhost:6006",getApiClientOptions:()=>(new _shared_lib_apiClient_apiClientOptions__WEBPACK_IMPORTED_MODULE_5__.k).setBaseUrl("https://localhost:6006")};return Object.assign(defaultAppContext1,appContext)}},"./src/react-extension/contexts/DialogContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ay:()=>DialogContextProvider,z9:()=>withDialog});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__),uuid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js");const DialogContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext({dialogs:[],open:()=>{},close:()=>{}});class DialogContextProvider extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.defaultState}get defaultState(){return{dialogs:[],open:(Dialog,DialogProps)=>{const dialogKey=(0,uuid__WEBPACK_IMPORTED_MODULE_1__.A)();return this.setState({dialogs:[...this.state.dialogs,{key:dialogKey,Dialog,DialogProps}]}),dialogKey},close:dialogKey=>this.setState({dialogs:this.state.dialogs.filter((dialog=>dialogKey!==dialog.key))}),closeAll:()=>this.setState({dialogs:[]})}}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DialogContext.Provider,{value:this.state},this.props.children)}}function withDialog(WrappedComponent){return class WithDialog extends react__WEBPACK_IMPORTED_MODULE_0__.Component{render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DialogContext.Consumer,null,(dialogContext=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(WrappedComponent,{dialogContext,...this.props})))}}}DialogContextProvider.displayName="DialogContextProvider",DialogContextProvider.propTypes={children:prop_types__WEBPACK_IMPORTED_MODULE_2___default().any},DialogContextProvider.__docgenInfo={description:"The related context provider",methods:[{name:"defaultState",docblock:"Returns the default component state",modifiers:["get"],params:[],returns:null,description:"Returns the default component state"}],displayName:"DialogContextProvider",props:{children:{description:"",type:{name:"any"},required:!1}}}},"./src/react-extension/test/fixture/Settings/userSettings.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__={"user.settings.trustedDomain":new URL(window.location.href).origin,"user.firstname":"Ada","user.id":"f848277c-5398-58f8-a82a-72397af2d450","user.lastname":"Lovelace","user.settings.securityToken.code":"TST","user.settings.securityToken.color":"#000000","user.settings.securityToken.textColor":"#FFFFFF","user.username":"ada@passbolt.com","user.settings.locale":"en-UK","user.settings.theme":"default"}},"./src/react-extension/test/mock/MockFetch.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var fetch_mock__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/fetch-mock/dist/esm/index.js");const __WEBPACK_DEFAULT_EXPORT__=class MockFetch{async addGetFetchRequest(name,callback){await fetch_mock__WEBPACK_IMPORTED_MODULE_0__.Ay.get(name,callback)}async addPostFetchRequest(name,callback){await fetch_mock__WEBPACK_IMPORTED_MODULE_0__.Ay.post(name,callback)}async addPutFetchRequest(name,callback){await fetch_mock__WEBPACK_IMPORTED_MODULE_0__.Ay.put(name,callback)}async addDeleteFetchRequest(name,callback){await fetch_mock__WEBPACK_IMPORTED_MODULE_0__.Ay.delete(name,callback)}}},"./src/react-extension/test/mock/MockPort.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function delay(t,v){return new Promise((resolve=>{setTimeout((()=>resolve(v)),t)}))}__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=class MockPort{constructor(storage){this.storage=storage,this.onListeners={},this.requestListeners={},this.emitListener={},this.onConnectErrorHandler={}}async emit(name,eventObject){let result;return console.debug(`PORT EMIT: ${name}`),console.debug("Arguments",eventObject),this.emitListener[name]?(result=await this.emitListener[name](eventObject),console.debug("response: ",result)):console.debug(`The emit ${name} has not been mocked`),delay(0,result)}on(name,callback){console.debug(`PORT ON: ${name}`),console.debug("PORT ON PARAMETERS:",callback),this.addOnListener(name,callback)}async request(name){let result;if(console.debug(`PORT REQUEST: ${name}`),console.debug("PORT REQUEST PARAMETERS:",Array.prototype.slice.call(arguments)),this.requestListeners[name]){const listenerArguments=Array.prototype.slice.call(arguments,1,arguments.length);console.debug("listenerArguments",listenerArguments),listenerArguments.push(this.storage),console.debug("listenerArguments",listenerArguments),result=await this.requestListeners[name](...listenerArguments),console.debug("response: ",result)}else console.debug(`The request ${name} has not been mocked`);return delay(0,result)}addEmitListener(name){console.debug(`PORT EMIT: ${name}`),console.debug("PORT EMIT PARAMETERS:",Array.prototype.slice.call(arguments))}addOnListener(name,callback){this.emitListener[name]=callback}addRequestListener(name,callback){this.requestListeners[name]=callback}onConnectError(callback){this.onConnectErrorHandler.callback=callback}}},"./src/shared/lib/Settings/UserSettings.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>UserSettings});class UserSettings{constructor(settings){this.settings=settings}get id(){return this.settings["user.id"]}get fullName(){return`${this.settings["user.firstname"]} ${this.settings["user.lastname"]}`}get username(){return this.settings["user.username"]}getTheme(){return this.settings["user.settings.theme"]}getTrustedDomain(){return this.settings["user.settings.trustedDomain"]}getSecurityToken(){return{code:this.settings["user.settings.securityToken.code"],backgroundColor:this.settings["user.settings.securityToken.color"],textColor:this.settings["user.settings.securityToken.textColor"]}}get locale(){return this.settings["user.settings.locale"]}}},"./src/shared/lib/apiClient/apiClientOptions.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{k:()=>ApiClientOptions});class ApiClientOptions{setBaseUrl(baseUrl){if(!baseUrl)throw new TypeError("ApiClientOption baseUrl is required.");if("string"==typeof baseUrl)try{this.baseUrl=new URL(baseUrl)}catch(error){throw new TypeError("ApiClientOption baseUrl is invalid.",{cause:error})}else{if(!(baseUrl instanceof URL))throw new TypeError("ApiClientOptions baseurl should be a string or URL");this.baseUrl=baseUrl}return this}setResourceName(resourceName){if(!resourceName)throw new TypeError("ApiClientOptions.setResourceName resourceName is required.");if("string"!=typeof resourceName)throw new TypeError("ApiClientOptions.setResourceName resourceName should be a valid string.");return this.resourceName=resourceName,this}getBaseUrl(){return this.baseUrl}getResourceName(){return this.resourceName}async getHeaders(){const csrfToken=await this.getCsrfToken();if(csrfToken)return{"X-CSRF-Token":csrfToken}}async getCsrfToken(){if("undefined"==typeof browser||void 0===browser.cookies){const csrfToken=document?.cookie?.split("; ")?.find((row=>row.startsWith("csrfToken")))?.split("=");return csrfToken&&2===csrfToken.length?csrfToken[1]:null}const stringUrl=this.baseUrl.toString(),url="/"===stringUrl.slice(-1)?stringUrl:`${stringUrl}/`,csrfCookie=await browser.cookies.get({name:"csrfToken",url});return csrfCookie?.value||null}}},"./src/shared/models/entity/role/roleEntity.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _abstract_entityV2__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/models/entity/abstract/entityV2.js");class RoleEntity extends _abstract_entityV2__WEBPACK_IMPORTED_MODULE_0__.A{static getSchema(){return{type:"object",required:["id","name"],properties:{id:{type:"string",format:"uuid"},name:{type:"string",enum:[RoleEntity.ROLE_ADMIN,RoleEntity.ROLE_USER,RoleEntity.ROLE_GUEST,RoleEntity.ROLE_ROOT]},description:{type:"string",maxLength:255},created:{type:"string",format:"date-time"},modified:{type:"string",format:"date-time"}}}}get id(){return this._props.id}get name(){return this._props.name}get description(){return this._props.description||null}get created(){return this._props.created||null}get modified(){return this._props.modified||null}isAdmin(){return this.name===RoleEntity.ROLE_ADMIN}static get ENTITY_NAME(){return"Role"}static get ROLE_ADMIN(){return"admin"}static get ROLE_USER(){return"user"}static get ROLE_GUEST(){return"guest"}static get ROLE_ROOT(){return"root"}}const __WEBPACK_DEFAULT_EXPORT__=RoleEntity},"./src/shared/utils/portals.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{m:()=>createSafePortal});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-dom/index.js");function createSafePortal(children,domNode,key){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,domNode&&(0,react_dom__WEBPACK_IMPORTED_MODULE_1__.createPortal)(children,domNode,key))}createSafePortal.__docgenInfo={description:'Create a portal in a "safe" mode.\n"Safe" mode only means that if the given HTML element doesn\'t exist, the method doesn\'t crash.\nIt will simply ignore the rendering if it happens.\n@param {ReactNode} children the elements to render in the portal\n@param {Element | DocumentFragment} domNode the target where to render the children.\n@param {null | string} [key] a React compatible key to be passed to `createPortal` if any\n@returns {JSX}',methods:[],displayName:"createSafePortal"}},"./test/mocks/mockApiResponse.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_:()=>mockApiResponse});const mockApiResponse=(body={},header={})=>Promise.resolve(JSON.stringify({header,body}))}}]);