/*! For license information please see 7445.04ee6008.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkpassbolt_styleguide=self.webpackChunkpassbolt_styleguide||[]).push([[7445],{"./src/img/svg/circle_x.svg":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _g,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const __WEBPACK_DEFAULT_EXPORT__=function SvgCircleX(props){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},props),_g||(_g=react__WEBPACK_IMPORTED_MODULE_0__.createElement("g",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#circle_x_svg__clip0_2831_545000)"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M9 16.5a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15M11.25 6.75l-4.5 4.5M6.75 6.75l4.5 4.5"}))))}},"./src/img/svg/download_file.svg":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _path,_path2,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const __WEBPACK_DEFAULT_EXPORT__=function SvgDownloadFile(props){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},props),_path||(_path=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M11.25 1.5H4.5A1.5 1.5 0 0 0 3 3v12a1.5 1.5 0 0 0 1.5 1.5h9A1.5 1.5 0 0 0 15 15V5.25z"})),_path2||(_path2=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M10.5 1.5v3A1.5 1.5 0 0 0 12 6h3M9 13.5V9M6.75 11.25 9 13.5l2.25-2.25"})))}},"./src/img/svg/folder_plus.svg":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _path,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const __WEBPACK_DEFAULT_EXPORT__=function SvgFolderPlus(props){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},props),_path||(_path=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 7.5V12M6.75 9.75h4.5M15 15a1.5 1.5 0 0 0 1.5-1.5V6A1.5 1.5 0 0 0 15 4.5H9.075a1.5 1.5 0 0 1-1.267-.675l-.608-.9a1.5 1.5 0 0 0-1.253-.675H3a1.5 1.5 0 0 0-1.5 1.5v9.75A1.5 1.5 0 0 0 3 15z"})))}},"./src/img/svg/more_horizontal.svg":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _path,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const __WEBPACK_DEFAULT_EXPORT__=function SvgMoreHorizontal(props){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},props),_path||(_path=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 8.666a.667.667 0 1 0 0-1.333.667.667 0 0 0 0 1.333M12.667 8.666a.667.667 0 1 0 0-1.333.667.667 0 0 0 0 1.333M3.333 8.666a.667.667 0 1 0 0-1.333.667.667 0 0 0 0 1.333"})))}},"./src/img/svg/rename.svg":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _path,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const __WEBPACK_DEFAULT_EXPORT__=function SvgRename(props){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},props),_path||(_path=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 20h9M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4z"})))}},"./src/react-extension/components/Resource/ExportResources/ExportResources.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__),_contexts_ResourceWorkspaceContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/react-extension/contexts/ResourceWorkspaceContext.js"),_contexts_DialogContext__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/react-extension/contexts/DialogContext.js"),_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),_Common_Dialog_DialogWrapper_DialogWrapper__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/react-extension/components/Common/Dialog/DialogWrapper/DialogWrapper.js"),_Common_Inputs_FormSubmitButton_FormSubmitButton__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormSubmitButton.js"),_Common_Inputs_FormSubmitButton_FormCancelButton__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormCancelButton.js"),_Common_Error_NotifyError_NotifyError__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/react-extension/components/Common/Error/NotifyError/NotifyError.js"),_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./src/react-extension/contexts/ActionFeedbackContext.js"),_ExportResourcesCredentials__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./src/react-extension/components/Resource/ExportResources/ExportResourcesCredentials.js"),react_i18next__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),_Common_Select_Select__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./src/react-extension/components/Common/Select/Select.js");class ExportResources extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.defaultState,this.bindHandlers()}get defaultState(){return{selectedExportFormat:this.exportFormats[0].value,actions:{processing:!1}}}bindHandlers(){this.handleExport=this.handleExport.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleClose=this.handleClose.bind(this),this.handleExportFormatSelected=this.handleExportFormatSelected.bind(this)}componentDidMount(){this.findContentToExport()}findContentToExport(){const foldersIds=this.findFoldersIdsToExport(),resourcesIds=this.findResourcesIdsToExport(foldersIds);this.props.resourceWorkspaceContext.onResourcesToExport({resourcesIds,foldersIds})}get isProcessing(){return this.state.actions.processing}get areActionsAllowed(){return!this.isProcessing}get hasFoldersToExport(){const foldersIds=this.props.resourceWorkspaceContext.resourcesToExport.foldersIds;return foldersIds&&foldersIds.length>0}get hasResourcesToExport(){const resourcesIds=this.props.resourceWorkspaceContext.resourcesToExport.resourcesIds;return resourcesIds&&resourcesIds.length>0}findFoldersIdsToExport(){if(!this.hasFoldersToExport)return[];const foldersIds=this.props.resourceWorkspaceContext.resourcesToExport.foldersIds,childrenFoldersIds=foldersIds.map(folderId=>this.getChildrenFoldersIds(folderId)).flat();return[...foldersIds,...childrenFoldersIds]}getChildrenFoldersIds(folderId){const childrenFoldersIds=this.props.context.folders.filter(folder=>folder.folder_parent_id===folderId).map(folder=>folder.id);if(0!==childrenFoldersIds.length){const grandChildrenFolders=childrenFoldersIds.map(childFolderId=>this.getChildrenFoldersIds(childFolderId));return[...childrenFoldersIds,...grandChildrenFolders.flat()]}return[]}findResourcesIdsToExport(foldersIds){const resourcesIdsOfFoldersIds=this.getResourcesIdsOfFoldersToExport(foldersIds),resourcesIdsToExport=this.props.resourceWorkspaceContext.resourcesToExport.resourcesIds||[];return Array.from(new Set([...resourcesIdsToExport,...resourcesIdsOfFoldersIds]))}getResourcesIdsOfFoldersToExport(foldersIds){return this.props.context.resources.filter(resource=>foldersIds.some(folderId=>folderId===resource.folder_parent_id)).map(resource=>resource.id)}get exportFormats(){return[{label:"kdbx (keepass)",value:"kdbx"},{label:"kdbx (keepassXC & others)",value:"kdbx-others"},{label:"csv (keepass)",value:"csv-kdbx"},{label:"csv (lastpass)",value:"csv-lastpass"},{label:"csv (1password)",value:"csv-1password"},{label:"csv (chromium based browsers)",value:"csv-chromium"},{label:"csv (bitwarden)",value:"csv-bitwarden"},{label:"csv (mozilla)",value:"csv-mozilla"},{label:"csv (safari)",value:"csv-safari"},{label:"csv (dashlane)",value:"csv-dashlane"},{label:"csv (nordpass)",value:"csv-nordpass"},{label:"csv (logmeonce)",value:"csv-logmeonce"}]}handleExportFormatSelected(event){this.selectFormat(event.target.value)}async handleExport(event){event.preventDefault();this.state.selectedExportFormat.startsWith("csv")?(await this.setState({actions:{processing:!0}}),this.export().then(this.onExportSuccess.bind(this)).catch(this.onExportFailure.bind(this))):(await this.props.dialogContext.open(_ExportResourcesCredentials__WEBPACK_IMPORTED_MODULE_10__.A,{format:this.state.selectedExportFormat}),this.close())}async handleCancel(){await this.props.resourceWorkspaceContext.onResourcesToExport({resourcesIds:null,foldersIds:null}),this.close()}async handleClose(){await this.props.resourceWorkspaceContext.onResourcesToExport({resourcesIds:null,foldersIds:null}),this.close()}selectFormat(selectedExportFormat){this.setState({selectedExportFormat})}async export(){const foldersIds=this.props.resourceWorkspaceContext.resourcesToExport.foldersIds,resourcesIds=this.props.resourceWorkspaceContext.resourcesToExport.resourcesIds,exportDto={format:this.state.selectedExportFormat,folders_ids:foldersIds,resources_ids:resourcesIds};await this.props.context.port.request("passbolt.export-resources.export-to-file",exportDto)}async onExportSuccess(){await this.setState({actions:{processing:!1}}),await this.props.actionFeedbackContext.displaySuccess(this.translate("The passwords have been exported successfully")),await this.props.resourceWorkspaceContext.onResourcesToExport({resourcesIds:null,foldersIds:null}),this.close()}onExportFailure(error){if("UserAbortsOperationError"===error.name)return void this.setState({actions:{processing:!1}});const errorDialogProps={error};this.setState({actions:{processing:!1}}),this.props.dialogContext.open(_Common_Error_NotifyError_NotifyError__WEBPACK_IMPORTED_MODULE_8__.A,errorDialogProps)}close(){this.props.onClose()}get translate(){return this.props.t}render(){const foldersIdsToExport=this.hasFoldersToExport&&this.props.resourceWorkspaceContext.resourcesToExport.foldersIds,resourcesIdsToExport=this.hasResourcesToExport&&this.props.resourceWorkspaceContext.resourcesToExport.resourcesIds;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Dialog_DialogWrapper_DialogWrapper__WEBPACK_IMPORTED_MODULE_5__.A,{title:this.translate("Export passwords"),onClose:this.handleClose,disabled:!this.areActionsAllowed},react__WEBPACK_IMPORTED_MODULE_0__.createElement("form",{onSubmit:this.handleExport,noValidate:!0},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"form-content"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"select-wrapper input required "+(this.areActionsAllowed?"":"disabled")},react__WEBPACK_IMPORTED_MODULE_0__.createElement("label",{htmlFor:"export-format"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_11__.x6,null,"Choose the export format (csv and kdbx are supported)")),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Select_Select__WEBPACK_IMPORTED_MODULE_12__.A,{id:"export-format",value:this.state.selectedExportFormat,items:this.exportFormats,onChange:this.handleExportFormatSelected,disabled:!this.areActionsAllowed})),this.hasFoldersToExport&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement("em",null,this.translate("{{count}} folder is going to be exported.",{count:foldersIdsToExport.length}))),this.hasResourcesToExport&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement("em",null,this.translate("{{count}} password is going to be exported.",{count:resourcesIdsToExport.length})))),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"submit-wrapper clearfix"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Inputs_FormSubmitButton_FormCancelButton__WEBPACK_IMPORTED_MODULE_7__.A,{disabled:!this.areActionsAllowed,processing:this.isProcessing,onClick:this.handleCancel}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Inputs_FormSubmitButton_FormSubmitButton__WEBPACK_IMPORTED_MODULE_6__.A,{disabled:!this.areActionsAllowed,processing:this.isProcessing,value:this.translate("Export")}))))}}ExportResources.propTypes={context:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,onClose:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func,resourceWorkspaceContext:prop_types__WEBPACK_IMPORTED_MODULE_1___default().object,dialogContext:prop_types__WEBPACK_IMPORTED_MODULE_1___default().object,actionFeedbackContext:prop_types__WEBPACK_IMPORTED_MODULE_1___default().object,t:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func};const __WEBPACK_DEFAULT_EXPORT__=(0,_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_4__.L)((0,_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_9__.ot)((0,_contexts_DialogContext__WEBPACK_IMPORTED_MODULE_3__.z9)((0,_contexts_ResourceWorkspaceContext__WEBPACK_IMPORTED_MODULE_2__.Qw)((0,react_i18next__WEBPACK_IMPORTED_MODULE_11__.CI)("common")(ExportResources)))));ExportResources.__docgenInfo={description:"This component allows to export resources to a specified format",methods:[{name:"defaultState",docblock:"Returns the component default state",modifiers:["get"],params:[],returns:null,description:"Returns the component default state"},{name:"bindHandlers",docblock:"Bind the component handlers",modifiers:[],params:[],returns:null,description:"Bind the component handlers"},{name:"findContentToExport",docblock:"Find the content to export and update the context.",modifiers:[],params:[],returns:null,description:"Find the content to export and update the context."},{name:"isProcessing",docblock:"Return trus if the export is processing",modifiers:["get"],params:[],returns:null,description:"Return trus if the export is processing"},{name:"areActionsAllowed",docblock:"Returns true if actions can be performed",modifiers:["get"],params:[],returns:null,description:"Returns true if actions can be performed"},{name:"hasFoldersToExport",docblock:"Returns true if some folders must be exported",modifiers:["get"],params:[],returns:null,description:"Returns true if some folders must be exported"},{name:"hasResourcesToExport",docblock:"Returns true if some resources must be exported",modifiers:["get"],params:[],returns:null,description:"Returns true if some resources must be exported"},{name:"findFoldersIdsToExport",docblock:"Returns the folders identifiers to export",modifiers:[],params:[],returns:null,description:"Returns the folders identifiers to export"},{name:"getChildrenFoldersIds",docblock:"Returns the children folders ids of the given folder\n@param folderId A folder identifier",modifiers:[],params:[{name:"folderId",description:"A folder identifier",optional:!1}],returns:null,description:"Returns the children folders ids of the given folder"},{name:"findResourcesIdsToExport",docblock:"Returns the resources identifiers to export\n@param {array} foldersIds The list of folders to crawl for resources",modifiers:[],params:[{name:"foldersIds",description:"The list of folders to crawl for resources",type:{name:"array"},optional:!1}],returns:null,description:"Returns the resources identifiers to export"},{name:"getResourcesIdsOfFoldersToExport",docblock:"Returns the resources ids of the folders to export\n@param foldersIds The folders to look into",modifiers:[],params:[{name:"foldersIds",description:"The folders to look into",optional:!1}],returns:null,description:"Returns the resources ids of the folders to export"},{name:"exportFormats",docblock:"Returns the list of available export formats",modifiers:["get"],params:[],returns:null,description:"Returns the list of available export formats"},{name:"handleExportFormatSelected",docblock:"Whenever the user selects an export format\n@param event Select DOM event",modifiers:[],params:[{name:"event",description:"Select DOM event",optional:!1}],returns:null,description:"Whenever the user selects an export format"},{name:"handleExport",docblock:"Whenever the export is submitted\n@param event A dom event",modifiers:["async"],params:[{name:"event",description:"A dom event",optional:!1}],returns:null,description:"Whenever the export is submitted"},{name:"handleCancel",docblock:"Whenever the export is cancelled",modifiers:["async"],params:[],returns:null,description:"Whenever the export is cancelled"},{name:"handleClose",docblock:"Whenever the dialog is closed",modifiers:["async"],params:[],returns:null,description:"Whenever the dialog is closed"},{name:"selectFormat",docblock:"Select the export format\n@param selectedExportFormat The selected export format",modifiers:[],params:[{name:"selectedExportFormat",description:"The selected export format",optional:!1}],returns:null,description:"Select the export format"},{name:"export",docblock:"Export the selected resources or folders",modifiers:["async"],params:[],returns:null,description:"Export the selected resources or folders"},{name:"onExportSuccess",docblock:"Whenever the export has been performed successfully",modifiers:["async"],params:[],returns:null,description:"Whenever the export has been performed successfully"},{name:"onExportFailure",docblock:"Whenever the export has been performed with failure",modifiers:[],params:[{name:"error",optional:!1}],returns:null,description:"Whenever the export has been performed with failure"},{name:"close",docblock:"Close the dialog",modifiers:[],params:[],returns:null,description:"Close the dialog"},{name:"translate",docblock:"Get the translate function\n@returns {function(...[*]=)}",modifiers:["get"],params:[],returns:{},description:"Get the translate function"}],displayName:"ExportResources",props:{context:{description:"",type:{name:"any"},required:!1},onClose:{description:"",type:{name:"func"},required:!1},resourceWorkspaceContext:{description:"",type:{name:"object"},required:!1},dialogContext:{description:"",type:{name:"object"},required:!1},actionFeedbackContext:{description:"",type:{name:"object"},required:!1},t:{description:"",type:{name:"func"},required:!1}}}},"./src/react-extension/components/Resource/ExportResources/ExportResourcesCredentials.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__),_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/react-extension/contexts/ActionFeedbackContext.js"),_contexts_DialogContext__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/react-extension/contexts/DialogContext.js"),_Common_Dialog_DialogWrapper_DialogWrapper__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/react-extension/components/Common/Dialog/DialogWrapper/DialogWrapper.js"),_Common_Inputs_FormSubmitButton_FormSubmitButton__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormSubmitButton.js"),_Common_Inputs_FormSubmitButton_FormCancelButton__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormCancelButton.js"),_contexts_ResourceWorkspaceContext__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/react-extension/contexts/ResourceWorkspaceContext.js"),_Common_Error_NotifyError_NotifyError__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./src/react-extension/components/Common/Error/NotifyError/NotifyError.js"),react_i18next__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),_shared_components_Password_Password__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./src/shared/components/Password/Password.js");class ExportResourcesCredentials extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.defaultState,this.bindHandlers(),this.createReferences()}get defaultState(){return{password:"",keyFile:null,actions:{processing:!1}}}bindHandlers(){this.handleInputChange=this.handleInputChange.bind(this),this.handleSelectFile=this.handleSelectFile.bind(this),this.handleFileSelected=this.handleFileSelected.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}createReferences(){this.fileUploaderRef=react__WEBPACK_IMPORTED_MODULE_0__.createRef(),this.passwordInputRef=react__WEBPACK_IMPORTED_MODULE_0__.createRef()}get selectedFilename(){return this.state.keyFile?this.state.keyFile.name:""}get isProcessing(){return this.state.actions.processing}get areActionsAllowed(){return!this.isProcessing}handleSelectFile(){this.fileUploaderRef.current.click()}async handleFileSelected(event){const[keyFile]=event.target.files;await this.setState({keyFile})}handleInputChange(event){const target=event.target,value=target.value,name=target.name;this.setState({[name]:value})}handleCancel(){this.close()}async handleSubmit(event){event.preventDefault(),await this.setState({actions:{processing:!0}}),await this.export().then(this.onExportSuccess.bind(this)).catch(this.onExportFailure.bind(this))}async export(){const options={credentials:{password:this.state.password,keyfile:await this.readFile()}},foldersIds=this.props.resourceWorkspaceContext.resourcesToExport.foldersIds,resourcesIds=this.props.resourceWorkspaceContext.resourcesToExport.resourcesIds,exportDto={format:this.props.format,folders_ids:foldersIds,resources_ids:resourcesIds,options};await this.props.context.port.request("passbolt.export-resources.export-to-file",exportDto)}readFile(){if(!this.state.keyFile)return;const reader=new FileReader;return new Promise((resolve,reject)=>{reader.onloadend=event=>{try{const fileBase64=event.target.result.split(",")[1];resolve(fileBase64)}catch(e){reject(e)}},reader.readAsDataURL(this.state.keyFile)})}async onExportSuccess(){await this.props.resourceWorkspaceContext.onResourcesToExport({resourcesIds:null,foldersIds:null}),await this.props.actionFeedbackContext.displaySuccess(this.translate("The passwords have been exported successfully")),this.close()}onExportFailure(error){if("UserAbortsOperationError"===error.name)return void this.setState({actions:{processing:!1}});const errorDialogProps={error};this.setState({actions:{processing:!1}}),this.props.dialogContext.open(_Common_Error_NotifyError_NotifyError__WEBPACK_IMPORTED_MODULE_9__.A,errorDialogProps)}close(){this.props.onClose()}get translate(){return this.props.t}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Dialog_DialogWrapper_DialogWrapper__WEBPACK_IMPORTED_MODULE_5__.A,{title:this.translate("Enter the password and/or key file"),className:"export-password-dialog",onClose:this.handleCancel,disabled:!this.areActionsAllowed},react__WEBPACK_IMPORTED_MODULE_0__.createElement("form",{onSubmit:this.handleSubmit},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"form-content"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"input-password-wrapper input "+(this.areActionsAllowed?"":"disabled")},react__WEBPACK_IMPORTED_MODULE_0__.createElement("label",{htmlFor:"password"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_10__.x6,null,"Keepass password")),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_shared_components_Password_Password__WEBPACK_IMPORTED_MODULE_11__.A,{id:"password",name:"password",value:this.state.password,onChange:this.handleInputChange,placeholder:this.translate("Passphrase"),autoComplete:"off",inputRef:this.passwordInputRef,preview:!0,disabled:!this.areActionsAllowed})),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"input file "+(this.areActionsAllowed?"":"disabled")},react__WEBPACK_IMPORTED_MODULE_0__.createElement("input",{type:"file",ref:this.fileUploaderRef,id:"dialog-exports-passwords",onChange:this.handleFileSelected}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("label",{htmlFor:"dialog-exports-passwords"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_10__.x6,null,"Keepass key file (optional)")),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"input-file-inline"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("input",{type:"text",placeholder:this.translate("No key file selected"),disabled:!0,value:this.selectedFilename}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{type:"button",className:"button primary",disabled:!this.areActionsAllowed,onClick:this.handleSelectFile},react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_10__.x6,null,"Choose a file")))))),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"submit-wrapper clearfix"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Inputs_FormSubmitButton_FormCancelButton__WEBPACK_IMPORTED_MODULE_7__.A,{disabled:!this.areActionsAllowed,onClick:this.handleCancel}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Inputs_FormSubmitButton_FormSubmitButton__WEBPACK_IMPORTED_MODULE_6__.A,{disabled:!this.areActionsAllowed,processing:this.isProcessing,value:this.translate("Export")}))))}}ExportResourcesCredentials.propTypes={context:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,onClose:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func,actionFeedbackContext:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,dialogContext:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,resourceWorkspaceContext:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,format:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,t:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func};const __WEBPACK_DEFAULT_EXPORT__=(0,_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_2__.L)((0,_contexts_ResourceWorkspaceContext__WEBPACK_IMPORTED_MODULE_8__.Qw)((0,_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_3__.ot)((0,_contexts_DialogContext__WEBPACK_IMPORTED_MODULE_4__.z9)((0,react_i18next__WEBPACK_IMPORTED_MODULE_10__.CI)("common")(ExportResourcesCredentials)))));ExportResourcesCredentials.__docgenInfo={description:"This component is the second step of the export dialog when the file to import is KDB(X) file",methods:[{name:"defaultState",docblock:"Returns the default component state",modifiers:["get"],params:[],returns:null,description:"Returns the default component state"},{name:"bindHandlers",docblock:"Bind component handlers",modifiers:[],params:[],returns:null,description:"Bind component handlers"},{name:"createReferences",docblock:"Create elements references",modifiers:[],params:[],returns:null,description:"Create elements references"},{name:"selectedFilename",docblock:"Returns the selected file's name",modifiers:["get"],params:[],returns:null,description:"Returns the selected file's name"},{name:"isProcessing",docblock:"Return trus if the export is processing",modifiers:["get"],params:[],returns:null,description:"Return trus if the export is processing"},{name:"areActionsAllowed",docblock:"Returns true if actions can be performed",modifiers:["get"],params:[],returns:null,description:"Returns true if actions can be performed"},{name:"handleSelectFile",docblock:"Handle the selection of a file by file explorer",modifiers:[],params:[],returns:null,description:"Handle the selection of a file by file explorer"},{name:"handleFileSelected",docblock:"Handle the event that a file has been selected\n@param event A dom event",modifiers:["async"],params:[{name:"event",description:"A dom event",optional:!1}],returns:null,description:"Handle the event that a file has been selected"},{name:"handleInputChange",docblock:"Handle input change\n@param event",modifiers:[],params:[{name:"event",optional:!1}],returns:null,description:"Handle input change"},{name:"handleCancel",docblock:"Handle the cancellation of the import",modifiers:[],params:[],returns:null,description:"Handle the cancellation of the import"},{name:"handleSubmit",docblock:"Handle the export submit event\n@param event A dom event",modifiers:["async"],params:[{name:"event",description:"A dom event",optional:!1}],returns:null,description:"Handle the export submit event"},{name:"export",docblock:"Export the resource file",modifiers:["async"],params:[],returns:null,description:"Export the resource file"},{name:"readFile",docblock:"Read the selected file and returns its content in a base 64\n@return {Promise<string>}",modifiers:[],params:[],returns:{type:{name:"Promise",elements:[{name:"string"}]}},description:"Read the selected file and returns its content in a base 64"},{name:"onExportSuccess",docblock:"Whenever the export has been performed succesfully",modifiers:["async"],params:[],returns:null,description:"Whenever the export has been performed succesfully"},{name:"onExportFailure",docblock:"Whenever the export has been performed with failure",modifiers:[],params:[{name:"error",optional:!1}],returns:null,description:"Whenever the export has been performed with failure"},{name:"close",docblock:"Close the dialog",modifiers:[],params:[],returns:null,description:"Close the dialog"},{name:"translate",docblock:"Get the translate function\n@returns {function(...[*]=)}",modifiers:["get"],params:[],returns:{},description:"Get the translate function"}],displayName:"ExportResourcesCredentials",props:{context:{description:"",type:{name:"any"},required:!1},onClose:{description:"",type:{name:"func"},required:!1},actionFeedbackContext:{description:"",type:{name:"any"},required:!1},dialogContext:{description:"",type:{name:"any"},required:!1},resourceWorkspaceContext:{description:"",type:{name:"any"},required:!1},format:{description:"",type:{name:"string"},required:!1},t:{description:"",type:{name:"func"},required:!1}}}},"./src/react-extension/components/Resource/FilterResourcesByFolders/FilterResourcesByFolders.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>FilterResourcesByFolders_FilterResourcesByFolders});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),ContextualMenuContext=__webpack_require__("./src/react-extension/contexts/ContextualMenuContext.js"),DialogContext=__webpack_require__("./src/react-extension/contexts/DialogContext.js"),ContextualMenuWrapper=__webpack_require__("./src/react-extension/components/Common/ContextualMenu/ContextualMenuWrapper.js"),CreateResourceFolder=__webpack_require__("./src/react-extension/components/ResourceFolder/CreateResourceFolder/CreateResourceFolder.js"),AppContext=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),RenameResourceFolder=__webpack_require__("./src/react-extension/components/ResourceFolder/RenameResourceFolder/RenameResourceFolder.js"),DeleteResourceFolder=__webpack_require__("./src/react-extension/components/ResourceFolder/DeleteResourceFolder/DeleteResourceFolder.js"),ShareDialog=__webpack_require__("./src/react-extension/components/Share/ShareDialog.js"),ExportResources=__webpack_require__("./src/react-extension/components/Resource/ExportResources/ExportResources.js"),ResourceWorkspaceContext=__webpack_require__("./src/react-extension/contexts/ResourceWorkspaceContext.js"),es=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),RbacContext=__webpack_require__("./src/shared/context/Rbac/RbacContext.js"),uiActionEnumeration=__webpack_require__("./src/shared/services/rbacs/uiActionEnumeration.js"),folder_plus=__webpack_require__("./src/img/svg/folder_plus.svg"),download_file=__webpack_require__("./src/img/svg/download_file.svg"),svg_delete=__webpack_require__("./src/img/svg/delete.svg"),share=__webpack_require__("./src/img/svg/share.svg"),rename=__webpack_require__("./src/img/svg/rename.svg"),ActionAbortedMissingMetadataKeys=__webpack_require__("./src/react-extension/components/Metadata/ActionAbortedMissingMetadataKeys/ActionAbortedMissingMetadataKeys.js");class FilterResourcesByFoldersItemContextualMenu extends react.Component{constructor(props){super(props),this.bindCallbacks()}bindCallbacks(){this.handleCreateFolderItemClickEvent=this.handleCreateFolderItemClickEvent.bind(this),this.handleRenameFolderItemClickEvent=this.handleRenameFolderItemClickEvent.bind(this),this.handleShareFolderItemClickEvent=this.handleShareFolderItemClickEvent.bind(this),this.handleExportFolderItemClickEvent=this.handleExportFolderItemClickEvent.bind(this),this.handleDeleteFolderItemClickEvent=this.handleDeleteFolderItemClickEvent.bind(this),this.handleHide=this.handleHide.bind(this)}handleHide(){"function"==typeof this.props.onBeforeHide&&this.props.onBeforeHide(),this.props.hide()}handleCreateFolderItemClickEvent(){this.canUpdate()&&(this.props.dialogContext.open(CreateResourceFolder.A,{folderParentId:this.props.folder.id}),this.handleHide())}handleRenameFolderItemClickEvent(){this.canUpdate()&&(this.props.context.setContext({folder:this.props.folder}),this.props.dialogContext.open(RenameResourceFolder.A),this.handleHide())}handleShareFolderItemClickEvent(){if(this.canShare()){if(this.props.context.loggedInUser.missing_metadata_key_ids?.length>0)this.props.dialogContext.open(ActionAbortedMissingMetadataKeys.A);else{const foldersIds=[this.props.folder.id];this.props.context.setContext({shareDialogProps:{foldersIds}}),this.props.dialogContext.open(ShareDialog.A)}this.handleHide()}}async handleExportFolderItemClickEvent(){this.canExport()&&(await this.export(),this.handleHide())}handleDeleteFolderItemClickEvent(){this.canUpdate()&&(this.props.context.setContext({folder:this.props.folder}),this.props.dialogContext.open(DeleteResourceFolder.A),this.handleHide())}canUpdate(){return this.props.folder.permission.type>=7}canShare(){return 15===this.props.folder.permission.type}canExport(){return this.props.context.siteSettings.canIUse("export")&&this.props.rbacContext.canIUseAction(uiActionEnumeration.e.RESOURCES_EXPORT)}async export(){const foldersIds=[this.props.folder.id];await this.props.resourceWorkspaceContext.onResourcesToExport({foldersIds}),await this.props.dialogContext.open(ExportResources.A)}render(){const canUpdate=this.canUpdate(),canShare=this.canShare(),canExport=this.canExport(),canViewShare=this.props.rbacContext.canIUseAction(uiActionEnumeration.e.SHARE_FOLDER);return react.createElement(ContextualMenuWrapper.A,{hide:this.handleHide,left:this.props.left,top:this.props.top,className:this.props.className},react.createElement("li",{key:"option-create-folder",className:"ready closed"},react.createElement("div",{className:"row"},react.createElement("div",{className:"main-cell-wrapper"},react.createElement("div",{className:"main-cell"},react.createElement("button",{type:"button",onClick:this.handleCreateFolderItemClickEvent,disabled:!canUpdate,className:"create link no-border"},react.createElement(folder_plus.A,null),react.createElement("span",null,react.createElement(es.x6,null,"Create folder"))))))),react.createElement("li",{key:"option-rename-folder",className:"separator-after ready closed"},react.createElement("div",{className:"row"},react.createElement("div",{className:"main-cell-wrapper"},react.createElement("div",{className:"main-cell"},react.createElement("button",{type:"button",onClick:this.handleRenameFolderItemClickEvent,disabled:!canUpdate,className:"rename link no-border"},react.createElement(rename.A,null),react.createElement("span",null,react.createElement(es.x6,null,"Rename"))))))),canViewShare&&react.createElement("li",{key:"option-share-folder",className:"ready closed"},react.createElement("div",{className:"row"},react.createElement("div",{className:"main-cell-wrapper"},react.createElement("div",{className:"main-cell"},react.createElement("button",{type:"button",onClick:this.handleShareFolderItemClickEvent,disabled:!canShare,className:"share link no-border"},react.createElement(share.A,null),react.createElement("span",null,react.createElement(es.x6,null,"Share"))))))),canExport&&react.createElement("li",{key:"option-export-folder",className:"ready closed"},react.createElement("div",{className:"row"},react.createElement("div",{className:"main-cell-wrapper"},react.createElement("div",{className:"main-cell"},react.createElement("button",{type:"button",className:"export link no-border",onClick:this.handleExportFolderItemClickEvent},react.createElement(download_file.A,null),react.createElement("span",null,react.createElement(es.x6,null,"Export"))))))),react.createElement("li",{key:"option-delete-folder",className:"ready closed"},react.createElement("div",{className:"row"},react.createElement("div",{className:"main-cell-wrapper"},react.createElement("div",{className:"main-cell"},react.createElement("button",{type:"button",onClick:this.handleDeleteFolderItemClickEvent,disabled:!canUpdate,className:"delete link no-border"},react.createElement(svg_delete.A,null),react.createElement("span",null,react.createElement(es.x6,null,"Delete"))))))))}}FilterResourcesByFoldersItemContextualMenu.propTypes={context:prop_types_default().any,rbacContext:prop_types_default().any,folder:prop_types_default().object,hide:prop_types_default().func,onBeforeHide:prop_types_default().func,left:prop_types_default().number,top:prop_types_default().number,className:prop_types_default().string,dialogContext:prop_types_default().any,resourceWorkspaceContext:prop_types_default().any};const FilterResourcesByFolders_FilterResourcesByFoldersItemContextualMenu=(0,AppContext.L)((0,RbacContext.x6)((0,ResourceWorkspaceContext.Qw)((0,DialogContext.z9)((0,es.CI)("common")(FilterResourcesByFoldersItemContextualMenu)))));FilterResourcesByFoldersItemContextualMenu.__docgenInfo={description:"",methods:[{name:"bindCallbacks",docblock:"Bind callbacks methods",modifiers:[],params:[],returns:null,description:"Bind callbacks methods"},{name:"handleHide",docblock:"Handle hide contextual menu",modifiers:[],params:[],returns:null,description:"Handle hide contextual menu"},{name:"handleCreateFolderItemClickEvent",docblock:"Handle click on the create a folder menu option.",modifiers:[],params:[],returns:null,description:"Handle click on the create a folder menu option."},{name:"handleRenameFolderItemClickEvent",docblock:"Handle click on the rename a folder menu option.",modifiers:[],params:[],returns:null,description:"Handle click on the rename a folder menu option."},{name:"handleShareFolderItemClickEvent",docblock:"Handle click on the share a folder menu option.",modifiers:[],params:[],returns:null,description:"Handle click on the share a folder menu option."},{name:"handleExportFolderItemClickEvent",docblock:"Handle click on the export a folder menu option.",modifiers:["async"],params:[],returns:null,description:"Handle click on the export a folder menu option."},{name:"handleDeleteFolderItemClickEvent",docblock:"Handle click on the delete a folder menu option.",modifiers:[],params:[],returns:null,description:"Handle click on the delete a folder menu option."},{name:"canUpdate",docblock:"Check if the user can update the folder.\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Check if the user can update the folder."},{name:"canShare",docblock:"Check if the user can share the folder.\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Check if the user can share the folder."},{name:"canExport",docblock:"Check if the user can export\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Check if the user can export"},{name:"export",docblock:"Exports the selected resources",modifiers:["async"],params:[],returns:null,description:"Exports the selected resources"}],displayName:"FilterResourcesByFoldersItemContextualMenu",props:{context:{description:"",type:{name:"any"},required:!1},rbacContext:{description:"",type:{name:"any"},required:!1},folder:{description:"",type:{name:"object"},required:!1},hide:{description:"",type:{name:"func"},required:!1},onBeforeHide:{description:"",type:{name:"func"},required:!1},left:{description:"",type:{name:"number"},required:!1},top:{description:"",type:{name:"number"},required:!1},className:{description:"",type:{name:"string"},required:!1},dialogContext:{description:"",type:{name:"any"},required:!1},resourceWorkspaceContext:{description:"",type:{name:"any"},required:!1}}};var DragContext=__webpack_require__("./src/react-extension/contexts/DragContext.js"),circle_x=__webpack_require__("./src/img/svg/circle_x.svg");class DisplayDragFolderItem extends react.Component{get draggedItems(){return this.props.dragContext.draggedItems}canDragItems(draggedItems){let canDragItems=draggedItems.folders.reduce((accumulator,folder)=>accumulator&&this.canDragItem(folder),!0);const draggedResources=draggedItems.resources;return canDragItems=canDragItems&&draggedResources.reduce((accumulator,folder)=>accumulator&&this.canDragItem(folder),!0),canDragItems}canDragItem(item){if(null===item.folder_parent_id)return!0;const folderParent=this.props.context.folders.find(folder=>folder.id===item.folder_parent_id);return!!folderParent.personal||!(folderParent.permission.type<7)&&!(item.permission.type<7)}render(){const canDrag=this.canDragItems(this.draggedItems),dragFeedbackText=canDrag?this.draggedItems.folders[0].name:"You are not allowed to move this content";return react.createElement("div",{className:"drag-and-drop item-1"},!canDrag&&react.createElement(circle_x.A,null),react.createElement("span",{className:"message "+(canDrag?"":"not-allowed")},dragFeedbackText),react.createElement("span",{className:"count"},"1"))}}DisplayDragFolderItem.contextType=AppContext.A,DisplayDragFolderItem.propTypes={context:prop_types_default().any,resourceWorkspaceContext:prop_types_default().any,dragContext:prop_types_default().any};const FilterResourcesByFolders_DisplayDragFolderItem=(0,AppContext.L)((0,ResourceWorkspaceContext.Qw)((0,DragContext.zk)(DisplayDragFolderItem)));DisplayDragFolderItem.__docgenInfo={description:"",methods:[{name:"draggedItems",docblock:"return dragged items\n@returns {*}",modifiers:["get"],params:[],returns:{type:{name:"mixed"}},description:"return dragged items"},{name:"canDragItems",docblock:"Check if the user can drag all the items they are currently dragging.\n@param {array} draggedItems The list of dragged items.\n@returns {boolean}",modifiers:[],params:[{name:"draggedItems",description:"The list of dragged items.",type:{name:"array"},optional:!1}],returns:{type:{name:"boolean"}},description:"Check if the user can drag all the items they are currently dragging."},{name:"canDragItem",docblock:"Check if the user can drag an item.\n@param {object} item The target item",modifiers:[],params:[{name:"item",description:"The target item",type:{name:"object"},optional:!1}],returns:null,description:"Check if the user can drag an item."}],displayName:"DisplayDragFolderItem",props:{context:{description:"",type:{name:"any"},required:!1},resourceWorkspaceContext:{description:"",type:{name:"any"},required:!1},dragContext:{description:"",type:{name:"any"},required:!1}}};var react_router=__webpack_require__("./node_modules/react-router/esm/react-router.js"),caret_down=__webpack_require__("./src/img/svg/caret_down.svg"),caret_right=__webpack_require__("./src/img/svg/caret_right.svg"),share_folder=__webpack_require__("./src/img/svg/share_folder.svg"),folder=__webpack_require__("./src/img/svg/folder.svg"),more_horizontal=__webpack_require__("./src/img/svg/more_horizontal.svg"),NotifyError=__webpack_require__("./src/react-extension/components/Common/Error/NotifyError/NotifyError.js"),ResourceTypesLocalStorageContext=__webpack_require__("./src/shared/context/ResourceTypesLocalStorageContext/ResourceTypesLocalStorageContext.js"),resourceTypesCollection=__webpack_require__("./src/shared/models/entity/resourceType/resourceTypesCollection.js");class FilterResourcesByFoldersItem extends react.Component{constructor(props){super(props),this.state=this.getDefaultState(),this.bindCallbacks()}getDefaultState(){return{draggingOver:!1,draggingOverSince:null,open:this.props.isOpen,moreMenuOpen:!1}}bindCallbacks(){this.handleCloseMoreMenu=this.handleCloseMoreMenu.bind(this),this.handleToggleOpenFolder=this.handleToggleOpenFolder.bind(this),this.handleContextualMenuEvent=this.handleContextualMenuEvent.bind(this),this.handleDragEndEvent=this.handleDragEndEvent.bind(this),this.handleDragLeaveEvent=this.handleDragLeaveEvent.bind(this),this.handleDragOverEvent=this.handleDragOverEvent.bind(this),this.handleDragStartEvent=this.handleDragStartEvent.bind(this),this.handleDropEvent=this.handleDropEvent.bind(this),this.handleMoreClickEvent=this.handleMoreClickEvent.bind(this),this.handleSelectEvent=this.handleSelectEvent.bind(this)}componentDidMount(){this.props.match.params.filterByFolderId&&this.openFolderParentTree(this.props.match.params.filterByFolderId)}componentDidUpdate(prevProps){this.props.match.params.filterByFolderId!==prevProps.match.params.filterByFolderId&&this.props.match.params.filterByFolderId&&this.openFolderParentTree(this.props.match.params.filterByFolderId)}handleCloseMoreMenu(){this.setState({moreMenuOpen:!1})}handleDragStartEvent(event){event.persist();const draggedItems={folders:[this.props.folder],resources:[]};this.props.dragContext.onDragStart(event,FilterResourcesByFolders_DisplayDragFolderItem,draggedItems)}handleToggleOpenFolder(event){event.stopPropagation();const open=!this.state.open;this.setState({open}),open?this.props.toggleOpenFolder(this.props.folder.id):this.props.toggleCloseFolder(this.props.folder.id)}openFolderParentTree(selectedFolderId){const selectedFolder=this.props.context.folders.find(folder=>folder.id===selectedFolderId);selectedFolder?.folder_parent_id&&(selectedFolder.folder_parent_id===this.props.folder.id?(this.setState({open:!0}),this.props.toggleOpenFolder(this.props.folder.id)):this.openFolderParentTree(selectedFolder.folder_parent_id))}isOpen(){return this.state.open}handleContextualMenuEvent(event){event.preventDefault();const top=event.pageY,left=event.pageX,contextualMenuProps={folder:this.props.folder,left,top};this.props.contextualMenuContext.show(FilterResourcesByFolders_FilterResourcesByFoldersItemContextualMenu,contextualMenuProps)}handleMoreClickEvent(event){const moreMenuOpen=!this.state.moreMenuOpen;if(this.setState({moreMenuOpen}),moreMenuOpen){const{left,top}=event.currentTarget.getBoundingClientRect(),contextualMenuProps={folder:this.props.folder,left,top:top+19,className:"right",onBeforeHide:this.handleCloseMoreMenu};this.props.contextualMenuContext.show(FilterResourcesByFolders_FilterResourcesByFoldersItemContextualMenu,contextualMenuProps)}}handleDragEndEvent(){this.props.dragContext.onDragEnd()}handleDragLeaveEvent(){this.setState({draggingOver:!1,draggingOverSince:null})}handleDragOverEvent(event){if(event.preventDefault(),this.state.draggingOver)return void this.openOnLongDragOver(event);const draggingOverSince=Date.now();this.setState({draggingOver:!0,draggingOverSince})}openOnLongDragOver(event){if(!this.isOpen()){Date.now()-this.state.draggingOverSince>2e3&&this.handleToggleOpenFolder(event)}}async handleDropEvent(){const folderParentId=this.props.folder.id;if(!this.draggedItems.folders.some(item=>item.id===folderParentId)){const folders=this.draggedItems.folders,resources=this.draggedItems.resources;try{folders?.length>0?await this.moveFolder(folders):resources?.length>0&&await this.moveResource(resources)}catch(error){this.handleError(error)}}this.setState({draggingOver:!1})}async moveFolder(folders){const hasSomeSharedFolder=folders.some(folder=>!folder.personal),isPersonalFolder=this.props.folder.personal;(!isPersonalFolder||hasSomeSharedFolder&&isPersonalFolder)&&this.userHasMissingKeys?this.props.dialogContext.open(ActionAbortedMissingMetadataKeys.A):await this.props.context.port.request("passbolt.folders.move-by-id",folders[0].id,this.props.folder.id)}async moveResource(resources){if(resources.some(resource=>resource.personal&&this.props.resourceTypes.getFirstById(resource.resource_type_id)?.isV5())&&!this.props.folder.personal&&this.userHasMissingKeys)this.props.dialogContext.open(ActionAbortedMissingMetadataKeys.A);else{const resourceIds=resources.map(resource=>resource.id);await this.props.context.port.request("passbolt.resources.move-by-ids",resourceIds,this.props.folder.id)}}get userHasMissingKeys(){return this.props.context.loggedInUser.missing_metadata_key_ids?.length>0}handleError(error){const errorDialogProps={error};this.props.dialogContext.open(NotifyError.A,errorDialogProps)}handleSelectEvent(){this.props.history.push(`/app/folders/view/${this.props.folder.id}`)}isSelected(){const filter=this.props.resourceWorkspaceContext.filter;return!(filter.type!==ResourceWorkspaceContext.FM.FOLDER||!filter.payload.folder)&&filter.payload.folder.id===this.props.folder.id}isChildOfAny(folder,folders){for(const i in folders)if(folder.folder_parent_id===folders[i].id)return!0;if(null!==folder.folder_parent_id){const folderParent=this.props.context.folders.find(item=>item.id===folder.folder_parent_id);return this.isChildOfAny(folderParent,folders)}return!1}canDragItem(item){if(null===item.folder_parent_id)return!0;const folderParent=this.props.context.folders.find(folder=>folder.id===item.folder_parent_id);return!!folderParent.personal||!(folderParent.permission.type<7)&&!(item.permission.type<7)}canDragItems(draggedItems){const draggedFolders=draggedItems.folders;let canDragItems=draggedFolders?.reduce((accumulator,folder)=>accumulator&&this.canDragItem(folder),!0);const draggedResources=draggedItems.resources;return canDragItems&=draggedResources?.reduce((accumulator,folder)=>accumulator&&this.canDragItem(folder),!0),canDragItems}getItemsListLowestPermission(items){return items?.reduce((accumulator,draggedItem)=>(draggedItem.permission.type<accumulator&&(accumulator=draggedItem.permission.type),accumulator),15)}getDraggedItemsLowestPermission(){const draggedFoldersLowestPermission=this.getItemsListLowestPermission(this.draggedItems.folders),draggedResourcesLowestPermission=this.getItemsListLowestPermission(this.draggedItems.resources);return draggedFoldersLowestPermission<draggedResourcesLowestPermission?draggedFoldersLowestPermission:draggedResourcesLowestPermission}canDropInto(){if(!this.isDragging())return!1;if(this.props.folder.permission.type<7)return!1;if(!this.props.folder.personal){if(this.getDraggedItemsLowestPermission()<7)return!1}if(this.isChildOfAny(this.props.folder,this.draggedItems.folders))return!1;for(const i in this.draggedItems.folders)if(this.props.folder.id===this.draggedItems.folders[i].id)return!1;return!0}isDragged(){return!!this.isDragging()&&this.draggedItems.folders?.some(folder=>folder.id===this.props.folder.id)}isDisabled(){if(this.isDragging()){if(!this.canDragItems(this.draggedItems))return!0;if(!this.canDropInto())return!0}return!1}get hasChildrenFolders(){return this.props.context.folders.filter(folder=>folder.folder_parent_id===this.props.folder.id).length>0}get draggedItems(){return this.props.dragContext.draggedItems}isDragging(){return this.props.dragContext.dragging}render(){const hasChildren=this.hasChildrenFolders,isSelected=this.isSelected(),isDisabled=this.isDisabled(),isDragged=this.isDragged(),isOpen=this.isOpen(),canDropInto=this.canDropInto(),showDropFocus=this.state.draggingOver&&canDropInto,depth=this.props.context.getHierarchyFolderCache(this.props.folder.folder_parent_id).length;return react.createElement("li",{className:"folder-item"},react.createElement("div",{className:`row ${isSelected?"selected":""} ${isDisabled?"disabled":""} ${isDragged?"is-dragged":""} ${showDropFocus?"drop-focus":""} ${hasChildren?"":"no-child"} ${this.state.moreMenuOpen?"highlight":""}`,draggable:"true",onDrop:this.handleDropEvent,onDragOver:this.handleDragOverEvent,onDragEnd:this.handleDragEndEvent,onDragLeave:this.handleDragLeaveEvent,onDragStart:this.handleDragStartEvent,style:{"--folder-depth":depth}},react.createElement("div",{className:"main-cell-wrapper"},react.createElement("div",{className:"main-cell",onClick:this.handleSelectEvent,onContextMenu:this.handleContextualMenuEvent},react.createElement("button",{className:"link no-border",type:"button"},hasChildren&&react.createElement("div",{className:"toggle-folder",onClick:this.handleToggleOpenFolder,role:"button"},isOpen?react.createElement(caret_down.A,null):react.createElement(caret_right.A,null)),this.props.folder.personal?react.createElement(folder.A,null):react.createElement(share_folder.A,null),react.createElement("span",{title:this.props.folder.name,className:"folder-name"},this.props.folder.name)))),!isDragged&&react.createElement("div",{className:"dropdown right-cell more-ctrl"},react.createElement("button",{type:"button",className:"button-transparent inline-menu-horizontal "+(this.state.moreMenuOpen?"open":""),onClick:this.handleMoreClickEvent},react.createElement(more_horizontal.A,null)))))}}FilterResourcesByFoldersItem.defaultProps={isOpen:!1},FilterResourcesByFoldersItem.propTypes={context:prop_types_default().any,contextualMenuContext:prop_types_default().any,history:prop_types_default().object,match:prop_types_default().object,folder:prop_types_default().object,isOpen:prop_types_default().bool.isRequired,resourceWorkspaceContext:prop_types_default().any,resourceTypes:prop_types_default().instanceOf(resourceTypesCollection.A),dragContext:prop_types_default().any,dialogContext:prop_types_default().object,toggleOpenFolder:prop_types_default().func,toggleCloseFolder:prop_types_default().func};const FilterResourcesByFolders_FilterResourcesByFoldersItem=(0,react_router.withRouter)((0,AppContext.L)((0,ResourceTypesLocalStorageContext.KH)((0,ContextualMenuContext.t6)((0,DialogContext.z9)((0,ResourceWorkspaceContext.Qw)((0,DragContext.zk)(FilterResourcesByFoldersItem)))))));FilterResourcesByFoldersItem.__docgenInfo={description:"",methods:[{name:"getDefaultState",docblock:"Return default state\n@returns {Object} default state",modifiers:[],params:[],returns:{description:"default state",type:{name:"Object"}},description:"Return default state"},{name:"bindCallbacks",docblock:null,modifiers:[],params:[],returns:null},{name:"handleCloseMoreMenu",docblock:"Close the create menu",modifiers:[],params:[],returns:null,description:"Close the create menu"},{name:"handleDragStartEvent",docblock:"Handle when the user start dragging the folder.\n@param {ReactEvent} event The event",modifiers:[],params:[{name:"event",description:"The event",type:{name:"ReactEvent"},optional:!1}],returns:null,description:"Handle when the user start dragging the folder."},{name:"handleToggleOpenFolder",docblock:"Handle when the user click on the folder left caret.\nFold/Unfold the folder.\n@param {ReactEvent} event The event",modifiers:[],params:[{name:"event",description:"The event",type:{name:"ReactEvent"},optional:!1}],returns:null,description:"Handle when the user click on the folder left caret.\nFold/Unfold the folder."},{name:"openFolderParentTree",docblock:"Open the tree until a given folder\n@param {object} selectedFolderId The folder id to scroll to",modifiers:[],params:[{name:"selectedFolderId",description:"The folder id to scroll to",type:{name:"object"},optional:!1}],returns:null,description:"Open the tree until a given folder"},{name:"isOpen",docblock:"Check if the current folder is open.\n@return {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Check if the current folder is open."},{name:"handleContextualMenuEvent",docblock:"Handle when the user right clicks on a folder name.\n@param {ReactEvent} event The event",modifiers:[],params:[{name:"event",description:"The event",type:{name:"ReactEvent"},optional:!1}],returns:null,description:"Handle when the user right clicks on a folder name."},{name:"handleMoreClickEvent",docblock:"Handle when the user clicks on the more button.\n@param {ReactEvent} event The event",modifiers:[],params:[{name:"event",description:"The event",type:{name:"ReactEvent"},optional:!1}],returns:null,description:"Handle when the user clicks on the more button."},{name:"handleDragEndEvent",docblock:"Handle when the user stop dragging content.\n@param {ReactEvent} event The event",modifiers:[],params:[],returns:null,description:"Handle when the user stop dragging content."},{name:"handleDragLeaveEvent",docblock:"Handle when the user is not dragging over this component anymore.",modifiers:[],params:[],returns:null,description:"Handle when the user is not dragging over this component anymore."},{name:"handleDragOverEvent",docblock:"Handle when the user is dragging over this component.\n@param {ReactEvent} event The event",modifiers:[],params:[{name:"event",description:"The event",type:{name:"ReactEvent"},optional:!1}],returns:null,description:"Handle when the user is dragging over this component."},{name:"openOnLongDragOver",docblock:"Open the folder when the user is dragging for a defined period on a folder.\n@param {ReactEvent} event The event",modifiers:[],params:[{name:"event",description:"The event",type:{name:"ReactEvent"},optional:!1}],returns:null,description:"Open the folder when the user is dragging for a defined period on a folder."},{name:"handleDropEvent",docblock:"Handle when the user drop content on this component.\n@param {ReactEvent} event The event",modifiers:["async"],params:[],returns:null,description:"Handle when the user drop content on this component."},{name:"moveFolder",docblock:"Move the folders or display action aborted if is not possible to move\n@param {Array<Object>} folders\n@return {Promise<void>}",modifiers:["async"],params:[{name:"folders",type:{name:"Array",elements:[{name:"Object"}]},optional:!1}],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Move the folders or display action aborted if is not possible to move"},{name:"moveResource",docblock:"Move the resources or display action aborted if is not possible to move\n@param {Array<Object>} resources\n@return {Promise<void>}",modifiers:["async"],params:[{name:"resources",type:{name:"Array",elements:[{name:"Object"}]},optional:!1}],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Move the resources or display action aborted if is not possible to move"},{name:"userHasMissingKeys",docblock:"User has missing keys\n@return {boolean}",modifiers:["get"],params:[],returns:{type:{name:"boolean"}},description:"User has missing keys"},{name:"handleError",docblock:"handle error and display error dialog\n@param error",modifiers:[],params:[{name:"error",optional:!1}],returns:null,description:"handle error and display error dialog"},{name:"handleSelectEvent",docblock:"Handle the user selects a folder from the list.",modifiers:[],params:[],returns:null,description:"Handle the user selects a folder from the list."},{name:"isSelected",docblock:"Check if the folder associated to this component is selected.\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Check if the folder associated to this component is selected."},{name:"isChildOfAny",docblock:"Check if a folder is a child of any of the given folders.\n@param {object} folder The target folder to check if it is a child\n@param {array} folders The folders to check for",modifiers:[],params:[{name:"folder",description:"The target folder to check if it is a child",type:{name:"object"},optional:!1},{name:"folders",description:"The folders to check for",type:{name:"array"},optional:!1}],returns:null,description:"Check if a folder is a child of any of the given folders."},{name:"canDragItem",docblock:"Check if the user can drag an item.\n@param {object} item The target item",modifiers:[],params:[{name:"item",description:"The target item",type:{name:"object"},optional:!1}],returns:null,description:"Check if the user can drag an item."},{name:"canDragItems",docblock:"Check if the user can drag all the items they are currently dragging.\n@param {array} draggedItems The list of dragged items.\n@returns {boolean}",modifiers:[],params:[{name:"draggedItems",description:"The list of dragged items.",type:{name:"array"},optional:!1}],returns:{type:{name:"boolean"}},description:"Check if the user can drag all the items they are currently dragging."},{name:"getItemsListLowestPermission",docblock:"Get the lowest permissions among a list of items\n@param {array} items The list of items to look into\n@returns {int}",modifiers:[],params:[{name:"items",description:"The list of items to look into",type:{name:"array"},optional:!1}],returns:{type:{name:"int"}},description:"Get the lowest permissions among a list of items"},{name:"getDraggedItemsLowestPermission",docblock:"Get the lowest permissions among all the dragged items.\n@returns {int}",modifiers:[],params:[],returns:{type:{name:"int"}},description:"Get the lowest permissions among all the dragged items."},{name:"canDropInto",docblock:"Check if the user can drop the content they are dragging into the folder associated to this component.\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Check if the user can drop the content they are dragging into the folder associated to this component."},{name:"isDragged",docblock:"Check if the component is dragged.\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Check if the component is dragged."},{name:"isDisabled",docblock:"Check if the component is disabled.\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Check if the component is disabled."},{name:"hasChildrenFolders",docblock:"Has the children folder.\n@returns {boolean}",modifiers:["get"],params:[],returns:{type:{name:"boolean"}},description:"Has the children folder."},{name:"draggedItems",docblock:"return dragged items\n@returns {*}",modifiers:["get"],params:[],returns:{type:{name:"mixed"}},description:"return dragged items"},{name:"isDragging",docblock:"Check if the user is currently dragging content.\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Check if the user is currently dragging content."}],displayName:"FilterResourcesByFoldersItem",props:{isOpen:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},context:{description:"",type:{name:"any"},required:!1},contextualMenuContext:{description:"",type:{name:"any"},required:!1},history:{description:"",type:{name:"object"},required:!1},match:{description:"",type:{name:"object"},required:!1},folder:{description:"",type:{name:"object"},required:!1},resourceWorkspaceContext:{description:"",type:{name:"any"},required:!1},resourceTypes:{description:"",type:{name:"instanceOf",value:"ResourceTypesCollection"},required:!1},dragContext:{description:"",type:{name:"any"},required:!1},dialogContext:{description:"",type:{name:"object"},required:!1},toggleOpenFolder:{description:"",type:{name:"func"},required:!1},toggleCloseFolder:{description:"",type:{name:"func"},required:!1}}};class FilterResourcesByRootFolderContextualMenu extends react.Component{constructor(props){super(props),this.bindCallbacks()}bindCallbacks(){this.handleCreateFolderItemClickEvent=this.handleCreateFolderItemClickEvent.bind(this),this.handleExportFolderItemClickEvent=this.handleExportFolderItemClickEvent.bind(this),this.handleHide=this.handleHide.bind(this)}handleHide(){"function"==typeof this.props.onBeforeHide&&this.props.onBeforeHide(),this.props.hide()}handleCreateFolderItemClickEvent(){this.props.dialogContext.open(CreateResourceFolder.A,{folderParentId:null}),this.handleHide()}async handleExportFolderItemClickEvent(){await this.export(),this.handleHide()}canExport(){return this.props.context.siteSettings.canIUse("export")&&this.props.rbacContext.canIUseAction(uiActionEnumeration.e.RESOURCES_EXPORT)}async export(){const foldersIds=this.props.context.folders.filter(folder=>null===folder.folder_parent_id).map(folder=>folder.id),resourcesIds=this.props.context.resources.filter(resource=>null===resource.folder_parent_id).map(resource=>resource.id);await this.props.resourceWorkspaceContext.onResourcesToExport({foldersIds,resourcesIds}),await this.props.dialogContext.open(ExportResources.A)}render(){return react.createElement(ContextualMenuWrapper.A,{hide:this.handleHide,left:this.props.left,top:this.props.top,className:this.props.className},react.createElement("li",{key:"option-create-folder",className:"ready closed"},react.createElement("div",{className:"row"},react.createElement("div",{className:"main-cell-wrapper"},react.createElement("div",{className:"main-cell"},react.createElement("button",{className:"link no-border",type:"button",onClick:this.handleCreateFolderItemClickEvent},react.createElement(folder_plus.A,null),react.createElement("span",null,react.createElement(es.x6,null,"Create folder"))))))),this.canExport()&&react.createElement("li",{key:"option-export-folder",className:"ready closed"},react.createElement("div",{className:"row"},react.createElement("div",{className:"main-cell-wrapper"},react.createElement("div",{className:"main-cell"},react.createElement("button",{type:"button",className:"link no-border",onClick:this.handleExportFolderItemClickEvent},react.createElement(download_file.A,null),react.createElement("span",null,react.createElement(es.x6,null,"Export all"))))))))}}FilterResourcesByRootFolderContextualMenu.propTypes={context:prop_types_default().any,rbacContext:prop_types_default().any,hide:prop_types_default().func,onBeforeHide:prop_types_default().func,left:prop_types_default().number,top:prop_types_default().number,className:prop_types_default().string,dialogContext:prop_types_default().any,resourceWorkspaceContext:prop_types_default().any};const FilterResourcesByFolders_FilterResourcesByRootFolderContextualMenu=(0,AppContext.L)((0,RbacContext.x6)((0,ResourceWorkspaceContext.Qw)((0,DialogContext.z9)((0,es.CI)("common")(FilterResourcesByRootFolderContextualMenu)))));FilterResourcesByRootFolderContextualMenu.__docgenInfo={description:"",methods:[{name:"bindCallbacks",docblock:"Bind callbacks methods",modifiers:[],params:[],returns:null,description:"Bind callbacks methods"},{name:"handleHide",docblock:"Handle hide contextual menu",modifiers:[],params:[],returns:null,description:"Handle hide contextual menu"},{name:"handleCreateFolderItemClickEvent",docblock:"Handle click on the create a folder menu option.",modifiers:[],params:[],returns:null,description:"Handle click on the create a folder menu option."},{name:"handleExportFolderItemClickEvent",docblock:"Handle click on the export a folder menu option.",modifiers:["async"],params:[],returns:null,description:"Handle click on the export a folder menu option."},{name:"canExport",docblock:"Check if the user can export.\n@return {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Check if the user can export."},{name:"export",docblock:"Exports the selected resources",modifiers:["async"],params:[],returns:null,description:"Exports the selected resources"}],displayName:"FilterResourcesByRootFolderContextualMenu",props:{context:{description:"",type:{name:"any"},required:!1},rbacContext:{description:"",type:{name:"any"},required:!1},hide:{description:"",type:{name:"func"},required:!1},onBeforeHide:{description:"",type:{name:"func"},required:!1},left:{description:"",type:{name:"number"},required:!1},top:{description:"",type:{name:"number"},required:!1},className:{description:"",type:{name:"string"},required:!1},dialogContext:{description:"",type:{name:"any"},required:!1},resourceWorkspaceContext:{description:"",type:{name:"any"},required:!1}}};var react_list=__webpack_require__("./node_modules/react-list/react-list.js"),react_list_default=__webpack_require__.n(react_list),cabinet=__webpack_require__("./src/img/svg/cabinet.svg"),spinner=__webpack_require__("./src/img/svg/spinner.svg"),memoize_one_esm=__webpack_require__("./node_modules/memoize-one/dist/memoize-one.esm.js");class FilterResourcesByFolders extends react.Component{constructor(props){super(props),this.state=this.getDefaultState(),this.bindCallbacks(),this.createRefs()}getDefaultState(){return{draggingOverTitle:!1,draggingOverTitleSince:null,open:!0,moreMenuOpen:!1,folderIdsOpened:[]}}bindCallbacks(){this.handleCloseMoreMenu=this.handleCloseMoreMenu.bind(this),this.handleClickOnTitle=this.handleClickOnTitle.bind(this),this.handleTitleContextualMenuEvent=this.handleTitleContextualMenuEvent.bind(this),this.handleDragLeaveTitle=this.handleDragLeaveTitle.bind(this),this.handleDragOverTitle=this.handleDragOverTitle.bind(this),this.handleDropTitle=this.handleDropTitle.bind(this),this.handleTitleMoreClickEvent=this.handleTitleMoreClickEvent.bind(this),this.handleToggleOpenFolder=this.handleToggleOpenFolder.bind(this),this.handleToggleCloseFolder=this.handleToggleCloseFolder.bind(this),this.handleFolderToDisplay=this.handleFolderToDisplay.bind(this)}createRefs(){this.folderTreeRef=react.createRef()}componentDidMount(){this.props.match.params.filterByFolderId&&this.addParentFolderIdsToBeOpen(this.props.match.params.filterByFolderId)}componentDidUpdate(prevProps){const folderId=this.props.match.params.filterByFolderId;folderId!==prevProps.match.params.filterByFolderId&&folderId&&this.addParentFolderIdsToBeOpen(folderId)}handleFolderScroll(folders){const folderToScroll=this.props.resourceWorkspaceContext.scrollTo.folder,hasNotEmptyRange=this.folderTreeRef.current?.getVisibleRange().some(value=>value);folderToScroll&&hasNotEmptyRange&&(this.scrollTo(folders,this.props.match.params.filterByFolderId),this.props.resourceWorkspaceContext.onFolderScrolled())}scrollTo(folders,folderId){const folderIndex=folders.findIndex(folder=>folder.id===folderId),[visibleStartIndex,visibleEndIndex]=this.folderTreeRef.current.getVisibleRange();(folderIndex<visibleStartIndex||folderIndex>visibleEndIndex)&&this.folderTreeRef.current.scrollTo(folderIndex)}getFoldersToDisplay=(0,memoize_one_esm.A)((folders,folderIdsOpened)=>this.handleFolderToDisplay(folders,folderIdsOpened));handleFolderToDisplay(folders,folderIdsOpened){const foldersByParentIdOrderedByDepth=this.filterFoldersByRootAndFoldersOpened(folders,folderIdsOpened);return this.sortAndFlatFoldersByDepth(foldersByParentIdOrderedByDepth)}filterFoldersByRootAndFoldersOpened(folders,folderIdsOpened){const foldersByParentIdOrderedByDepth=[{}];return folders?.forEach(folder=>{if(null===folder.folder_parent_id)(foldersByParentIdOrderedByDepth[0][folder.folder_parent_id]=foldersByParentIdOrderedByDepth[0][folder.folder_parent_id]||[]).push(folder);else if(folderIdsOpened.includes(folder.folder_parent_id)){const depth=this.props.context.getHierarchyFolderCache(folder.id).length;foldersByParentIdOrderedByDepth[depth]=foldersByParentIdOrderedByDepth[depth]||{},(foldersByParentIdOrderedByDepth[depth][folder.folder_parent_id]=foldersByParentIdOrderedByDepth[depth][folder.folder_parent_id]||[]).push(folder)}}),foldersByParentIdOrderedByDepth}sortAndFlatFoldersByDepth(foldersByParentIdOrderedByDepth){const foldersToDisplay=[];return foldersByParentIdOrderedByDepth?.forEach(foldersByParent=>{for(const[key,value]of Object.entries(foldersByParent)){const folderParentIndex=foldersToDisplay.findIndex(folder=>folder.id===key);this.sortFoldersAlphabetically(value),foldersToDisplay.splice(folderParentIndex+1,0,...value)}}),foldersToDisplay}addParentFolderIdsToBeOpen(folderId){const folderIdsOpened=[...this.state.folderIdsOpened],selectedFolder=this.props.context.folders?.find(folder=>folder.id===folderId);let folderParentId=selectedFolder?.folder_parent_id;for(;folderParentId;){const parentFolder=this.props.context.folders.find(folder=>folder.id===folderParentId);folderIdsOpened.includes(parentFolder.id)||folderIdsOpened.push(parentFolder.id),folderParentId=parentFolder.folder_parent_id}this.setState({folderIdsOpened})}handleCloseMoreMenu(){this.setState({moreMenuOpen:!1})}handleClickOnTitle(){const filter={type:ResourceWorkspaceContext.FM.ROOT_FOLDER};this.props.history.push("/app/passwords",{filter})}get isSelected(){return this.props.resourceWorkspaceContext.filter.type===ResourceWorkspaceContext.FM.ROOT_FOLDER}handleTitleContextualMenuEvent(event){event.preventDefault();const top=event.pageY,contextualMenuProps={left:event.pageX,top};this.props.contextualMenuContext.show(FilterResourcesByFolders_FilterResourcesByRootFolderContextualMenu,contextualMenuProps)}handleTitleMoreClickEvent(event){const moreMenuOpen=!this.state.moreMenuOpen;if(this.setState({moreMenuOpen}),moreMenuOpen){const{left,top}=event.currentTarget.getBoundingClientRect(),contextualMenuProps={left,top:top+19,className:"right",onBeforeHide:this.handleCloseMoreMenu};this.props.contextualMenuContext.show(FilterResourcesByFolders_FilterResourcesByRootFolderContextualMenu,contextualMenuProps)}}handleToggleOpenFolder(folderId){if(!this.state.folderIdsOpened.includes(folderId)){const folderIdsOpened=[...this.state.folderIdsOpened,folderId];this.setState({folderIdsOpened})}}handleToggleCloseFolder(folderId){const foldersToClose=[folderId];this.props.context.folders.forEach(folder=>{foldersToClose.includes(folder.folder_parent_id)&&foldersToClose.push(folder.id)});const folderIdsOpened=this.state.folderIdsOpened.filter(folderId=>!foldersToClose.includes(folderId));this.setState({folderIdsOpened})}handleSectionTitleClickCaretEvent(event){event?.stopPropagation();const open=!this.state.open;this.setState({open})}handleDragLeaveTitle(){this.setState({draggingOverTitle:!1,draggingOverTitleSince:null})}handleDragOverTitle(event){if(event.preventDefault(),this.state.draggingOverTitle)return void this.openTitleOnLongDragOver();const draggingOverTitleSince=Date.now();this.setState({draggingOverTitle:!0,draggingOverTitleSince})}openTitleOnLongDragOver(){if(!this.state.open){Date.now()-this.state.draggingOverTitleSince>2e3&&this.handleSectionTitleClickCaretEvent()}}handleDropTitle(){const folders=this.props.dragContext.draggedItems.folders.map(folder=>folder.id),resources=this.props.dragContext.draggedItems.resources.map(resource=>resource.id);folders?.length>0?this.props.context.port.request("passbolt.folders.move-by-id",folders[0],null):resources?.length>0&&this.props.context.port.request("passbolt.resources.move-by-ids",resources,null);this.setState({draggingOverTitle:!1})}canDragItem(item){if(null===item.folder_parent_id)return!0;const folderParent=this.props.context.folders.find(folder=>folder.id===item.folder_parent_id);return!!folderParent.personal||!(folderParent.permission.type<7)&&!(item.permission.type<7)}canDragItems(draggedItems){let canDragItems=draggedItems.folders.reduce((accumulator,folder)=>accumulator&&this.canDragItem(folder),!0);const draggedResources=draggedItems.resources;return canDragItems=canDragItems&&draggedResources.reduce((accumulator,folder)=>accumulator&&this.canDragItem(folder),!0),canDragItems}isLoading(){return null===this.props.context.folders}sortFoldersAlphabetically(folders){folders.sort((folderA,folderB)=>folderA.name.localeCompare(folderB.name,this.props.context.locale,{numeric:!0,caseFirst:"upper"}))}isDragging(){return this.props.dragContext.dragging}get draggedItems(){return this.props.dragContext.draggedItems}renderFolderTree(items,ref){return react.createElement("ul",{ref,className:"folders-tree"},items)}renderItem(index,key,folders){const item=folders[index],isOpen=this.state.folderIdsOpened.includes(item.id);return react.createElement(FilterResourcesByFolders_FilterResourcesByFoldersItem,{key:item.id,folder:item,isOpen,toggleOpenFolder:this.handleToggleOpenFolder,toggleCloseFolder:this.handleToggleCloseFolder})}render(){const isLoading=this.isLoading(),isOpen=this.state.open,folders=this.getFoldersToDisplay(this.props.context.folders,this.state.folderIdsOpened),isDragging=this.isDragging();let showDropFocus=!1,disabled=!1;if(this.props.match.params.filterByFolderId&&this.handleFolderScroll(folders),isDragging&&this.state.draggingOverTitle){this.canDragItems(this.draggedItems)?showDropFocus=!0:disabled=!0}return react.createElement("div",{className:"navigation-secondary-tree navigation-secondary navigation-folders accordion"},react.createElement("div",{className:"accordion-header"},react.createElement("div",{className:(isOpen?"open":"close")+" node root"},react.createElement("div",{className:`row title ${this.isSelected?"selected":""} ${showDropFocus?"drop-focus":""} ${disabled?"disabled":""} ${this.state.moreMenuOpen?"highlight":""}`},react.createElement("div",{className:"main-cell-wrapper"},react.createElement("div",{className:"main-cell"},react.createElement("h3",null,react.createElement("span",{className:"folders-label"},react.createElement("button",{type:"button",className:"link no-border",onDragOver:this.handleDragOverTitle,onDragLeave:this.handleDragLeaveTitle,onDrop:this.handleDropTitle,onClick:this.handleClickOnTitle,onContextMenu:this.handleTitleContextualMenuEvent},react.createElement("div",{className:"toggle-folder",onClick:event=>this.handleSectionTitleClickCaretEvent(event)},isOpen?react.createElement(caret_down.A,null):react.createElement(caret_right.A,null)),react.createElement(cabinet.A,null),react.createElement(es.x6,null,"My workspace")))))),react.createElement("div",{className:"dropdown right-cell more-ctrl"},react.createElement("button",{type:"button",className:"button-transparent inline-menu-horizontal "+(this.state.moreMenuOpen?"open":""),onClick:this.handleTitleMoreClickEvent},react.createElement(more_horizontal.A,null)))))),react.createElement("div",{className:"accordion-content"},isLoading&&react.createElement("div",{className:"processing-wrapper"},react.createElement(spinner.A,null),react.createElement("span",{className:"processing-text"},react.createElement(es.x6,null,"Retrieving folders"))),!isLoading&&isOpen&&0===folders.length&&react.createElement("em",{className:"empty-content"},react.createElement(es.x6,null,"empty")),!isLoading&&isOpen&&folders.length>0&&react.createElement(react_list_default(),{itemRenderer:(index,key)=>this.renderItem(index,key,folders),itemsRenderer:(items,ref)=>this.renderFolderTree(items,ref),length:folders.length,pageSize:30,minSize:30,type:"uniform",usePosition:!0,ref:this.folderTreeRef})))}}FilterResourcesByFolders.propTypes={context:prop_types_default().any,contextualMenuContext:prop_types_default().any,history:prop_types_default().object,match:prop_types_default().object,resourceWorkspaceContext:prop_types_default().object,dialogContext:prop_types_default().any,dragContext:prop_types_default().any};const FilterResourcesByFolders_FilterResourcesByFolders=(0,react_router.withRouter)((0,DialogContext.z9)((0,ContextualMenuContext.t6)((0,ResourceWorkspaceContext.Qw)((0,AppContext.L)((0,DragContext.zk)((0,es.CI)("common")(FilterResourcesByFolders)))))));FilterResourcesByFolders.__docgenInfo={description:"",methods:[{name:"getDefaultState",docblock:"Return default state\n@returns {Object} default state",modifiers:[],params:[],returns:{description:"default state",type:{name:"Object"}},description:"Return default state"},{name:"bindCallbacks",docblock:"Bind callbacks methods",modifiers:[],params:[],returns:null,description:"Bind callbacks methods"},{name:"createRefs",docblock:"Create DOM nodes or React elements references in order to be able to access them programmatically.",modifiers:[],params:[],returns:null,description:"Create DOM nodes or React elements references in order to be able to access them programmatically."},{name:"handleFolderScroll",docblock:"Handles the initial folder scroll ( with a specific manual resource url /folder/view/:id )\n@param {array<object>} folders",modifiers:[],params:[{name:"folders",type:{name:"array",elements:[{name:"object"}]},optional:!1}],returns:null,description:"Handles the initial folder scroll ( with a specific manual resource url /folder/view/:id )"},{name:"scrollTo",docblock:"Triggers a scroll of the folder tree to a folder given its id, if the folder is not visible yet.\n@param {array<object>} folders\n@param {string} folderId",modifiers:[],params:[{name:"folders",type:{name:"array",elements:[{name:"object"}]},optional:!1},{name:"folderId",type:{name:"string"},optional:!1}],returns:null,description:"Triggers a scroll of the folder tree to a folder given its id, if the folder is not visible yet."},{name:"handleFolderToDisplay",docblock:"Handle folder to display according to te context folders and the state for with folder ids opened\n@param {array<Object>} folders The folders from context\n@param {array<string>} folderIdsOpened The folder ids that is opened\n@returns {*[]} The folders array to display",modifiers:[],params:[{name:"folders",description:"The folders from context",type:{name:"array",elements:[{name:"Object"}]},optional:!1},{name:"folderIdsOpened",description:"The folder ids that is opened",type:{name:"array",elements:[{name:"string"}]},optional:!1}],returns:{description:"The folders array to display",type:{name:"Array",elements:[{name:"mixed"}]}},description:"Handle folder to display according to te context folders and the state for with folder ids opened"},{name:"filterFoldersByRootAndFoldersOpened",docblock:"filter folders by root and folders opened\n@param {array<object>} folders\n@param {array<string>} folderIdsOpened\n@returns {array<object>} An array ordered by depth of folders containing object with parent folder id as a key and an array of folders as value\n(example of result: [{null: [folderC, folderA, folderE]}, {folderA.parent_folder_id: [folderK, folderG], ...}, ...]",modifiers:[],params:[{name:"folders",type:{name:"array",elements:[{name:"object"}]},optional:!1},{name:"folderIdsOpened",type:{name:"array",elements:[{name:"string"}]},optional:!1}],returns:{description:"An array ordered by depth of folders containing object with parent folder id as a key and an array of folders as value\n(example of result: [{null: [folderC, folderA, folderE]}, {folderA.parent_folder_id: [folderK, folderG], ...}, ...]",type:{name:"array",elements:[{name:"object"}]}},description:"filter folders by root and folders opened"},{name:"sortAndFlatFoldersByDepth",docblock:"Sort and flat array of folders by depth\n@param {array<object>} foldersByParentIdOrderedByDepth\n@returns {*[]} Array of folders sorted by depth",modifiers:[],params:[{name:"foldersByParentIdOrderedByDepth",type:{name:"array",elements:[{name:"object"}]},optional:!1}],returns:{description:"Array of folders sorted by depth",type:{name:"Array",elements:[{name:"mixed"}]}},description:"Sort and flat array of folders by depth"},{name:"addParentFolderIdsToBeOpen",docblock:"Add parent folder ids in te state folderIdsOpened\n@param folderId The folder id selected",modifiers:[],params:[{name:"folderId",description:"The folder id selected",optional:!1}],returns:null,description:"Add parent folder ids in te state folderIdsOpened"},{name:"handleCloseMoreMenu",docblock:"Close the create menu",modifiers:[],params:[],returns:null,description:"Close the create menu"},{name:"handleClickOnTitle",docblock:"Handle when the user clicks on the section title.",modifiers:[],params:[],returns:null,description:"Handle when the user clicks on the section title."},{name:"isSelected",docblock:"Returns true if the All Items shortcut is currently selected",modifiers:["get"],params:[],returns:null,description:"Returns true if the All Items shortcut is currently selected"},{name:"handleTitleContextualMenuEvent",docblock:"Handle when the user requests to display the contextual menu on the root folder.\n@param {ReactEvent} event The event",modifiers:[],params:[{name:"event",description:"The event",type:{name:"ReactEvent"},optional:!1}],returns:null,description:"Handle when the user requests to display the contextual menu on the root folder."},{name:"handleTitleMoreClickEvent",docblock:"Handle when the user requests to display the contextual menu on the root folder.\n@param {ReactEvent} event The event",modifiers:[],params:[{name:"event",description:"The event",type:{name:"ReactEvent"},optional:!1}],returns:null,description:"Handle when the user requests to display the contextual menu on the root folder."},{name:"handleToggleOpenFolder",docblock:"Handle toggle open folder\nAdd the folder id to the state folderIdsOpened\n@param folderId",modifiers:[],params:[{name:"folderId",optional:!1}],returns:null,description:"Handle toggle open folder\nAdd the folder id to the state folderIdsOpened"},{name:"handleToggleCloseFolder",docblock:"Handle toggle close folder\nRemove the child folder ids from the state folderIdsOpened\n@param folderId",modifiers:[],params:[{name:"folderId",optional:!1}],returns:null,description:"Handle toggle close folder\nRemove the child folder ids from the state folderIdsOpened"},{name:"handleSectionTitleClickCaretEvent",docblock:"Handle fold/unfold root folder icon click\n@param {Event} event",modifiers:[],params:[{name:"event",type:{name:"Event"},optional:!1}],returns:null,description:"Handle fold/unfold root folder icon click"},{name:"handleDragLeaveTitle",docblock:"Handle when the user is not dragging over the section title anymore.",modifiers:[],params:[],returns:null,description:"Handle when the user is not dragging over the section title anymore."},{name:"handleDragOverTitle",docblock:"Handle when the user is dragging content over the section title.\n@param {ReactEvent} event The event",modifiers:[],params:[{name:"event",description:"The event",type:{name:"ReactEvent"},optional:!1}],returns:null,description:"Handle when the user is dragging content over the section title."},{name:"openTitleOnLongDragOver",docblock:"Open the root folder when the user is dragging for a defined period on it.\n@param {ReactEvent} event The event",modifiers:[],params:[],returns:null,description:"Open the root folder when the user is dragging for a defined period on it."},{name:"handleDropTitle",docblock:"Handle when the user is dropping the content on the title.",modifiers:[],params:[],returns:null,description:"Handle when the user is dropping the content on the title."},{name:"canDragItem",docblock:"Check if the user can drag an item.\n@param {object} item The target item",modifiers:[],params:[{name:"item",description:"The target item",type:{name:"object"},optional:!1}],returns:null,description:"Check if the user can drag an item."},{name:"canDragItems",docblock:"Check if the user can drag all the items they are currently dragging.\n@param {array} draggedItems The list of dragged items.\n@returns {boolean}",modifiers:[],params:[{name:"draggedItems",description:"The list of dragged items.",type:{name:"array"},optional:!1}],returns:{type:{name:"boolean"}},description:"Check if the user can drag all the items they are currently dragging."},{name:"isLoading",docblock:"Check if the component is loading.\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Check if the component is loading."},{name:"sortFoldersAlphabetically",docblock:"Sort a list of folders alphabetically\n@param {array} folders The list of folders to sort",modifiers:[],params:[{name:"folders",description:"The list of folders to sort",type:{name:"array"},optional:!1}],returns:null,description:"Sort a list of folders alphabetically"},{name:"isDragging",docblock:"Check if the user is currently dragging content.\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Check if the user is currently dragging content."},{name:"draggedItems",docblock:"return dragged items\n@returns {*}",modifiers:["get"],params:[],returns:{type:{name:"mixed"}},description:"return dragged items"},{name:"renderFolderTree",docblock:"Render folder tree for rows\n@param items\n@param ref\n@return {JSX.Element}",modifiers:[],params:[{name:"items",optional:!1},{name:"ref",optional:!1}],returns:{type:{name:"JSX.Element"}},description:"Render folder tree for rows"},{name:"renderItem",docblock:"Render item folder row\n@param index\n@param key\n@param folders\n@return {JSX.Element}",modifiers:[],params:[{name:"index",optional:!1},{name:"key",optional:!1},{name:"folders",optional:!1}],returns:{type:{name:"JSX.Element"}},description:"Render item folder row"}],displayName:"FilterResourcesByFolders",props:{context:{description:"",type:{name:"any"},required:!1},contextualMenuContext:{description:"",type:{name:"any"},required:!1},history:{description:"",type:{name:"object"},required:!1},match:{description:"",type:{name:"object"},required:!1},resourceWorkspaceContext:{description:"",type:{name:"object"},required:!1},dialogContext:{description:"",type:{name:"any"},required:!1},dragContext:{description:"",type:{name:"any"},required:!1}}}},"./src/react-extension/components/ResourceFolder/CreateResourceFolder/CreateResourceFolder.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__),_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),_Common_Dialog_DialogWrapper_DialogWrapper__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/react-extension/components/Common/Dialog/DialogWrapper/DialogWrapper.js"),_Common_Error_NotifyError_NotifyError__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/react-extension/components/Common/Error/NotifyError/NotifyError.js"),_Common_Inputs_FormSubmitButton_FormSubmitButton__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormSubmitButton.js"),_Common_Inputs_FormSubmitButton_FormCancelButton__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormCancelButton.js"),_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/react-extension/contexts/ActionFeedbackContext.js"),_contexts_DialogContext__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/react-extension/contexts/DialogContext.js"),react_i18next__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),_lib_Error_InputValidator__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./src/react-extension/lib/Error/InputValidator.js"),_shared_constants_inputs_const__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./src/shared/constants/inputs.const.js"),react_router_dom__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/react-router/esm/react-router.js"),_img_svg_attention_svg__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./src/img/svg/attention.svg");class CreateResourceFolder extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.getDefaultState(),this.createInputRefs(),this.bindEventHandlers()}componentDidMount(){this.setState({loading:!1,name:""},()=>{this.nameRef.current.focus()})}getDefaultState(){return{loading:!0,processing:!1,inlineValidation:!1,name:this.translate("loading..."),nameError:!1,nameWarning:""}}createInputRefs(){this.nameRef=react__WEBPACK_IMPORTED_MODULE_0__.createRef()}bindEventHandlers(){this.handleClose=this.handleClose.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleNameInputKeyUp=this.handleNameInputKeyUp.bind(this)}handleClose(){this.props.onClose()}handleInputChange(event){const target=event.target,value=target.value,name=target.name;this.setState({[name]:value},()=>{this.state.inlineValidation&&this.validate()})}async handleFormSubmit(event){if(event.preventDefault(),!this.state.processing){if(this.setState({inlineValidation:this.state.inlineValidation||!0}),await this.toggleProcessing(),await this.validate(),this.hasValidationError())return await this.toggleProcessing(),void this.focusFirstFieldError();try{const folder=await this.createFolder();await this.handleSaveSuccess(folder.id)}catch(error){this.handleSaveError(error)}}}async handleSaveSuccess(folderId){await this.props.actionFeedbackContext.displaySuccess(this.translate("The folder has been added successfully")),this.props.history.push(`/app/folders/view/${folderId}`),this.props.onClose()}handleSaveError(error){"UserAbortsOperationError"===error.name||(console.error(error),this.handleError(error)),this.setState({processing:!1})}handleError(error){const errorDialogProps={error};this.props.dialogContext.open(_Common_Error_NotifyError_NotifyError__WEBPACK_IMPORTED_MODULE_4__.A,errorDialogProps)}async toggleProcessing(){const prev=this.state.processing;return new Promise(resolve=>{this.setState({processing:!prev},resolve())})}focusFirstFieldError(){this.nameRef.current.focus()}async createFolder(){const folderDto={name:this.state.name,folder_parent_id:this.props.folderParentId};return await this.props.context.port.request("passbolt.folders.create",folderDto)}async validate(){return await this.resetValidation(),await this.validateNameInput(),this.hasValidationError()}async resetValidation(){return new Promise(resolve=>{this.setState({nameError:!1},resolve())})}validateNameInput(){let nameError=!1;const name=this.state.name.trim();return name.length||(nameError=this.translate("A name is required.")),name.length>256&&(nameError=this.translate("A name can not be more than 256 char in length.")),new Promise(resolve=>{this.setState({nameError},resolve)})}handleNameInputKeyUp(){const nameWarning=(0,_lib_Error_InputValidator__WEBPACK_IMPORTED_MODULE_10__.d)(this.state.name,_shared_constants_inputs_const__WEBPACK_IMPORTED_MODULE_11__.Dt,this.translate);this.setState({nameWarning})}hasValidationError(){return!1!==this.state.nameError}hasAllInputDisabled(){return this.state.processing||this.state.loading}get translate(){return this.props.t}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Dialog_DialogWrapper_DialogWrapper__WEBPACK_IMPORTED_MODULE_3__.A,{className:"folder-create-dialog",title:this.translate("Create a new folder"),onClose:this.handleClose,disabled:this.hasAllInputDisabled()},react__WEBPACK_IMPORTED_MODULE_0__.createElement("form",{className:"folder-create-form",onSubmit:this.handleFormSubmit,noValidate:!0},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"form-content"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:`input text required ${this.state.nameError?"error":""} ${this.hasAllInputDisabled()?"disabled":""}`},react__WEBPACK_IMPORTED_MODULE_0__.createElement("label",{htmlFor:"folder-name-input"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_9__.x6,null,"Name"),this.state.nameWarning&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_img_svg_attention_svg__WEBPACK_IMPORTED_MODULE_13__.A,{className:"attention-required"})),react__WEBPACK_IMPORTED_MODULE_0__.createElement("input",{id:"folder-name-input",name:"name",ref:this.nameRef,type:"text",value:this.state.name,placeholder:this.translate("Untitled folder"),maxLength:"256",required:"required",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,onKeyUp:this.handleNameInputKeyUp,autoComplete:"off",autoFocus:!0}),this.state.nameError&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"error-message"},this.state.nameError),this.state.nameWarning&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"name warning-message"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("strong",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_9__.x6,null,"Warning:"))," ",this.state.nameWarning))),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"submit-wrapper clearfix"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Inputs_FormSubmitButton_FormCancelButton__WEBPACK_IMPORTED_MODULE_6__.A,{disabled:this.hasAllInputDisabled(),onClick:this.handleClose}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Inputs_FormSubmitButton_FormSubmitButton__WEBPACK_IMPORTED_MODULE_5__.A,{disabled:this.hasAllInputDisabled(),processing:this.state.processing,value:this.translate("Save")}))))}}CreateResourceFolder.propTypes={context:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,actionFeedbackContext:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,folderParentId:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,onClose:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func,dialogContext:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,history:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,t:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func};const __WEBPACK_DEFAULT_EXPORT__=(0,react_router_dom__WEBPACK_IMPORTED_MODULE_12__.withRouter)((0,_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_2__.L)((0,_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_7__.ot)((0,_contexts_DialogContext__WEBPACK_IMPORTED_MODULE_8__.z9)((0,react_i18next__WEBPACK_IMPORTED_MODULE_9__.CI)("common")(CreateResourceFolder)))));CreateResourceFolder.__docgenInfo={description:"",methods:[{name:"getDefaultState",docblock:"Get default state\n@returns {*}",modifiers:[],params:[],returns:{type:{name:"mixed"}},description:"Get default state"},{name:"createInputRefs",docblock:"Create references\n@returns {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Create references"},{name:"bindEventHandlers",docblock:"Bind event handlers\n@returns {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Bind event handlers"},{name:"handleClose",docblock:"Handle close button click.\n@returns {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Handle close button click."},{name:"handleInputChange",docblock:"Handle form input changes.\n@params {ReactEvent} The react event\n@returns {void}",modifiers:[],params:[{name:"event",optional:!1}],returns:{type:{name:"void"}},description:"Handle form input changes."},{name:"handleFormSubmit",docblock:"Handle form submit event.\n@params {ReactEvent} The react event\n@returns {void}",modifiers:["async"],params:[{name:"event",optional:!1}],returns:{type:{name:"void"}},description:"Handle form submit event."},{name:"handleSaveSuccess",docblock:"Handle save operation success.",modifiers:["async"],params:[{name:"folderId",optional:!1}],returns:null,description:"Handle save operation success."},{name:"handleSaveError",docblock:"Handle save operation error.\n@param {object} error The returned error",modifiers:[],params:[{name:"error",description:"The returned error",type:{name:"object"},optional:!1}],returns:null,description:"Handle save operation error."},{name:"handleError",docblock:"handle error to display the error dialog\n@param error",modifiers:[],params:[{name:"error",optional:!1}],returns:null,description:"handle error to display the error dialog"},{name:"toggleProcessing",docblock:"Toggle processing state\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Toggle processing state"},{name:"focusFirstFieldError",docblock:"Focus the first field of the form which is in error state.\n@returns {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Focus the first field of the form which is in error state."},{name:"createFolder",docblock:"Create the folder\n@returns {Promise<Object>} Folder entity or Error",modifiers:["async"],params:[],returns:{description:"Folder entity or Error",type:{name:"Promise",elements:[{name:"Object"}]}},description:"Create the folder"},{name:"validate",docblock:"Validate the form.\n@returns {Promise<boolean>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"boolean"}]}},description:"Validate the form."},{name:"resetValidation",docblock:"Reset validation errors\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Reset validation errors"},{name:"validateNameInput",docblock:"Validate the name input.\n@returns {Promise<void>}",modifiers:[],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Validate the name input."},{name:"handleNameInputKeyUp",docblock:"Handle name input keyUp event.",modifiers:[],params:[],returns:null,description:"Handle name input keyUp event."},{name:"hasValidationError",docblock:"Return true if the form has some validation error\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Return true if the form has some validation error"},{name:"hasAllInputDisabled",docblock:"Should input be disabled? True if state is loading or processing\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Should input be disabled? True if state is loading or processing"},{name:"translate",docblock:"Get the translate function\n@returns {function(...[*]=)}",modifiers:["get"],params:[],returns:{},description:"Get the translate function"}],displayName:"CreateResourceFolder",props:{context:{description:"",type:{name:"any"},required:!1},actionFeedbackContext:{description:"",type:{name:"any"},required:!1},folderParentId:{description:"",type:{name:"string"},required:!1},onClose:{description:"",type:{name:"func"},required:!1},dialogContext:{description:"",type:{name:"any"},required:!1},history:{description:"",type:{name:"any"},required:!1},t:{description:"",type:{name:"func"},required:!1}}}},"./src/react-extension/components/ResourceFolder/DeleteResourceFolder/DeleteResourceFolder.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__),_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),_Common_Error_NotifyError_NotifyError__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/react-extension/components/Common/Error/NotifyError/NotifyError.js"),_Common_Inputs_FormSubmitButton_FormSubmitButton__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormSubmitButton.js"),_Common_Inputs_FormSubmitButton_FormCancelButton__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormCancelButton.js"),_Common_Dialog_DialogWrapper_DialogWrapper__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/react-extension/components/Common/Dialog/DialogWrapper/DialogWrapper.js"),_contexts_DialogContext__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/react-extension/contexts/DialogContext.js"),_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/react-extension/contexts/ActionFeedbackContext.js"),_contexts_LoadingContext__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./src/react-extension/contexts/LoadingContext.js"),react_i18next__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js");class DeleteResourceFolder extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.getStateBasedOnContext(props,this.getDefaultState()),this.bindEventHandlers()}async componentDidMount(){this.setState({loading:!1})}getDefaultState(){return{loading:!0,processing:!1,cascade:!1}}bindEventHandlers(){this.handleClose=this.handleClose.bind(this),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleInputChange=this.handleInputChange.bind(this)}getStateBasedOnContext(props,defaultState){const folders=props.context.folders,error={message:this.translate("The folder could not be found. Maybe it was deleted or you lost access.")};folders||(console.error("No folders context defined."),this.handleError(error));const folder=props.context.folders.find(item=>item.id===props.context.folder.id)||!1;return folder?defaultState.name=folder.name:(console.error(`Folder ${props.context.folder.id} not found in context.`),this.handleError(error)),defaultState}async handleFormSubmit(event){if(event.preventDefault(),!this.state.processing){await this.toggleProcessing();try{this.props.loadingContext.add(),await this.props.context.port.request("passbolt.folders.delete",this.props.context.folder.id,this.state.cascade),await this.handleSaveSuccess()}catch(error){this.handleSaveError(error)}}}async handleSaveSuccess(){this.props.loadingContext.remove(),await this.props.actionFeedbackContext.displaySuccess(this.translate("The folder was deleted successfully")),this.props.onClose()}handleSaveError(error){this.props.loadingContext.remove(),"UserAbortsOperationError"===error.name||(console.error(error),this.handleError(error)),this.setState({processing:!1})}handleError(error){const errorDialogProps={error};this.props.dialogContext.open(_Common_Error_NotifyError_NotifyError__WEBPACK_IMPORTED_MODULE_3__.A,errorDialogProps)}async toggleProcessing(){const prev=this.state.processing;return new Promise(resolve=>{this.setState({processing:!prev},resolve())})}handleInputChange(event){const target=event.target,value="checkbox"===target.type?target.checked:target.value,name=target.name;this.setState({[name]:value})}handleClose(){this.state.processing||this.props.onClose()}hasAllInputDisabled(){return this.state.processing||this.state.loading}get translate(){return this.props.t}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Dialog_DialogWrapper_DialogWrapper__WEBPACK_IMPORTED_MODULE_6__.A,{className:"folder-create-dialog",title:this.translate("Delete folder?"),onClose:this.handleClose,disabled:this.hasAllInputDisabled()},react__WEBPACK_IMPORTED_MODULE_0__.createElement("form",{className:"folder-create-form",onSubmit:this.handleFormSubmit,noValidate:!0},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"form-content"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_10__.x6,null,"Are you sure you want to delete the folder ",react__WEBPACK_IMPORTED_MODULE_0__.createElement("strong",{className:"dialog-variable"},{folderName:this.state.name}),"?")),react__WEBPACK_IMPORTED_MODULE_0__.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_10__.x6,null,"This action cannot be undone. Other users may lose access.")),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"input checkbox"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("input",{id:"delete-cascade",type:"checkbox",name:"cascade",onChange:this.handleInputChange,autoFocus:!0,disabled:this.hasAllInputDisabled()}),"",react__WEBPACK_IMPORTED_MODULE_0__.createElement("label",{htmlFor:"delete-cascade"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_10__.x6,null,"Also delete items inside this folder.")))),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"submit-wrapper clearfix"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Inputs_FormSubmitButton_FormCancelButton__WEBPACK_IMPORTED_MODULE_5__.A,{disabled:this.hasAllInputDisabled(),onClick:this.handleClose}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Inputs_FormSubmitButton_FormSubmitButton__WEBPACK_IMPORTED_MODULE_4__.A,{disabled:this.hasAllInputDisabled(),processing:this.state.processing,value:this.translate("Delete"),warning:!0}))))}}DeleteResourceFolder.propTypes={context:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,onClose:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func,actionFeedbackContext:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,dialogContext:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,loadingContext:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,t:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func};const __WEBPACK_DEFAULT_EXPORT__=(0,_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_2__.L)((0,_contexts_LoadingContext__WEBPACK_IMPORTED_MODULE_9__.$A)((0,_contexts_DialogContext__WEBPACK_IMPORTED_MODULE_7__.z9)((0,_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_8__.ot)((0,react_i18next__WEBPACK_IMPORTED_MODULE_10__.CI)("common")(DeleteResourceFolder)))));DeleteResourceFolder.__docgenInfo={description:"",methods:[{name:"getDefaultState",docblock:"Return default state\n@returns {Object} default state",modifiers:[],params:[],returns:{description:"default state",type:{name:"Object"}},description:"Return default state"},{name:"bindEventHandlers",docblock:"Bind callbacks methods",modifiers:[],params:[],returns:null,description:"Bind callbacks methods"},{name:"getStateBasedOnContext",docblock:"Return default state based on context and props\nFor example if folder doesn't exist then we show an error message\nOtherwise set the input name value\n\n@param props\n@param defaultState\n@returns {*}",modifiers:[],params:[{name:"props",optional:!1},{name:"defaultState",optional:!1}],returns:{type:{name:"mixed"}},description:"Return default state based on context and props\nFor example if folder doesn't exist then we show an error message\nOtherwise set the input name value"},{name:"handleFormSubmit",docblock:"Handle form submit event.\n@params {ReactEvent} The react event\n@return {Promise}",modifiers:["async"],params:[{name:"event",optional:!1}],returns:{type:{name:"Promise"}},description:"Handle form submit event."},{name:"handleSaveSuccess",docblock:"Handle save operation success.",modifiers:["async"],params:[],returns:null,description:"Handle save operation success."},{name:"handleSaveError",docblock:"Handle save operation error.\n@param {object} error The returned error",modifiers:[],params:[{name:"error",description:"The returned error",type:{name:"object"},optional:!1}],returns:null,description:"Handle save operation error."},{name:"handleError",docblock:"handle error to display the error dialog\n@param error",modifiers:[],params:[{name:"error",optional:!1}],returns:null,description:"handle error to display the error dialog"},{name:"toggleProcessing",docblock:"Toggle processing state\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Toggle processing state"},{name:"handleInputChange",docblock:"Handle form input change.\n@params {ReactEvent} The react event.",modifiers:[],params:[{name:"event",optional:!1}],returns:null,description:"Handle form input change."},{name:"handleClose",docblock:"Handle close button click.",modifiers:[],params:[],returns:null,description:"Handle close button click."},{name:"hasAllInputDisabled",docblock:"Should input be disabled? True if state is loading or processing\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Should input be disabled? True if state is loading or processing"},{name:"translate",docblock:"Get the translate function\n@returns {function(...[*]=)}",modifiers:["get"],params:[],returns:{},description:"Get the translate function"}],displayName:"DeleteResourceFolder",props:{context:{description:"",type:{name:"any"},required:!1},onClose:{description:"",type:{name:"func"},required:!1},actionFeedbackContext:{description:"",type:{name:"any"},required:!1},dialogContext:{description:"",type:{name:"any"},required:!1},loadingContext:{description:"",type:{name:"any"},required:!1},t:{description:"",type:{name:"func"},required:!1}}}},"./src/react-extension/components/ResourceFolder/RenameResourceFolder/RenameResourceFolder.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__),_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),_Common_Error_NotifyError_NotifyError__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/react-extension/components/Common/Error/NotifyError/NotifyError.js"),_Common_Dialog_DialogWrapper_DialogWrapper__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/react-extension/components/Common/Dialog/DialogWrapper/DialogWrapper.js"),_Common_Inputs_FormSubmitButton_FormSubmitButton__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormSubmitButton.js"),_Common_Inputs_FormSubmitButton_FormCancelButton__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormCancelButton.js"),_contexts_DialogContext__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/react-extension/contexts/DialogContext.js"),_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/react-extension/contexts/ActionFeedbackContext.js"),react_i18next__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),_lib_Error_InputValidator__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./src/react-extension/lib/Error/InputValidator.js"),_shared_constants_inputs_const__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./src/shared/constants/inputs.const.js"),_img_svg_attention_svg__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./src/img/svg/attention.svg");class RenameResourceFolder extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.getStateBasedOnContext(props,this.getDefaultState()),this.createInputRefs(),this.bindEventHandlers()}async componentDidMount(){this.setState({loading:!1},()=>{this.nameRef.current.focus()})}getDefaultState(){return{loading:!0,processing:!1,inlineValidation:!1,name:this.translate("loading..."),nameError:!1,nameWarning:""}}getStateBasedOnContext(props,defaultState){const folders=props.context.folders,error={message:this.translate("The folder could not be found. Maybe it was deleted or you lost access.")};folders||(console.error("No folders context defined."),this.handleError(error));const folder=props.context.folders.find(item=>item.id===props.context.folder.id)||!1;return folder?defaultState.name=folder.name:(console.error(`Folder ${props.context.folder.id} not found in context.`),this.handleError(error)),defaultState}createInputRefs(){this.nameRef=react__WEBPACK_IMPORTED_MODULE_0__.createRef()}bindEventHandlers(){this.handleClose=this.handleClose.bind(this),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleNameInputKeyUp=this.handleNameInputKeyUp.bind(this)}handleClose(){this.props.onClose()}handleInputChange(event){const target=event.target,value=target.value,name=target.name;this.setState({[name]:value},()=>{this.state.inlineValidation&&this.validate()})}async handleFormSubmit(event){if(event.preventDefault(),!this.state.processing){if(this.setState({inlineValidation:this.state.inlineValidation||!0}),await this.toggleProcessing(),await this.validate(),this.hasValidationError())return await this.toggleProcessing(),void this.focusFirstFieldError();try{const folder=await this.updateFolder();await this.handleSaveSuccess(folder.id)}catch(error){this.handleSaveError(error)}}}async handleSaveSuccess(folderId){await this.props.actionFeedbackContext.displaySuccess(this.translate("The folder was renamed successfully")),this.selectAndScrollToFolder(folderId),this.props.onClose()}handleSaveError(error){"UserAbortsOperationError"===error.name||(console.error(error),this.handleError(error)),this.setState({processing:!1})}handleError(error){const errorDialogProps={error};this.props.dialogContext.open(_Common_Error_NotifyError_NotifyError__WEBPACK_IMPORTED_MODULE_3__.A,errorDialogProps)}async toggleProcessing(){const prev=this.state.processing;return new Promise(resolve=>{this.setState({processing:!prev},resolve())})}focusFirstFieldError(){this.nameRef.current.focus()}async updateFolder(){const folderDto={id:this.props.context.folder.id,name:this.state.name};return await this.props.context.port.request("passbolt.folders.update",folderDto)}selectAndScrollToFolder(id){this.props.context.port.emit("passbolt.folders.select-and-scroll-to",id)}async validate(){return await this.resetValidation(),await this.validateNameInput(),this.hasValidationError()}async resetValidation(){return new Promise(resolve=>{this.setState({nameError:!1},resolve())})}validateNameInput(){let nameError=!1;const name=this.state.name.trim();return name.length||(nameError=this.translate("A name is required.")),name.length>256&&(nameError=this.translate("A name can not be more than 256 char in length.")),new Promise(resolve=>{this.setState({nameError},resolve)})}handleNameInputKeyUp(){const nameWarning=(0,_lib_Error_InputValidator__WEBPACK_IMPORTED_MODULE_10__.d)(this.state.name,_shared_constants_inputs_const__WEBPACK_IMPORTED_MODULE_11__.yN,this.translate);this.setState({nameWarning})}hasValidationError(){return!1!==this.state.nameError}hasAllInputDisabled(){return this.state.processing||this.state.loading}get translate(){return this.props.t}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Dialog_DialogWrapper_DialogWrapper__WEBPACK_IMPORTED_MODULE_4__.A,{className:"rename-folder-dialog",title:this.translate("Rename a folder"),onClose:this.handleClose,disabled:this.hasAllInputDisabled()},react__WEBPACK_IMPORTED_MODULE_0__.createElement("form",{className:"folder-rename-form",onSubmit:this.handleFormSubmit,noValidate:!0},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"form-content"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:`input text required ${this.state.nameError?"error":""} ${this.hasAllInputDisabled()?"disabled":""}`},react__WEBPACK_IMPORTED_MODULE_0__.createElement("label",{htmlFor:"folder-name-input"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_9__.x6,null,"Folder name"),this.state.nameWarning&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_img_svg_attention_svg__WEBPACK_IMPORTED_MODULE_12__.A,{className:"attention-required"})),react__WEBPACK_IMPORTED_MODULE_0__.createElement("input",{id:"folder-name-input",name:"name",ref:this.nameRef,type:"text",value:this.state.name,placeholder:this.translate("Untitled folder"),maxLength:"256",required:"required",onChange:this.handleInputChange,onKeyUp:this.handleNameInputKeyUp,disabled:this.hasAllInputDisabled(),autoComplete:"off",autoFocus:!0}),this.state.nameError&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"name error-message"},this.state.nameError),this.state.nameWarning&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"name warning-message"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("strong",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_9__.x6,null,"Warning:"))," ",this.state.nameWarning))),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"submit-wrapper clearfix"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Inputs_FormSubmitButton_FormCancelButton__WEBPACK_IMPORTED_MODULE_6__.A,{disabled:this.hasAllInputDisabled(),onClick:this.handleClose}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Inputs_FormSubmitButton_FormSubmitButton__WEBPACK_IMPORTED_MODULE_5__.A,{disabled:this.hasAllInputDisabled(),processing:this.state.processing,value:this.translate("Rename")}))))}}RenameResourceFolder.propTypes={context:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,onClose:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func,actionFeedbackContext:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,dialogContext:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,t:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func};const __WEBPACK_DEFAULT_EXPORT__=(0,_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_2__.L)((0,_contexts_DialogContext__WEBPACK_IMPORTED_MODULE_7__.z9)((0,_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_8__.ot)((0,react_i18next__WEBPACK_IMPORTED_MODULE_9__.CI)("common")(RenameResourceFolder))));RenameResourceFolder.__docgenInfo={description:"",methods:[{name:"getDefaultState",docblock:"Return default state\n@returns {Object} default state",modifiers:[],params:[],returns:{description:"default state",type:{name:"Object"}},description:"Return default state"},{name:"getStateBasedOnContext",docblock:"Return default state based on context and props\nFor example if folder doesn't exist then we show an error message\nOtherwise set the input name value\n\n@param props\n@param defaultState\n@returns {*}",modifiers:[],params:[{name:"props",optional:!1},{name:"defaultState",optional:!1}],returns:{type:{name:"mixed"}},description:"Return default state based on context and props\nFor example if folder doesn't exist then we show an error message\nOtherwise set the input name value"},{name:"createInputRefs",docblock:"Create references\n@returns {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Create references"},{name:"bindEventHandlers",docblock:"Bind event handlers\n@returns {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Bind event handlers"},{name:"handleClose",docblock:"Handle close button click.\n@returns {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Handle close button click."},{name:"handleInputChange",docblock:"Handle form input changes.\n@params {ReactEvent} The react event\n@returns {void}",modifiers:[],params:[{name:"event",optional:!1}],returns:{type:{name:"void"}},description:"Handle form input changes."},{name:"handleFormSubmit",docblock:"Handle form submit event.\n@params {ReactEvent} The react event\n@returns {void}",modifiers:["async"],params:[{name:"event",optional:!1}],returns:{type:{name:"void"}},description:"Handle form submit event."},{name:"handleSaveSuccess",docblock:"Handle save operation success.",modifiers:["async"],params:[{name:"folderId",optional:!1}],returns:null,description:"Handle save operation success."},{name:"handleSaveError",docblock:"Handle save operation error.\n@param {object} error The returned error",modifiers:[],params:[{name:"error",description:"The returned error",type:{name:"object"},optional:!1}],returns:null,description:"Handle save operation error."},{name:"handleError",docblock:"handle error to display the error dialog\n@param error",modifiers:[],params:[{name:"error",optional:!1}],returns:null,description:"handle error to display the error dialog"},{name:"toggleProcessing",docblock:"Toggle processing state\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Toggle processing state"},{name:"focusFirstFieldError",docblock:"Focus the first field of the form which is in error state.\n@returns {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Focus the first field of the form which is in error state."},{name:"updateFolder",docblock:"Update the folder\n@returns {Promise<Object>} Folder entity or Error",modifiers:["async"],params:[],returns:{description:"Folder entity or Error",type:{name:"Promise",elements:[{name:"Object"}]}},description:"Update the folder"},{name:"selectAndScrollToFolder",docblock:"Select and scroll to a given resource.\n@param {string} id The resource id.\n@returns {void}",modifiers:[],params:[{name:"id",description:"The resource id.",type:{name:"string"},optional:!1}],returns:{type:{name:"void"}},description:"Select and scroll to a given resource."},{name:"validate",docblock:"Validate the form.\n@returns {Promise<boolean>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"boolean"}]}},description:"Validate the form."},{name:"resetValidation",docblock:"Reset validation errors\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Reset validation errors"},{name:"validateNameInput",docblock:"Validate the name input.\n@returns {Promise<void>}",modifiers:[],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Validate the name input."},{name:"handleNameInputKeyUp",docblock:"Handle name input keyUp event.",modifiers:[],params:[],returns:null,description:"Handle name input keyUp event."},{name:"hasValidationError",docblock:"Return true if the form has some validation error\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Return true if the form has some validation error"},{name:"hasAllInputDisabled",docblock:"Should input be disabled? True if state is loading or processing\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Should input be disabled? True if state is loading or processing"},{name:"translate",docblock:"Get the translate function\n@returns {function(...[*]=)}",modifiers:["get"],params:[],returns:{},description:"Get the translate function"}],displayName:"RenameResourceFolder",props:{context:{description:"",type:{name:"any"},required:!1},onClose:{description:"",type:{name:"func"},required:!1},actionFeedbackContext:{description:"",type:{name:"any"},required:!1},dialogContext:{description:"",type:{name:"any"},required:!1},t:{description:"",type:{name:"func"},required:!1}}}},"./src/react-extension/contexts/DragContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ay:()=>dragContextProvider,CR:()=>DragContext,zk:()=>withDrag});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);const DragContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext({dragAndDrops:null,dragging:!1,draggedItems:null,onDragStart:()=>{},onDragEnd:()=>{}});class dragContextProvider extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.defaultState,this.createRefs()}createRefs(){this.elementRef=react__WEBPACK_IMPORTED_MODULE_0__.createRef()}get defaultState(){return{displayDraggedItemsComponent:[],dragging:!1,draggedItems:null,onDragStart:this.handleDragStart.bind(this),onDragEnd:this.handleDragEnd.bind(this)}}async handleDragStart(event,draggedItemComponent,draggedItems){await this.setState({displayDraggedItemsComponent:[{draggedItemComponent}],dragging:!0,draggedItems}),event.dataTransfer.setDragImage(this.elementRef.current,10,10)}async handleDragEnd(){await this.setState({displayDraggedItemsComponent:[],dragging:!1,draggedItems:null})}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DragContext.Provider,{value:this.state},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"drag-and-drop-wrapper",ref:this.elementRef},this.state.displayDraggedItemsComponent.map((displayDraggedItemComponent,index)=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(displayDraggedItemComponent.draggedItemComponent,{key:index}))),this.props.children)}}function withDrag(WrappedComponent){return class withDrag extends react__WEBPACK_IMPORTED_MODULE_0__.Component{render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DragContext.Consumer,null,dragContext=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(WrappedComponent,{dragContext,...this.props}))}}}dragContextProvider.displayName="dragContextProvider",dragContextProvider.propTypes={children:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any},dragContextProvider.__docgenInfo={description:"The related context provider",methods:[{name:"createRefs",docblock:"Create DOM nodes or React elements references in order to be able to access them programmatically.",modifiers:[],params:[],returns:null,description:"Create DOM nodes or React elements references in order to be able to access them programmatically."},{name:"defaultState",docblock:"Returns the default component state",modifiers:["get"],params:[],returns:null,description:"Returns the default component state"},{name:"handleDragStart",docblock:"Handle drag start\n@param event\n@param draggedItemComponent\n@param draggedItems",modifiers:["async"],params:[{name:"event",optional:!1},{name:"draggedItemComponent",optional:!1},{name:"draggedItems",optional:!1}],returns:null,description:"Handle drag start"},{name:"handleDragEnd",docblock:"Handle drag end",modifiers:["async"],params:[],returns:null,description:"Handle drag end"}],displayName:"dragContextProvider",props:{children:{description:"",type:{name:"any"},required:!1}}}}}]);