/*! For license information please see react-quickaccess-components-FilterResourcesByRecentlyModifiedPage-FilterResourcesByRecentlyModifiedPage-test-stories.c74a2018.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkpassbolt_styleguide=self.webpackChunkpassbolt_styleguide||[]).push([[9054],{"./src/react-quickaccess/components/FilterResourcesByRecentlyModifiedPage/FilterResourcesByRecentlyModifiedPage.test.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{InitialLoad:()=>InitialLoad,NoRecentlyModifiedResource:()=>NoRecentlyModifiedResource,RecentlyModifiedResources:()=>RecentlyModifiedResources,__namedExportsOrder:()=>__namedExportsOrder,default:()=>FilterResourcesByRecentlyModifiedPage_test_stories});var react=__webpack_require__("./node_modules/react/index.js"),react_router=__webpack_require__("./node_modules/react-router/esm/react-router.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),react_router_dom=__webpack_require__("./node_modules/react-router-dom/esm/react-router-dom.js"),es=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),Icon=__webpack_require__("./src/shared/components/Icons/Icon.js"),AppContext=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),filterUtils=__webpack_require__("./src/shared/utils/filterUtils.js"),MetadataTypesSettingsLocalStorageContext=__webpack_require__("./src/shared/context/MetadataTypesSettingsLocalStorageContext/MetadataTypesSettingsLocalStorageContext.js"),ResourceTypesLocalStorageContext=__webpack_require__("./src/shared/context/ResourceTypesLocalStorageContext/ResourceTypesLocalStorageContext.js"),resourceTypesCollection=__webpack_require__("./src/shared/models/entity/resourceType/resourceTypesCollection.js"),metadataTypesSettingsEntity=__webpack_require__("./src/shared/models/entity/metadata/metadataTypesSettingsEntity.js"),resourceTypeSchemasDefinition=__webpack_require__("./src/shared/models/entity/resourceType/resourceTypeSchemasDefinition.js"),ResourceLocalStorageContext=__webpack_require__("./src/react-quickaccess/contexts/ResourceLocalStorageContext.js");class FilterResourcesByRecentlyModifiedPage extends react.Component{constructor(props){super(props),this.initEventHandlers()}componentDidMount(){this.props.context.focusSearch(),this.props.context.searchHistory[this.props.location.pathname]&&this.props.context.updateSearch(this.props.context.searchHistory[this.props.location.pathname])}initEventHandlers(){this.handleGoBackClick=this.handleGoBackClick.bind(this),this.handleSelectResourceClick=this.handleSelectResourceClick.bind(this)}get translate(){return this.props.t}handleGoBackClick(ev){ev.preventDefault(),this.props.context.updateSearch(""),delete this.props.context.searchHistory[this.props.location.pathname],this.props.history.goBack()}handleSelectResourceClick(ev,resourceId){ev.preventDefault(),this.props.context.searchHistory[this.props.location.pathname]=this.props.context.search,this.props.context.updateSearch(""),this.props.history.push(`/webAccessibleResources/quickaccess/resources/view/${resourceId}`)}async findAndLoadResources(){const storageData=await this.props.context.storage.local.get(["resources"]);if(storageData.resources){const resources=storageData.resources;this.sortResourcesByModifiedDesc(resources),this.setState({resources})}}sortResourcesByModifiedDesc(){return this.props.resources.sort(((resource1,resource2)=>new Date(resource2.modified)-new Date(resource1.modified)))}getBrowsedResources(){let resources=this.sortResourcesByModifiedDesc();return this.props.context.search.length&&(resources=(0,filterUtils.$)(resources,this.props.context.search)),resources.slice(0,500)}isReady(){return null!=this.props.resources}hasMetadataTypesSettings(){return Boolean(this.props.metadataTypeSettings)}canCreatePassword(){return this.props.metadataTypeSettings.isDefaultResourceTypeV5?this.props.resourceTypes?.hasOneWithSlug(resourceTypeSchemasDefinition.gG):!!this.props.metadataTypeSettings.isDefaultResourceTypeV4&&this.props.resourceTypes?.hasOneWithSlug(resourceTypeSchemasDefinition.Bo)}render(){const isReady=this.isReady(),isSearching=this.props.context.search.length>0;let browsedResources;return isReady&&(browsedResources=this.getBrowsedResources()),react.createElement("div",{className:"index-list"},react.createElement("div",{className:"back-link"},react.createElement("a",{href:"#",className:"primary-action",onClick:this.handleGoBackClick,title:this.translate("Go back")},react.createElement(Icon.A,{name:"chevron-left"}),react.createElement("span",{className:"primary-action-title"},react.createElement(es.x6,null,"Recently modified"))),react.createElement(react_router_dom.N_,{to:"/webAccessibleResources/quickaccess/home",className:"secondary-action button-transparent button",title:this.translate("Cancel")},react.createElement(Icon.A,{name:"close"}),react.createElement("span",{className:"visually-hidden"},react.createElement(es.x6,null,"Cancel")))),react.createElement("div",{className:"list-container"},react.createElement("ul",{className:"list-items"},!isReady&&react.createElement("li",{className:"empty-entry"},react.createElement(Icon.A,{name:"spinner"}),react.createElement("p",{className:"processing-text"},react.createElement(es.x6,null,"Retrieving your passwords"))),isReady&&react.createElement(react.Fragment,null,!browsedResources.length&&react.createElement("li",{className:"empty-entry"},react.createElement("p",null,isSearching&&react.createElement(es.x6,null,"No result match your search. Try with another search term."),!isSearching&&react.createElement(react.Fragment,null,react.createElement(es.x6,null,"It does feel a bit empty here."),"Â ",react.createElement(es.x6,null,"Create your first password or wait for a team member to share one with you.")))),browsedResources.length>0&&browsedResources.map((resource=>react.createElement("li",{className:"browse-resource-entry",key:resource.id},react.createElement("a",{href:"#",onClick:ev=>this.handleSelectResourceClick(ev,resource.id)},react.createElement("div",{className:"inline-resource-entry"},react.createElement("div",{className:"inline-resource-name"},react.createElement("span",{className:"title"},resource.metadata.name),react.createElement("span",{className:"username"}," ",resource.metadata.username?`(${resource.metadata.username})`:"")),react.createElement("span",{className:"url"},resource.metadata.uris?.[0]))))))))),this.hasMetadataTypesSettings()&&this.canCreatePassword()&&react.createElement("div",{className:"submit-wrapper"},react.createElement(react_router_dom.N_,{to:"/webAccessibleResources/quickaccess/resources/create",id:"popupAction",className:"button primary big full-width",role:"button"},react.createElement(es.x6,null,"Create new"))))}}FilterResourcesByRecentlyModifiedPage.propTypes={context:prop_types_default().any,resources:prop_types_default().array,resourceTypes:prop_types_default().instanceOf(resourceTypesCollection.A),metadataTypeSettings:prop_types_default().instanceOf(metadataTypesSettingsEntity.Ay),match:prop_types_default().object,location:prop_types_default().object,history:prop_types_default().object,t:prop_types_default().func};const FilterResourcesByRecentlyModifiedPage_FilterResourcesByRecentlyModifiedPage=(0,AppContext.L)((0,react_router.y)((0,ResourceTypesLocalStorageContext.KH)((0,ResourceLocalStorageContext.GZ)((0,MetadataTypesSettingsLocalStorageContext.mw)((0,es.CI)("common")(FilterResourcesByRecentlyModifiedPage))))));FilterResourcesByRecentlyModifiedPage.__docgenInfo={description:"",methods:[{name:"initEventHandlers",docblock:null,modifiers:[],params:[],returns:null},{name:"translate",docblock:"Get the translate function\n@returns {function(...[*]=)}",modifiers:["get"],params:[],returns:{},description:"Get the translate function"},{name:"handleGoBackClick",docblock:null,modifiers:[],params:[{name:"ev",optional:!1,type:null}],returns:null},{name:"handleSelectResourceClick",docblock:null,modifiers:[],params:[{name:"ev",optional:!1,type:null},{name:"resourceId",optional:!1,type:null}],returns:null},{name:"findAndLoadResources",docblock:null,modifiers:["async"],params:[],returns:null},{name:"sortResourcesByModifiedDesc",docblock:"Sort resources by recently modified\n@returns {Array}",modifiers:[],params:[],returns:{type:{name:"Array"}},description:"Sort resources by recently modified"},{name:"getBrowsedResources",docblock:"Get the resources to display\n@return {array} The list of resources.",modifiers:[],params:[],returns:{description:"The list of resources.",type:{name:"array"}},description:"Get the resources to display"},{name:"isReady",docblock:null,modifiers:[],params:[],returns:null},{name:"hasMetadataTypesSettings",docblock:"Has metadata types settings\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Has metadata types settings"},{name:"canCreatePassword",docblock:"Can create password\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Can create password"}],displayName:"FilterResourcesByRecentlyModifiedPage",props:{context:{description:"",type:{name:"any"},required:!1},resources:{description:"",type:{name:"array"},required:!1},resourceTypes:{description:"",type:{name:"instanceOf",value:"ResourceTypesCollection"},required:!1},metadataTypeSettings:{description:"",type:{name:"instanceOf",value:"MetadataTypesSettingsEntity"},required:!1},match:{description:"",type:{name:"object"},required:!1},location:{description:"",type:{name:"object"},required:!1},history:{description:"",type:{name:"object"},required:!1},t:{description:"",type:{name:"func"},required:!1}}};var resourceEntity_test_data=__webpack_require__("./src/shared/models/entity/resource/resourceEntity.test.data.js"),AppContext_test_data=__webpack_require__("./src/react-quickaccess/contexts/AppContext.test.data.js"),resourceTypesCollection_test_data=__webpack_require__("./src/shared/models/entity/resourceType/resourceTypesCollection.test.data.js"),metadataTypesSettingsEntity_test_data=__webpack_require__("./src/shared/models/entity/metadata/metadataTypesSettingsEntity.test.data.js");const FilterResourcesByRecentlyModifiedPage_test_stories={title:"Components/QuickAccess/FilterResourcesByRecentlyModified",component:FilterResourcesByRecentlyModifiedPage_FilterResourcesByRecentlyModifiedPage},Template=({context,...args})=>react.createElement(AppContext.A.Provider,{value:context},react.createElement(react_router.fS,{initialEntries:["/"]},react.createElement(react_router.qh,{component:routerProps=>react.createElement("div",{className:"container quickaccess"},react.createElement(FilterResourcesByRecentlyModifiedPage_FilterResourcesByRecentlyModifiedPage,{...args,...routerProps}))})));Template.propTypes={context:prop_types_default().object};const parameters={css:"ext_quickaccess"},InitialLoad=Template.bind({});InitialLoad.args=((data={})=>({context:(0,AppContext_test_data.s)(),resources:null,resourceTypes:new resourceTypesCollection.A((0,resourceTypesCollection_test_data.V1)()),metadataTypeSettings:new metadataTypesSettingsEntity.Ay((0,metadataTypesSettingsEntity_test_data.uc)()),...data}))(),InitialLoad.parameters=parameters;const NoRecentlyModifiedResource=Template.bind({});NoRecentlyModifiedResource.args=((data={})=>({context:(0,AppContext_test_data.s)(),resources:[],resourceTypes:new resourceTypesCollection.A((0,resourceTypesCollection_test_data.V1)()),metadataTypeSettings:new metadataTypesSettingsEntity.Ay((0,metadataTypesSettingsEntity_test_data.uc)()),...data}))(),NoRecentlyModifiedResource.parameters=parameters;const RecentlyModifiedResources=Template.bind({});RecentlyModifiedResources.args=((data={})=>({context:(0,AppContext_test_data.s)(data.context),resources:[(0,resourceEntity_test_data.j8)({metadata:{name:"apache",username:"www-data",uri:"http://www.apache.org/",description:"Apache is the world's most used web server software."}},{withFavorite:!0}),(0,resourceEntity_test_data.j8)({metadata:{name:"esaie",username:"test",uri:"http://www.essaie.org/",description:""}},{withFavorite:!0})],resourceTypes:new resourceTypesCollection.A((0,resourceTypesCollection_test_data.V1)()),metadataTypeSettings:new metadataTypesSettingsEntity.Ay((0,metadataTypesSettingsEntity_test_data.uc)()),...data}))(),RecentlyModifiedResources.parameters=parameters;const __namedExportsOrder=["InitialLoad","NoRecentlyModifiedResource","RecentlyModifiedResources"];InitialLoad.parameters={...InitialLoad.parameters,docs:{...InitialLoad.parameters?.docs,source:{originalSource:"({\n  context,\n  ...args\n}) => <AppContext.Provider value={context}>\n    <MemoryRouter initialEntries={['/']}>\n      <Route component={routerProps => <div className=\"container quickaccess\"><FilterResourcesByRecentlyModifiedPage {...args} {...routerProps} /></div>} />\n    </MemoryRouter>\n  </AppContext.Provider>",...InitialLoad.parameters?.docs?.source}}},NoRecentlyModifiedResource.parameters={...NoRecentlyModifiedResource.parameters,docs:{...NoRecentlyModifiedResource.parameters?.docs,source:{originalSource:"({\n  context,\n  ...args\n}) => <AppContext.Provider value={context}>\n    <MemoryRouter initialEntries={['/']}>\n      <Route component={routerProps => <div className=\"container quickaccess\"><FilterResourcesByRecentlyModifiedPage {...args} {...routerProps} /></div>} />\n    </MemoryRouter>\n  </AppContext.Provider>",...NoRecentlyModifiedResource.parameters?.docs?.source}}},RecentlyModifiedResources.parameters={...RecentlyModifiedResources.parameters,docs:{...RecentlyModifiedResources.parameters?.docs,source:{originalSource:"({\n  context,\n  ...args\n}) => <AppContext.Provider value={context}>\n    <MemoryRouter initialEntries={['/']}>\n      <Route component={routerProps => <div className=\"container quickaccess\"><FilterResourcesByRecentlyModifiedPage {...args} {...routerProps} /></div>} />\n    </MemoryRouter>\n  </AppContext.Provider>",...RecentlyModifiedResources.parameters?.docs?.source}}}},"./src/shared/models/entity/abstract/entity.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});class Entity{constructor(dto,options={}){(options?.clone??!0)&&(dto=JSON.parse(JSON.stringify(dto))),this._props=dto}toDto(){return JSON.parse(JSON.stringify(this))}toJSON(){return this._props}_hasProp(propName){if(!propName.includes(".")){const normalizedPropName=Entity._normalizePropName(propName);return Object.prototype.hasOwnProperty.call(this._props,normalizedPropName)}try{return this._getPropByPath(propName),!0}catch(error){return!1}}_getPropByPath(path){return Entity._normalizePropName(path).split(".").reduce(((obj,i)=>{if(Object.prototype.hasOwnProperty.call(obj,i))return obj[i];throw new Error}),this._props)}static _normalizePropName(name){return name.replace(/([A-Z])/g,((x,y)=>`_${y.toLowerCase()}`)).replace(/\._/,".").replace(/^_/,"").replace(/^\./,"")}}const __WEBPACK_DEFAULT_EXPORT__=Entity},"./src/shared/models/entity/abstract/entityV2.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _entitySchema__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/models/entity/abstract/entitySchema.js"),_entity__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/shared/models/entity/abstract/entity.js"),validator_es_lib_util_assertString__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/validator/es/lib/util/assertString.js"),_entityValidationError__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/shared/models/entity/abstract/entityValidationError.js");const SCALAR_PROPERTY_TYPES=["string","number","integer","boolean"];class EntityV2 extends _entity__WEBPACK_IMPORTED_MODULE_2__.A{static _cachedSchema={};constructor(dtos={},options={}){const validate=options?.validate??!0;if(super(dtos,options),this.marshall(),validate){const error=this.validate({schema:options?.schema,validateBuildRules:options?.validateBuildRules});if(error)throw error}}marshall(){}validate(options={}){try{this.validateSchema(options?.schema),this.validateBuildRules(options?.validateBuildRules)}catch(error){if(!(error instanceof _entityValidationError__WEBPACK_IMPORTED_MODULE_1__.A))throw error;return error}return null}validateSchema(schema=null){this._props=_entitySchema__WEBPACK_IMPORTED_MODULE_0__.A.validate(this.constructor.name,this._props,schema??this.cachedSchema)}get cachedSchema(){return this.constructor._cachedSchema[this.constructor.name]||(this.constructor._cachedSchema[this.constructor.name]=this.constructor.getSchema()),this.constructor._cachedSchema[this.constructor.name]}static getSchema(){throw new Error("The entity class should declare its schema.")}validateBuildRules(options={}){}get(propName){(0,validator_es_lib_util_assertString__WEBPACK_IMPORTED_MODULE_3__.A)(propName);const schemaProperties=this.constructor.getSchema().properties[propName];if(!schemaProperties)throw new Error(`The property "${propName}" has no schema definition.`);if(!SCALAR_PROPERTY_TYPES.includes(schemaProperties?.type))throw new Error('The property "associated_entity" should reference scalar properties only.');return this._props[propName]}set(propName,value,options={}){(0,validator_es_lib_util_assertString__WEBPACK_IMPORTED_MODULE_3__.A)(propName);const validate=options?.validate??!0,schemaProperties=this.constructor.getSchema().properties[propName];if(!schemaProperties)throw new Error(`The property "${propName}" has no schema definition.`);if(!SCALAR_PROPERTY_TYPES.includes(schemaProperties?.type))throw new Error('The property "associated_entity" should reference scalar properties only.');validate&&_entitySchema__WEBPACK_IMPORTED_MODULE_0__.A.validateProp(propName,value,schemaProperties),this._props[propName]=value}diffProps(compareEntity){if(!(compareEntity instanceof EntityV2))throw new TypeError('The property "compareEntity" should be of "EntityV2" type.');const diff={},schema=this.constructor.getSchema(),propertiesNamesToCompare=Object.keys(schema.properties).filter((propertyName=>SCALAR_PROPERTY_TYPES.includes(schema.properties[propertyName].type)));for(const propertyName of propertiesNamesToCompare){const propValue=this.get(propertyName),comparedPropValue=compareEntity.get(propertyName);propValue!==comparedPropValue&&(diff[propertyName]=comparedPropValue)}return diff}hasDiffProps(compareEntity){const diff=this.diffProps(compareEntity);return Object.keys(diff).length>0}}const __WEBPACK_DEFAULT_EXPORT__=EntityV2}}]);