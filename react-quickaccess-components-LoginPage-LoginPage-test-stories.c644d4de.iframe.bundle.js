/*! For license information please see react-quickaccess-components-LoginPage-LoginPage-test-stories.c644d4de.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkpassbolt_styleguide=self.webpackChunkpassbolt_styleguide||[]).push([[6358],{"./src/img/svg/eye_close.svg":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _g,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const __WEBPACK_DEFAULT_EXPORT__=function SvgEyeClose(props){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},props),_g||(_g=react__WEBPACK_IMPORTED_MODULE_0__.createElement("g",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#eye_close_svg__clip0_27_140048)"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M6.587 6.587a2 2 0 1 0 2.826 2.827M7.153 3.386q.422-.052.847-.053C12.667 3.333 14.667 8 14.667 8a8.8 8.8 0 0 1-1.114 1.786"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M4.407 4.406A9 9 0 0 0 1.333 8s2 4.666 6.667 4.666a6.5 6.5 0 0 0 3.593-1.073M1.333 1.333l13.334 13.333"}))))}},"./src/img/svg/eye_open.svg":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _path,_path2,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const __WEBPACK_DEFAULT_EXPORT__=function SvgEyeOpen(props){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},props),_path||(_path=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M1.333 8s2-4.667 6.667-4.667S14.667 8 14.667 8s-2 4.666-6.667 4.666S1.333 8 1.333 8"})),_path2||(_path2=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 10a2 2 0 1 0 0-4 2 2 0 0 0 0 4"})))}},"./src/img/svg/spinner.svg":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _circle,_circle2,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const __WEBPACK_DEFAULT_EXPORT__=function SvgSpinner(props){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",_extends({width:18,height:18,fill:"none",className:"svg-icon spinner",viewBox:"0 0 18 18"},props),_circle||(_circle=react__WEBPACK_IMPORTED_MODULE_0__.createElement("circle",{id:"background",cx:8,cy:8,r:8,fill:"none",stroke:"var(--spinner-background)",strokeWidth:"var(--spinner-stroke-width)",transform:"translate(1 1)"})),_circle2||(_circle2=react__WEBPACK_IMPORTED_MODULE_0__.createElement("circle",{id:"loading",r:8,fill:"none",stroke:"var(--spinner-color)",strokeLinecap:"round",strokeWidth:"var(--spinner-stroke-width)",transform:"translate(9 9)"})))}},"./src/react-extension/components/Administration/ManageSsoSettings/SsoProviders.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");const __WEBPACK_DEFAULT_EXPORT__=[{id:"azure",name:"Microsoft",icon:react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",{width:"65",height:"64",viewBox:"0 0 65 64",fill:"none",xmlns:"http://www.w3.org/2000/svg"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M31.3512 3.04762H3.92261V30.4762H31.3512V3.04762Z",fill:"#F25022"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M31.3512 33.5238H3.92261V60.9524H31.3512V33.5238Z",fill:"#00A4EF"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M61.8274 3.04762H34.3988V30.4762H61.8274V3.04762Z",fill:"#7FBA00"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M61.8274 33.5238H34.3988V60.9524H61.8274V33.5238Z",fill:"#FFB900"})),defaultConfig:{url:"https://login.microsoftonline.com",client_id:"",client_secret:"",tenant_id:"",client_secret_expiry:"",prompt:"login",email_claim:"email",login_hint:!0}},{id:"google",name:"Google",icon:react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",{width:"65",height:"64",viewBox:"0 0 65 64",fill:"none",xmlns:"http://www.w3.org/2000/svg"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M63.9451 32.72C63.9451 30.6133 63.7584 28.6133 63.4384 26.6667H33.3051V38.6933H50.5584C49.7851 42.64 47.5184 45.9733 44.1584 48.24V56.24H54.4517C60.4784 50.6667 63.9451 42.4533 63.9451 32.72Z",fill:"#4285F4"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M33.305 64C41.945 64 49.1717 61.12 54.4517 56.24L44.1583 48.24C41.2783 50.16 37.625 51.3333 33.305 51.3333C24.9583 51.3333 17.8917 45.7067 15.3583 38.1067H4.745V46.3467C9.99833 56.8 20.7983 64 33.305 64Z",fill:"#34A853"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M15.3584 38.1067C14.6917 36.1867 14.3451 34.1333 14.3451 32C14.3451 29.8667 14.7184 27.8133 15.3584 25.8933V17.6533H4.74505C2.55838 21.9733 1.30505 26.8267 1.30505 32C1.30505 37.1733 2.55838 42.0267 4.74505 46.3467L15.3584 38.1067Z",fill:"#FBBC05"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M33.305 12.6667C38.025 12.6667 42.2383 14.2933 45.5717 17.4667L54.6917 8.34667C49.1717 3.17334 41.945 0 33.305 0C20.7983 0 9.99833 7.20001 4.745 17.6533L15.3583 25.8933C17.8917 18.2933 24.9583 12.6667 33.305 12.6667Z",fill:"#EA4335"})),defaultConfig:{client_id:"",client_secret:""}},{id:"oauth2",name:"OpenID",hiddenIfDisabled:!0,disabledForRecover:!0,icon:react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",{width:"65",height:"60",viewBox:"0 0 65 60",fill:"none",xmlns:"http://www.w3.org/2000/svg"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M64.2468 34.9929L62.9089 21.0968L57.9256 23.9083C53.2914 21.0968 47.3581 19.1061 40.7332 18.3046V24.4577C44.5336 25.117 47.9462 26.3321 50.7513 27.9544L45.5031 30.9146L64.2533 34.9929H64.2468Z",fill:"#B3B3B3"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M9.94184 38.8774C9.94184 32.0069 17.4264 26.2222 27.632 24.4577V18.2981C12.023 20.1854 0.246826 28.6783 0.246826 38.8774C0.246826 49.0766 12.8891 58.1769 29.3319 59.6312V53.5557C18.2666 52.166 9.94184 46.1228 9.94184 38.8774Z",fill:"#B3B3B3"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M29.332 5.09999V59.6377L39.027 55.0746V0.362366L29.332 5.09999Z",fill:"#F8931E"})),defaultConfig:{url:"",openid_configuration_path:"",scope:"openid email profile",client_id:"",client_secret:""}},{id:"adfs",name:"AD FS",hiddenIfDisabled:!0,disabledForRecover:!0,icon:react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",{width:"65",height:"64",viewBox:"0 0 65 64",fill:"none",xmlns:"http://www.w3.org/2000/svg"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M64.5443 48.7454V62.166C64.5443 63.7378 64.0607 64.0602 62.5695 63.8184C52.5746 62.3272 42.4587 60.957 32.3831 59.5464C30.5695 59.3046 29.9247 58.6597 29.9247 56.6849C30.0859 49.5514 30.0053 42.3776 29.9247 35.1635C29.9247 33.5917 30.4083 33.1081 31.9801 33.1081C42.2975 33.1887 52.4536 33.1887 62.5695 33.1887C64.2219 33.1887 64.6249 33.8335 64.6249 35.3247C64.4637 39.8386 64.5443 44.2718 64.5443 48.7454Z",fill:"#00AAF2"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M47.416 30.6093C42.3379 30.6093 37.2598 30.5287 32.1817 30.6093C30.6099 30.6093 29.9651 30.2869 29.9651 28.4733C30.0457 21.1786 30.0457 14.0048 29.9651 6.79069C29.9651 5.38011 30.4487 4.89648 31.7787 4.65467C42.1767 3.16349 52.5747 1.7126 62.9726 0.140816C64.7862 -0.100997 64.4638 1.10807 64.4638 2.11563C64.4638 8.56399 64.5444 15.1333 64.4638 21.5816C64.4638 23.9595 64.3832 26.3373 64.4638 28.7151C64.5444 30.2063 63.9802 30.6093 62.5696 30.6093C57.5721 30.5287 52.4941 30.6093 47.416 30.6093Z",fill:"#00AAF2"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M13.8038 33.3096H25.1691C26.3782 33.3096 26.9021 33.7126 26.9021 34.962V57.37C26.9021 58.6597 26.3378 58.7806 25.1691 58.6597C17.6326 57.5312 10.096 56.4431 2.59981 55.3952C1.10863 55.1534 0.625 54.6698 0.625 53.098C0.705605 47.1332 0.705605 41.1685 0.625 35.0829C0.625 33.5917 1.02802 33.1887 2.51921 33.1887C6.34792 33.3096 10.0154 33.3096 13.8038 33.3096Z",fill:"#00AAF2"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M13.8038 30.6093H2.59977C1.18919 30.6093 0.705566 30.1257 0.705566 28.6345C0.786171 22.7504 0.786171 16.8663 0.705566 10.9418C0.705566 9.53126 1.10859 9.04763 2.59977 8.80582C10.1363 7.83856 17.6728 6.7504 25.169 5.54133C26.902 5.29952 27.0633 5.86375 27.0633 7.27433V28.7151C27.0633 30.2869 26.4184 30.5287 25.0078 30.5287C21.2597 30.5287 17.4713 30.6093 13.8038 30.6093Z",fill:"#00AAF2"})),defaultConfig:{url:"",openid_configuration_path:"",scope:"openid email profile",client_id:"",client_secret:""}}]},"./src/react-extension/test/fixture/Settings/userSettings.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__={"user.settings.trustedDomain":new URL(window.location.href).origin,"user.firstname":"Ada","user.id":"f848277c-5398-58f8-a82a-72397af2d450","user.lastname":"Lovelace","user.settings.securityToken.code":"TST","user.settings.securityToken.color":"#000000","user.settings.securityToken.textColor":"#FFFFFF","user.username":"ada@passbolt.com","user.settings.locale":"en-UK","user.settings.theme":"default"}},"./src/react-extension/test/mock/MockPort.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function delay(t,v){return new Promise(resolve=>{setTimeout(()=>resolve(v),t)})}__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=class MockPort{constructor(storage){this.storage=storage,this.onListeners={},this.requestListeners={},this.emitListener={},this.onConnectErrorHandler={}}async emit(name,eventObject){let result;return console.debug(`PORT EMIT: ${name}`),console.debug("Arguments",eventObject),this.emitListener[name]?(result=await this.emitListener[name](eventObject),console.debug("response: ",result)):console.debug(`The emit ${name} has not been mocked`),delay(0,result)}on(name,callback){console.debug(`PORT ON: ${name}`),console.debug("PORT ON PARAMETERS:",callback),this.addOnListener(name,callback)}async request(name){let result;if(console.debug(`PORT REQUEST: ${name}`),console.debug("PORT REQUEST PARAMETERS:",Array.prototype.slice.call(arguments)),this.requestListeners[name]){const listenerArguments=Array.prototype.slice.call(arguments,1,arguments.length);console.debug("listenerArguments",listenerArguments),listenerArguments.push(this.storage),console.debug("listenerArguments",listenerArguments),result=await this.requestListeners[name](...listenerArguments),console.debug("response: ",result)}else console.debug(`The request ${name} has not been mocked`);return delay(0,result)}addEmitListener(name){console.debug(`PORT EMIT: ${name}`),console.debug("PORT EMIT PARAMETERS:",Array.prototype.slice.call(arguments))}addOnListener(name,callback){this.emitListener[name]=callback}addRequestListener(name,callback){this.requestListeners[name]=callback}onConnectError(callback){this.onConnectErrorHandler.callback=callback}}},"./src/react-quickaccess/components/LoginPage/LoginPage.test.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Initial:()=>Initial,WithSsoAvailable:()=>WithSsoAvailable,WithSsoLoginError:()=>WithSsoLoginError,__namedExportsOrder:()=>__namedExportsOrder,default:()=>LoginPage_test_stories});var react=__webpack_require__("./node_modules/react/index.js"),react_router=__webpack_require__("./node_modules/react-router/esm/react-router.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),es=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),spinner=__webpack_require__("./src/img/svg/spinner.svg"),Password=__webpack_require__("./src/shared/components/Password/Password.js"),SsoProviders_data=__webpack_require__("./src/react-extension/components/Administration/ManageSsoSettings/SsoProviders.data.js"),AppContext=__webpack_require__("./src/shared/context/AppContext/AppContext.js");const SsoContext=react.createContext({loadSsoConfiguration:()=>{},getProvider:()=>{},hasUserAnSsoKit:()=>{},runSignInProcess:()=>{}});class SsoContextProvider extends react.Component{constructor(props){super(props),this.state=this.defaultState}get defaultState(){return this.handleSpecificError.bind(this),{ssoLocalConfiguredProvider:null,loadSsoConfiguration:this.loadSsoConfiguration.bind(this),getProvider:this.getProvider.bind(this),hasUserAnSsoKit:this.hasUserAnSsoKit.bind(this),runSignInProcess:this.runSignInProcess.bind(this)}}async loadSsoConfiguration(){const ssoLocalConfiguredProvider=await this.props.context.port.request("passbolt.sso.get-local-configured-provider");this.setState({ssoLocalConfiguredProvider})}getProvider(){return this.state.ssoLocalConfiguredProvider}hasUserAnSsoKit(){return Boolean(this.state.ssoLocalConfiguredProvider)}async runSignInProcess(){try{const provider=this.getProvider();await this.props.context.port.request("passbolt.sso.sign-in",provider,!0)}catch(e){throw console.error(e),this.handleSpecificError(e),e}}handleSpecificError(e){let errorToThrow=e;switch(e.name){case"InvalidMasterPasswordError":errorToThrow=new Error(this.props.t("The passphrase from the SSO kit doesn't match your private key: {{error}}",{error:e.message}));break;case"OutdatedSsoKitError":errorToThrow=new Error(this.props.t("The SSO kit is outdated and can't be used to decrypt your passphrase: {{error}}",{error:e.message}))}throw errorToThrow}render(){return react.createElement(SsoContext.Provider,{value:this.state},this.props.children)}}SsoContextProvider.propTypes={context:prop_types_default().any,children:prop_types_default().any,t:prop_types_default().func};(0,AppContext.L)((0,es.CI)("common")(SsoContextProvider));SsoContextProvider.__docgenInfo={description:"The related context provider",methods:[{name:"defaultState",docblock:"Returns the default component state",modifiers:["get"],params:[],returns:null,description:"Returns the default component state"},{name:"loadSsoConfiguration",docblock:"Find the sso configuration\n@return {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Find the sso configuration"},{name:"getProvider",docblock:"Get the current sso provider configured.\n@returns {string}",modifiers:[],params:[],returns:{type:{name:"string"}},description:"Get the current sso provider configured."},{name:"hasUserAnSsoKit",docblock:"Returns true if the current user has an SSO kit built locally\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Returns true if the current user has an SSO kit built locally"},{name:"runSignInProcess",docblock:"Launches the SSO process with the configured provider\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Launches the SSO process with the configured provider"},{name:"handleSpecificError",docblock:"Handles error from the background page during SSO sign-in.\n@param {Error} e",modifiers:[],params:[{name:"e",type:{name:"Error"},optional:!1}],returns:null,description:"Handles error from the background page during SSO sign-in."}],displayName:"SsoContextProvider",props:{context:{description:"",type:{name:"any"},required:!1},children:{description:"",type:{name:"any"},required:!1},t:{description:"",type:{name:"func"},required:!1}}};class LoginPage extends react.Component{constructor(props){super(props),this.state=this.initState(),this.initEventHandlers(),this.passphraseInputRef=react.createRef()}initEventHandlers(){this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleSwitchToPassphrase=this.handleSwitchToPassphrase.bind(this),this.handleSwitchToSso=this.handleSwitchToSso.bind(this),this.handleSignInWithSso=this.handleSignInWithSso.bind(this)}initState(){return{error:"",ssoError:null,processing:!1,rememberMe:!1,displaySso:!1,isSsoAvailable:!1,isReady:!1}}async componentDidMount(){this.initDefaultRememberMeChoice(),await this.props.ssoContext.loadSsoConfiguration(),this.props.ssoContext.hasUserAnSsoKit()?this.setState({isSsoAvailable:!0,displaySso:!0,isReady:!0}):(this.setState({isReady:!0}),this.focusOnPassphrase())}async initDefaultRememberMeChoice(){const defaultRememberMeChoice=await this.props.context.port.request("passbolt.remember-me.get-user-latest-choice");defaultRememberMeChoice!==this.state.rememberMe&&this.setState({rememberMe:defaultRememberMeChoice})}focusOnPassphrase(){this.passphraseInputRef.current.focus()}async handleFormSubmit(event){event.preventDefault(),this.setState({processing:!0,error:""});try{await this.login()}catch(error){this.setState({error:error.message,processing:!1}),this.focusOnPassphrase()}}async login(){let passphrase=this.passphraseInputRef.current.value;await this.props.context.port.request("passbolt.auth.login",passphrase,this.state.rememberMe),passphrase=null,this.passphraseInputRef.current.value=null,await this.handleLoginSuccess()}async handleLoginSuccess(){await this.props.context.port.request("passbolt.auth.is-mfa-required")?this.props.mfaRequiredCallback(this.props.context.userSettings.getTrustedDomain()):(await this.props.loginSuccessCallback(),this.props.history.push("/webAccessibleResources/quickaccess/home"))}handleInputChange(event){const target=event.target,value="checkbox"===target.type?target.checked:target.value,name=target.name;this.setState({[name]:value})}handleSwitchToSso(event){event.preventDefault(),this.setState({displaySso:!0,ssoError:null})}handleSwitchToPassphrase(event){event.preventDefault(),this.setState({displaySso:!1})}async handleSignInWithSso(event){event.preventDefault(),this.setState({processing:!0,ssoError:""});const currentWindowBlurState=this.props.context.shouldCloseAtWindowBlur;this.props.context.setWindowBlurBehaviour(!1);try{await this.props.ssoContext.runSignInProcess(),await this.handleLoginSuccess()}catch(e){"SsoSettingsChangedError"===e.name&&window.close(),"UserAbortsOperationError"!==e.name&&this.setState({ssoError:e.message})}finally{this.setState({processing:!1}),this.props.context.setWindowBlurBehaviour(currentWindowBlurState)}}get isSsoLocalKitPresent(){const ssoProvider=this.props.ssoContext.getProvider();return SsoProviders_data.A.find(provider=>ssoProvider===provider.id)}get ssoProviderData(){const ssoProvider=this.props.ssoContext.getProvider();return ssoProvider?SsoProviders_data.A.find(provider=>provider.id===ssoProvider):null}render(){const ssoProviderData=this.ssoProviderData;return react.createElement("div",{className:"quickaccess-login"},react.createElement("div",{className:"login-form"},!this.state.displaySso&&this.state.isReady&&react.createElement("form",{onSubmit:this.handleFormSubmit},react.createElement("div",{className:"form-container"},react.createElement("div",{className:"input text required"},react.createElement("label",{htmlFor:"username"},react.createElement(es.x6,null,"Username")),react.createElement("input",{className:"required",maxLength:"50",type:"text",id:"username",required:"required",value:this.props.context.userSettings.username,disabled:"disabled"})),react.createElement("div",{className:"input text passphrase required"},react.createElement("label",{htmlFor:"passphrase"},react.createElement(es.x6,null,"Passphrase")),react.createElement("div",{className:"password with-token"},react.createElement(Password.A,{name:"passphrase",placeholder:this.props.t("Passphrase"),id:"passphrase",autoComplete:"off",inputRef:this.passphraseInputRef,preview:!0,securityToken:this.props.context.userSettings.getSecurityToken(),disabled:this.state.processing})),this.state.error&&react.createElement("div",{className:"error-message"},this.state.error)),this.props.canRememberMe&&react.createElement("div",{className:"input checkbox"},react.createElement("input",{type:"checkbox",name:"rememberMe",id:"remember-me",checked:this.state.rememberMe,onChange:this.handleInputChange,disabled:this.state.processing}),react.createElement("label",{htmlFor:"remember-me"},react.createElement(es.x6,null,"Remember until I log out.")))),react.createElement("div",{className:"submit-wrapper"},react.createElement("button",{type:"submit",className:"button primary big full-width "+(this.state.processing?"processing":""),role:"button",disabled:this.state.processing},react.createElement(es.x6,null,"login"),this.state.processing&&react.createElement(spinner.A,null)),this.state.isSsoAvailable&&react.createElement("a",{className:"show-sso-form-button",onClick:this.handleSwitchToSso},react.createElement(es.x6,null,"Sign in with Single Sign-On.")))),this.state.displaySso&&this.state.isReady&&react.createElement(react.Fragment,null,react.createElement("div",{className:"form-actions sso-login-form"},this.isSsoLocalKitPresent&&react.createElement("a",{className:`button sso-login-button ${this.state.processing?"disabled":""} ${ssoProviderData.id}`,onClick:this.handleSignInWithSso,disabled:this.state.processing},react.createElement("span",{className:"provider-logo"},ssoProviderData.icon),this.props.t("Sign in with {{providerName}}",{providerName:ssoProviderData.name})),react.createElement("a",{className:"show-passphrase-form-button",onClick:this.handleSwitchToPassphrase},react.createElement(es.x6,null,"Sign in with my passphrase.")),this.state.ssoError&&react.createElement("div",{className:"error-message"},react.createElement(es.x6,null,"An error occured during the sign-in via SSO."),react.createElement("br",null),this.state.ssoError)))))}}LoginPage.propTypes={context:prop_types_default().any,ssoContext:prop_types_default().object,canRememberMe:prop_types_default().bool,loginSuccessCallback:prop_types_default().func,mfaRequiredCallback:prop_types_default().func,match:prop_types_default().object,location:prop_types_default().object,history:prop_types_default().object,t:prop_types_default().func};const LoginPage_LoginPage=(0,AppContext.L)((0,react_router.withRouter)(function withSso(WrappedComponent){return class withSso extends react.Component{render(){return react.createElement(SsoContext.Consumer,null,ssoContext=>react.createElement(WrappedComponent,{ssoContext,...this.props}))}}}((0,es.CI)("common")(LoginPage))));LoginPage.__docgenInfo={description:"",methods:[{name:"initEventHandlers",docblock:null,modifiers:[],params:[],returns:null},{name:"initState",docblock:null,modifiers:[],params:[],returns:null},{name:"initDefaultRememberMeChoice",docblock:"Initialise the rememberMe choice with the latest choice made by the user or false if none\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Initialise the rememberMe choice with the latest choice made by the user or false if none"},{name:"focusOnPassphrase",docblock:"Put the focus on the passphrase input",modifiers:[],params:[],returns:null,description:"Put the focus on the passphrase input"},{name:"handleFormSubmit",docblock:null,modifiers:["async"],params:[{name:"event",optional:!1,type:null}],returns:null},{name:"login",docblock:null,modifiers:["async"],params:[],returns:null},{name:"handleLoginSuccess",docblock:null,modifiers:["async"],params:[],returns:null},{name:"handleInputChange",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null}],returns:null},{name:"handleSwitchToSso",docblock:"Switches the UI to the SSO mode.",modifiers:[],params:[{name:"event",optional:!1}],returns:null,description:"Switches the UI to the SSO mode."},{name:"handleSwitchToPassphrase",docblock:"Switches the UI to the passphrase mode.",modifiers:[],params:[{name:"event",optional:!1}],returns:null,description:"Switches the UI to the passphrase mode."},{name:"handleSignInWithSso",docblock:"Handle the click on the SSO login button.\n@returns {Promise<void>}",modifiers:["async"],params:[{name:"event",optional:!1}],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Handle the click on the SSO login button."},{name:"isSsoLocalKitPresent",docblock:"Returns true if SSO is enabled and configured for Azure.\n@return {bool}",modifiers:["get"],params:[],returns:{type:{name:"bool"}},description:"Returns true if SSO is enabled and configured for Azure."},{name:"ssoProviderData",docblock:"Returns the provider information of the current SSO provider configured.\n@return {object}",modifiers:["get"],params:[],returns:{type:{name:"object"}},description:"Returns the provider information of the current SSO provider configured."}],displayName:"LoginPage",props:{context:{description:"",type:{name:"any"},required:!1},ssoContext:{description:"",type:{name:"object"},required:!1},canRememberMe:{description:"",type:{name:"bool"},required:!1},loginSuccessCallback:{description:"",type:{name:"func"},required:!1},mfaRequiredCallback:{description:"",type:{name:"func"},required:!1},match:{description:"",type:{name:"object"},required:!1},location:{description:"",type:{name:"object"},required:!1},history:{description:"",type:{name:"object"},required:!1},t:{description:"",type:{name:"func"},required:!1}}};var MockPort=__webpack_require__("./src/react-extension/test/mock/MockPort.js"),UserSettings=__webpack_require__("./src/shared/lib/Settings/UserSettings.js"),userSettings=__webpack_require__("./src/react-extension/test/fixture/Settings/userSettings.js");function defaultAppContext(appContext){const defaultAppContext={port:new MockPort.A,focusSearch:()=>{},updateSearch:()=>{},searchHistory:{},search:"",userSettings:new UserSettings.A(userSettings.A),setWindowBlurBehaviour:()=>{},shouldCloseAtWindowBlur:!0};return Object.assign(defaultAppContext,appContext||{})}function defaultSsoContext(ssoContext){const defaultSsoContext={loadSsoConfiguration:jest.fn(()=>Promise.resolve()),hasUserAnSsoKit:jest.fn(()=>!0),getProvider:jest.fn(()=>"azure"),runSignInProcess:jest.fn(()=>Promise.resolve())};return Object.assign(defaultSsoContext,ssoContext||{})}const LoginPage_test_stories={title:"Components/QuickAccess/Login",component:LoginPage_LoginPage},Template=({context,...args})=>react.createElement(AppContext.A.Provider,{value:context},react.createElement(react_router.MemoryRouter,{initialEntries:["/"]},react.createElement(react_router.Route,{component:routerProps=>react.createElement("div",{className:"container quickaccess"},react.createElement(LoginPage_LoginPage,{...args,...routerProps}))})));Template.propTypes={context:prop_types_default().object,ssoContext:prop_types_default().object};const Initial=Template.bind({});Initial.args={context:defaultAppContext(),ssoContext:defaultSsoContext({hasUserAnSsoKit:()=>!1}),loginSuccessCallback:()=>{},mfaRequiredCallback:()=>{},canRememberMe:!0},Initial.parameters={css:"ext_quickaccess"};const WithSsoAvailable=Template.bind({});WithSsoAvailable.args={context:defaultAppContext(),ssoContext:defaultSsoContext(),loginSuccessCallback:()=>{},mfaRequiredCallback:()=>{},canRememberMe:!0},WithSsoAvailable.parameters={css:"ext_quickaccess"};const WithSsoLoginError=Template.bind({});WithSsoLoginError.args={context:defaultAppContext(),ssoContext:defaultSsoContext({runSignInProcess:()=>{throw new Error("Unable to decrypt the private key's with the given passphrase")}}),loginSuccessCallback:()=>{},mfaRequiredCallback:()=>{},canRememberMe:!0},WithSsoLoginError.parameters={css:"ext_quickaccess"};const __namedExportsOrder=["Initial","WithSsoAvailable","WithSsoLoginError"];Initial.parameters={...Initial.parameters,docs:{...Initial.parameters?.docs,source:{originalSource:"({\n  context,\n  ...args\n}) => <AppContext.Provider value={context}>\n    <MemoryRouter initialEntries={['/']}>\n      <Route component={routerProps => <div className=\"container quickaccess\">\n        <LoginPage {...args} {...routerProps} />\n      </div>} />\n    </MemoryRouter>\n  </AppContext.Provider>",...Initial.parameters?.docs?.source}}},WithSsoAvailable.parameters={...WithSsoAvailable.parameters,docs:{...WithSsoAvailable.parameters?.docs,source:{originalSource:"({\n  context,\n  ...args\n}) => <AppContext.Provider value={context}>\n    <MemoryRouter initialEntries={['/']}>\n      <Route component={routerProps => <div className=\"container quickaccess\">\n        <LoginPage {...args} {...routerProps} />\n      </div>} />\n    </MemoryRouter>\n  </AppContext.Provider>",...WithSsoAvailable.parameters?.docs?.source}}},WithSsoLoginError.parameters={...WithSsoLoginError.parameters,docs:{...WithSsoLoginError.parameters?.docs,source:{originalSource:"({\n  context,\n  ...args\n}) => <AppContext.Provider value={context}>\n    <MemoryRouter initialEntries={['/']}>\n      <Route component={routerProps => <div className=\"container quickaccess\">\n        <LoginPage {...args} {...routerProps} />\n      </div>} />\n    </MemoryRouter>\n  </AppContext.Provider>",...WithSsoLoginError.parameters?.docs?.source}}}},"./src/shared/components/Password/Password.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__),_img_svg_eye_open_svg__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/img/svg/eye_open.svg"),_img_svg_eye_close_svg__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/img/svg/eye_close.svg"),react_i18next__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js");class Password extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{viewPassword:!1,hasPassphraseFocus:!1,isPassphraseActive:!1}}bindCallbacks(){this.handleInputChange=this.handleInputChange.bind(this),this.handlePasswordInputFocus=this.handlePasswordInputFocus.bind(this),this.handlePasswordInputBlur=this.handlePasswordInputBlur.bind(this),this.handleViewPasswordButtonClick=this.handleViewPasswordButtonClick.bind(this),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this)}handleInputChange(event){this.props.onChange&&this.props.onChange(event)}handlePasswordInputFocus(){this.setState({hasPassphraseFocus:!0})}handlePasswordInputBlur(){this.setState({hasPassphraseFocus:!1})}handleViewPasswordButtonClick(){this.props.disabled||this.setState({viewPassword:!this.state.viewPassword})}get securityTokenStyle(){const inverseStyle={background:this.props.securityToken.textColor,color:this.props.securityToken.backgroundColor},fullStyle={background:this.props.securityToken.backgroundColor,color:this.props.securityToken.textColor};return this.state.hasPassphraseFocus?inverseStyle:fullStyle}get passphraseInputStyle(){if(!this.state.hasPassphraseFocus)return;const{backgroundColor}=this.props.securityToken,textColor=this.getContrastTextColor(backgroundColor);return{background:backgroundColor,color:textColor,"--passphrase-placeholder-color":textColor}}get previewStyle(){if(!this.state.hasPassphraseFocus)return;const{backgroundColor}=this.props.securityToken;return{"--icon-color":this.getContrastTextColor(backgroundColor),"--icon-background-color":backgroundColor}}getContrastTextColor(backgroundColor){const hex=backgroundColor.replace("#",""),bigint=parseInt(hex,16);return(.299*(bigint>>16&255)+.587*(bigint>>8&255)+.114*(255&bigint))/255>.5?"var(--Token-Token-text-and-icon)":"var(--Token-Token-text-and-icon-reversed)"}handleMouseDown(){this.setState({isPassphraseActive:!0})}handleMouseUp(){this.setState({isPassphraseActive:!1})}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:`input password ${this.props.disabled?"disabled":""} ${this.state.hasPassphraseFocus?"":"no-focus"} ${this.state.isPassphraseActive?"active":""} ${this.props.securityToken?"security":""}`,style:this.props.securityToken?this.passphraseInputStyle:void 0},react__WEBPACK_IMPORTED_MODULE_0__.createElement("input",{id:this.props.id,name:this.props.name,maxLength:"4096",placeholder:this.props.placeholder,type:this.state.viewPassword&&!this.props.disabled?"text":"password",onKeyUp:this.props.onKeyUp,value:this.props.value,onFocus:this.handlePasswordInputFocus,onBlur:this.handlePasswordInputBlur,onChange:this.handleInputChange,disabled:this.props.disabled,readOnly:this.props.readOnly,autoComplete:this.props.autoComplete,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,"aria-required":!0,ref:this.props.inputRef}),this.props.preview&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"password-view-wrapper"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{type:"button",onClick:this.handleViewPasswordButtonClick,style:this.props.securityToken?this.previewStyle:void 0,className:"password-view infield button-transparent "+(this.props.disabled?"disabled":"")},!this.state.viewPassword&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_img_svg_eye_open_svg__WEBPACK_IMPORTED_MODULE_2__.A,{className:"svg-icon eye-open"}),this.state.viewPassword&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_img_svg_eye_close_svg__WEBPACK_IMPORTED_MODULE_3__.A,{className:"svg-icon eye-close"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",{className:"visually-hidden"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_4__.x6,null,"View")))),this.props.securityToken&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"security-token-wrapper"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",{className:"security-token",style:this.securityTokenStyle},this.props.securityToken.code)))}}Password.defaultProps={id:"",name:"",autoComplete:"off"},Password.propTypes={context:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,id:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,name:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,value:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,placeholder:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,autoComplete:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,inputRef:prop_types__WEBPACK_IMPORTED_MODULE_1___default().object,disabled:prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool,readOnly:prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool,preview:prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool,onChange:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func,onKeyUp:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func,securityToken:prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({code:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,backgroundColor:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,textColor:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string})};const __WEBPACK_DEFAULT_EXPORT__=(0,react_i18next__WEBPACK_IMPORTED_MODULE_4__.CI)("common")(Password);Password.__docgenInfo={description:"This component represent a password input field with some additional properties",methods:[{name:"defaultState",docblock:null,modifiers:["get"],params:[],returns:null},{name:"bindCallbacks",docblock:"Bind callbacks methods\n@return {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Bind callbacks methods"},{name:"handleInputChange",docblock:"Handle form input change.\n@params {ReactEvent} The react event.",modifiers:[],params:[{name:"event",optional:!1}],returns:null,description:"Handle form input change."},{name:"handlePasswordInputFocus",docblock:"Whenever the user focus on the password input",modifiers:[],params:[],returns:null,description:"Whenever the user focus on the password input"},{name:"handlePasswordInputBlur",docblock:"Whenever the user blurs on the password input",modifiers:[],params:[],returns:null,description:"Whenever the user blurs on the password input"},{name:"handleViewPasswordButtonClick",docblock:"Handle view password button click.",modifiers:[],params:[],returns:null,description:"Handle view password button click."},{name:"securityTokenStyle",docblock:"Returns the style of the security token (color and text color)",modifiers:["get"],params:[],returns:null,description:"Returns the style of the security token (color and text color)"},{name:"passphraseInputStyle",docblock:"Get the passphrase input style.\n@return {Object}",modifiers:["get"],params:[],returns:{type:{name:"Object"}},description:"Get the passphrase input style."},{name:"previewStyle",docblock:"Returns the style of preview (icon color and icon background color)",modifiers:["get"],params:[],returns:null,description:"Returns the style of preview (icon color and icon background color)"},{name:"getContrastTextColor",docblock:"Calculate the luminance of a color and return the appropriate text color variable.\n@param {string} backgroundColor - The background color in hex format.\n@returns {string} - The CSS variable for text color.",modifiers:[],params:[{name:"backgroundColor",description:"The background color in hex format.",type:{name:"string"},optional:!1}],returns:{description:"The CSS variable for text color.",type:{name:"string"}},description:"Calculate the luminance of a color and return the appropriate text color variable."},{name:"handleMouseDown",docblock:"Handle the mouse down to set active item",modifiers:[],params:[],returns:null,description:"Handle the mouse down to set active item"},{name:"handleMouseUp",docblock:"Handle the mouse down to set active item to false",modifiers:[],params:[],returns:null,description:"Handle the mouse down to set active item to false"}],displayName:"Password",props:{id:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},name:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},autoComplete:{defaultValue:{value:'"off"',computed:!1},description:"",type:{name:"string"},required:!1},context:{description:"",type:{name:"any"},required:!1},value:{description:"",type:{name:"string"},required:!1},placeholder:{description:"",type:{name:"string"},required:!1},inputRef:{description:"",type:{name:"object"},required:!1},disabled:{description:"",type:{name:"bool"},required:!1},readOnly:{description:"",type:{name:"bool"},required:!1},preview:{description:"",type:{name:"bool"},required:!1},onChange:{description:"",type:{name:"func"},required:!1},onKeyUp:{description:"",type:{name:"func"},required:!1},securityToken:{description:"",type:{name:"shape",value:{code:{name:"string",required:!1},backgroundColor:{name:"string",required:!1},textColor:{name:"string",required:!1}}},required:!1}}}},"./src/shared/lib/Settings/UserSettings.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>UserSettings});class UserSettings{constructor(settings){this.settings=settings}get id(){return this.settings["user.id"]}get fullName(){return`${this.settings["user.firstname"]} ${this.settings["user.lastname"]}`}get username(){return this.settings["user.username"]}getTheme(){return this.settings["user.settings.theme"]}getTrustedDomain(){return this.settings["user.settings.trustedDomain"]}getSecurityToken(){return{code:this.settings["user.settings.securityToken.code"],backgroundColor:this.settings["user.settings.securityToken.color"],textColor:this.settings["user.settings.securityToken.textColor"]}}get locale(){return this.settings["user.settings.locale"]}}}}]);