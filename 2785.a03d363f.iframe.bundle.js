/*! For license information please see 2785.a03d363f.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkpassbolt_styleguide=self.webpackChunkpassbolt_styleguide||[]).push([[2785],{"./src/shared/models/entity/gpgkey/external/externalGpgKeyPairEntity.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _abstract_entity__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/shared/models/entity/abstract/entity.js"),_externalGpgKeyEntity__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/models/entity/gpgkey/externalGpgKeyEntity.js"),_abstract_entitySchema__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/shared/models/entity/abstract/entitySchema.js");class ExternalGpgKeyPairEntity extends _abstract_entity__WEBPACK_IMPORTED_MODULE_2__.A{constructor(externalGpgKeyPeyPairDto,options={}){super(_abstract_entitySchema__WEBPACK_IMPORTED_MODULE_1__.A.validate(ExternalGpgKeyPairEntity.ENTITY_NAME,externalGpgKeyPeyPairDto,ExternalGpgKeyPairEntity.getSchema()),options),this._props.private_key&&(this._private_key=new _externalGpgKeyEntity__WEBPACK_IMPORTED_MODULE_0__.A(this._props.private_key,{clone:!1}),delete this._props.private_key),this._props.public_key&&(this._public_key=new _externalGpgKeyEntity__WEBPACK_IMPORTED_MODULE_0__.A(this._props.public_key,{clone:!1}),delete this._props.public_key)}static getSchema(){return{type:"object",required:["public_key","private_key"],properties:{public_key:_externalGpgKeyEntity__WEBPACK_IMPORTED_MODULE_0__.A.getSchema(),private_key:_externalGpgKeyEntity__WEBPACK_IMPORTED_MODULE_0__.A.getSchema()}}}toDto(contain){const result=Object.assign({},this._props);return contain?(contain.public_key&&this._public_key&&(result.public_key=this.publicKey.toDto()),contain.private_key&&this._private_key&&(result.private_key=this.privateKey.toDto()),result):result}toJSON(){return this.toDto(ExternalGpgKeyPairEntity.ALL_CONTAIN_OPTIONS)}get publicKey(){return this._public_key}get privateKey(){return this._private_key}static get ENTITY_NAME(){return"externalGpgKeyPairEntity"}static get ALL_CONTAIN_OPTIONS(){return{public_key:!0,private_key:!0}}}const __WEBPACK_DEFAULT_EXPORT__=ExternalGpgKeyPairEntity},"./src/shared/models/entity/gpgkey/externalGpgKeyEntity.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _abstract_entity__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/shared/models/entity/abstract/entity.js"),_abstract_entitySchema__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/models/entity/abstract/entitySchema.js");class ExternalGpgKeyEntity extends _abstract_entity__WEBPACK_IMPORTED_MODULE_1__.A{constructor(gpgkeyDto,options={}){const sanitizedGpgkeyDto=ExternalGpgKeyEntity.sanitizeDto(gpgkeyDto);super(_abstract_entitySchema__WEBPACK_IMPORTED_MODULE_0__.A.validate(ExternalGpgKeyEntity.ENTITY_NAME,sanitizedGpgkeyDto,ExternalGpgKeyEntity.getSchema()),options)}static getSchema(){return{type:"object",required:["armored_key"],properties:{armored_key:{type:"string",minLength:1},key_id:{type:"string",minLength:8,maxLength:16},user_ids:{type:"array"},fingerprint:{type:"string",minLength:40,maxLength:40},expires:{anyOf:[{type:"string",format:"date-time"},{type:"string",pattern:"^Infinity$"},{}],nullable:!0},created:{type:"string",format:"date-time"},algorithm:{type:"string"},length:{type:"integer",minimum:1},curve:{type:"string",nullable:!0},private:{type:"boolean"},revoked:{type:"boolean"}}}}static sanitizeDto(dto){const sanitizedDto=JSON.parse(JSON.stringify(dto));if(dto.key&&(sanitizedDto.armored_key=dto.key,delete sanitizedDto.key),dto.keyId&&(sanitizedDto.key_id=dto.keyId,delete sanitizedDto.keyId),dto.userIds&&(sanitizedDto.user_ids=dto.userIds,delete sanitizedDto.userIds),dto.created)try{const date=new Date(sanitizedDto.created);sanitizedDto.created=date.toISOString()}catch(error){delete sanitizedDto.created}if("Never"===dto.expires)sanitizedDto.expires="Infinity";else if(dto.expires&&"Infinity"!==dto.expires)try{const date=new Date(sanitizedDto.expires);sanitizedDto.expires=date.toISOString()}catch(error){delete sanitizedDto.expires,console.error(`ExternalGpgKeyEntity::sanitizeDto Unable to sanitize the key for the user ${dto.user_id}`)}return sanitizedDto}get armoredKey(){return this._props.armored_key}get keyId(){return this._props.key_id}get userIds(){return this._props.user_ids}get fingerprint(){return this._props.fingerprint}get expires(){return this._props.expires}get isValid(){return null!==this.expires}get created(){return this._props.created}get algorithm(){return this._props.algorithm}get length(){return this._props.length}get curve(){return this._props.curve}get revoked(){return this._props.revoked}get private(){return this._props.private}get isExpired(){const expires=this.expires;if(null===expires)return null;if("Infinity"===expires)return!1;const now=Date.now();return new Date(expires)<now}static get ENTITY_NAME(){return"externalGpgKey"}}const __WEBPACK_DEFAULT_EXPORT__=ExternalGpgKeyEntity},"./src/shared/models/entity/metadata/metadataKeyEntity.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>metadataKeyEntity});var entityV2=__webpack_require__("./src/shared/models/entity/abstract/entityV2.js"),entityValidationError=__webpack_require__("./src/shared/models/entity/abstract/entityValidationError.js"),entityV2Collection=__webpack_require__("./src/shared/models/entity/abstract/entityV2Collection.js"),entitySchema=__webpack_require__("./src/shared/models/entity/abstract/entitySchema.js");class MetadataPrivateKeyDataEntity extends entityV2.A{static getSchema(){return{type:"object",required:["object_type","domain","fingerprint","armored_key","passphrase"],properties:{object_type:{type:"string",enum:["PASSBOLT_METADATA_PRIVATE_KEY"]},domain:{type:"string",maxLength:1024},fingerprint:{type:"string",pattern:/^[a-f0-9]{40}$/im},armored_key:{type:"string",maxLength:1e4,pattern:/^-----BEGIN PGP PRIVATE KEY BLOCK-----([\r\n])([ -9;-~]{1,76}: [ -~]{1,76}([\r\n]))*\n([a-zA-Z0-9\/+=]{1,76}([\r\n]))*=[a-zA-Z0-9\/+=]{4}([\r\n])-----END PGP PRIVATE KEY BLOCK-----([\r\n]*)$/},passphrase:{type:"string",maxLength:1024}}}}get armoredKey(){return this._props.armored_key}}const metadataPrivateKeyDataEntity=MetadataPrivateKeyDataEntity;class MetadataPrivateKeyEntity extends entityV2.A{constructor(dto,options={}){super(dto),this._props.data&&"string"!=typeof this._props.data&&(this._data=new metadataPrivateKeyDataEntity(this._props.data,{...options,clone:!1}),delete this._props.data)}static getSchema(){return{type:"object",required:["user_id","data"],properties:{id:{type:"string",format:"uuid",nullable:!0},metadata_key_id:{type:"string",format:"uuid",nullable:!0},user_id:{type:"string",format:"uuid",nullable:!0},data:{anyOf:[{type:"string",maxLength:1e4,pattern:/^-----BEGIN PGP MESSAGE-----([\r\n])([ -9;-~]{1,76}: [ -~]{1,76}([\r\n]))*\n([a-zA-Z0-9\/+=]{1,76}([\r\n]))*=[a-zA-Z0-9\/+=]{4}([\r\n])-----END PGP MESSAGE-----([\r\n]*)$/},{type:"object"}]},created:{type:"string",format:"date-time"},created_by:{type:"string",format:"uuid"},modified:{type:"string",format:"date-time"},modified_by:{type:"string",format:"uuid"}}}}validateBuildRules(){if(Boolean(this._props.data)&&Boolean(this._data)){const error=new entityValidationError.A,message="The property data and _data cannot be set at the same time";throw error.addError("data","only-one-defined",message),error}}toDto(){const result=Object.assign({},this._props),data=this.data;return result.data=data instanceof metadataPrivateKeyDataEntity?data.toDto():data,result}toJSON(){return this.toDto()}get data(){return this.isDecrypted?this._data:this._props.data}get metadataKeyId(){return this._props.metadata_key_id||null}set data(data){entitySchema.A.validateProp("data",data,this.cachedSchema.properties.data),"string"==typeof data?(this._props.data=data,delete this._data):(this._data=new metadataPrivateKeyDataEntity(data.toDto(),{clone:!0,validate:!1}),delete this._props.data)}get isDecrypted(){return Boolean(this._data)}get userId(){return this._props.user_id}}const metadataPrivateKeyEntity=MetadataPrivateKeyEntity;class MetadataPrivateKeysCollection extends entityV2Collection.A{get entityClass(){return metadataPrivateKeyEntity}constructor(dtos=[],options={}){super(dtos,options)}static getSchema(){return{type:"array",items:metadataPrivateKeyEntity.getSchema()}}validateBuildRules(item,options={}){this.assertNotExist("id",item._props.id,{haystackSet:options?.uniqueIdsSetCache}),this.assertNotExist("user_id",item._props.user_id,{haystackSet:options?.uniqueUserIdsSetCache}),this.assertSameMetadataKeyId(item)}assertSameMetadataKeyId(item){if(!item.metadataKeyId)return;const collectionMetadataKeyId=this._items.find((item=>Boolean(item.metadataKeyId)))?.metadataKeyId;if(!collectionMetadataKeyId)return;if(item.metadataKeyId===collectionMetadataKeyId)return;const error=new entityValidationError.A;throw error.addError("metadata_key_id","same_metadata_key","The collection should not contain different metadata key ID."),error}hasDecryptedPrivateKeys(){return this._items.some((item=>item.isDecrypted))}hasEncryptedPrivateKeys(){return this._items.some((item=>!item.isDecrypted))}pushMany(data,entityOptions={},options={}){const uniqueIdsSetCache=new Set(this.extract("id")),uniqueUserIdsSetCache=new Set(this.extract("user_id"));options={onItemPushed:item=>{uniqueIdsSetCache.add(item._props.id),uniqueUserIdsSetCache.add(item._props.user_id)},validateBuildRules:{...options?.validateBuildRules,uniqueIdsSetCache,uniqueUserIdsSetCache},...options},super.pushMany(data,entityOptions,options)}}const metadataPrivateKeysCollection=MetadataPrivateKeysCollection;class MetadataKeyEntity extends entityV2.A{constructor(dto,options={}){super(dto,options),this._props.metadata_private_keys&&(this._metadata_private_keys=new metadataPrivateKeysCollection(this._props.metadata_private_keys,{...options,clone:!1}),delete this._props.metadata_private_keys,this.assertSameMetadataKeyId())}static getSchema(){return{type:"object",required:["fingerprint","armored_key"],properties:{id:{type:"string",format:"uuid",nullable:!0},fingerprint:{type:"string",pattern:/^[a-f0-9]{40}$/im},armored_key:{type:"string",maxLength:1e4,pattern:/^-----BEGIN PGP PUBLIC KEY BLOCK-----([\r\n])([ -9;-~]{1,76}: [ -~]{1,76}([\r\n]))*\n([a-zA-Z0-9\/+=]{1,76}([\r\n]))*=[a-zA-Z0-9\/+=]{4}([\r\n])-----END PGP PUBLIC KEY BLOCK-----([\r\n]*)$/},created:{type:"string",format:"date-time",nullable:!0},created_by:{type:"string",format:"uuid",nullable:!0},modified:{type:"string",format:"date-time",nullable:!0},modified_by:{type:"string",format:"uuid",nullable:!0},deleted:{type:"string",format:"date-time",nullable:!0},expired:{type:"string",format:"date-time",nullable:!0},metadata_private_keys:metadataPrivateKeysCollection.getSchema()}}}validateBuildRules(){}assertSameMetadataKeyId(){if(0===(this._metadata_private_keys?.length||0))return;if(this.id!==this._metadata_private_keys.items[0].metadataKeyId){const error=new entityValidationError.A;throw error.addError("id:metadata_private_keys","same_id","`id` and the `metadata_private_keys.id` should be the same"),error}}toDto(contain){const result=Object.assign({},this._props);return contain?(this._metadata_private_keys&&contain.metadata_private_keys&&(result.metadata_private_keys=this._metadata_private_keys.toDto()),result):result}get armoredKey(){return this._props.armored_key}get id(){return this._props.id||null}get metadataPrivateKeys(){return this._metadata_private_keys||null}get created(){return this._props.created||null}get fingerprint(){return this._props.fingerprint}get expired(){return this._props.expired||null}static get ALL_CONTAIN_OPTIONS(){return{metadata_private_keys:!0}}}const metadataKeyEntity=MetadataKeyEntity},"./src/shared/models/entity/metadata/metadataKeyEntity.test.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{L:()=>defaultMetadataKeyDto});var v4=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js");function mutatePgpBlockFromOptions(block,options={withCrc:!0,withComments:!1,withWrongExtraCharacters:!1,withDuplicates:!1}){return options.withComments&&(block=block.replace("\n\n","\nVersion: PGP 1.0\nComments: This is a test\n\n")),options.withWrongExtraCharacters&&(block=block.replace(/\n\n(.{64})\n/,"\n\n$1Wrong Stuff Here\n")),options.withCrc||(block=block.replace(/\n=[a-zA-Z0-9/+=]{4}\n-----/,"\n-----")),options.withDuplicates&&(block=`${block}\n\n${block}\n\n${block}`),block}const defaultArmoredPublicKey=options=>mutatePgpBlockFromOptions("-----BEGIN PGP PUBLIC KEY BLOCK-----\n\n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\n=KFUt\n-----END PGP PUBLIC KEY BLOCK-----",options);var metadataPrivateKeyEntity_test_data=__webpack_require__("./src/shared/models/entity/metadata/metadataPrivateKeyEntity.test.data.js");const defaultMetadataKeyDto=(data={},options={})=>((data={},options={})=>{const defaultData={fingerprint:Array.from({length:40},(()=>Math.floor(16*Math.random()).toString(16).toUpperCase())).join(""),armored_key:defaultArmoredPublicKey(),...data};return!defaultData.metadata_private_keys&&options?.withMetadataPrivateKeys&&(defaultData.metadata_private_keys=[(0,metadataPrivateKeyEntity_test_data.mr)({metadata_key_id:defaultData.id})]),defaultData})({id:data.id||(0,v4.A)(),modified:"2022-10-11T08:09:00+00:00",created_by:(0,v4.A)(),created:"2022-10-11T08:09:00+00:00",modified_by:(0,v4.A)(),deleted:null,expired:null,...data},options)},"./src/shared/models/entity/metadata/metadataKeysCollection.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _abstract_entityV2Collection__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/models/entity/abstract/entityV2Collection.js"),_metadataKeyEntity__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/shared/models/entity/metadata/metadataKeyEntity.js");class MetadataKeysCollection extends _abstract_entityV2Collection__WEBPACK_IMPORTED_MODULE_0__.A{get entityClass(){return _metadataKeyEntity__WEBPACK_IMPORTED_MODULE_1__.A}constructor(dtos=[],options={}){super(dtos,options)}static getSchema(){return{type:"array",items:_metadataKeyEntity__WEBPACK_IMPORTED_MODULE_1__.A.getSchema()}}validateBuildRules(item,options={}){this.assertNotExist("id",item._props.id,{haystackSet:options?.uniqueIdsSetCache}),this.assertNotExist("fingerprint",item._props.fingerprint,{haystackSet:options?.uniqueFingerprintsSetCache})}getFirstByLatestCreated(){return this.length?this._items.reduce(((latestCreatedItem,item)=>latestCreatedItem.created?item.created&&item.created>latestCreatedItem.created?item:latestCreatedItem:item)):null}toDto(contains={}){return this._items.map((entity=>entity.toDto(contains)))}hasDecryptedKeys(){return this._items.some((metadataKey=>metadataKey.metadataPrivateKeys?.hasDecryptedPrivateKeys()))}hasEncryptedKeys(){return this._items.some((metadataKey=>metadataKey.metadataPrivateKeys?.hasEncryptedPrivateKeys()))}pushMany(data,entityOptions={},options={}){const uniqueIdsSetCache=new Set(this.extract("id")),uniqueFingerprintsSetCache=new Set(this.extract("fingerprint"));options={onItemPushed:item=>{uniqueIdsSetCache.add(item._props.id),uniqueFingerprintsSetCache.add(item._props.fingerprint)},validateBuildRules:{...options?.validateBuildRules,uniqueIdsSetCache,uniqueFingerprintsSetCache},...options},super.pushMany(data,entityOptions,options)}}const __WEBPACK_DEFAULT_EXPORT__=MetadataKeysCollection},"./src/shared/models/entity/metadata/metadataPrivateKeyEntity.test.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{mr:()=>defaultMetadataPrivateKeyDto});var uuid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js"),_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./test/fixture/pgpKeys/keys.js");const defaultMetadataPrivateKeyDto=(data={})=>((data={})=>({user_id:null,data:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.metadataKey.encryptedMetadataPrivateKeyDataMessage,...data}))({id:(0,uuid__WEBPACK_IMPORTED_MODULE_1__.A)(),user_id:(0,uuid__WEBPACK_IMPORTED_MODULE_1__.A)(),metadata_key_id:(0,uuid__WEBPACK_IMPORTED_MODULE_1__.A)(),modified:"2022-10-11T08:09:00+00:00",created_by:(0,uuid__WEBPACK_IMPORTED_MODULE_1__.A)(),created:"2022-10-11T08:09:00+00:00",modified_by:(0,uuid__WEBPACK_IMPORTED_MODULE_1__.A)(),...data})},"./src/shared/services/serviceWorker/metadata/metadataKeysServiceWorkerService.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ay:()=>__WEBPACK_DEFAULT_EXPORT__});var _models_entity_metadata_metadataKeysCollection__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/models/entity/metadata/metadataKeysCollection.js"),_models_entity_gpgkey_external_externalGpgKeyPairEntity__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/shared/models/entity/gpgkey/external/externalGpgKeyPairEntity.js"),_models_entity_metadata_metadataKeyEntity__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/shared/models/entity/metadata/metadataKeyEntity.js");const __WEBPACK_DEFAULT_EXPORT__=class MetadataKeysServiceWorkerService{constructor(port){this.port=port}async findAll(){const metadataKeysDto=await this.port.request("passbolt.metadata.find-all-non-deleted-metadata-keys");return new _models_entity_metadata_metadataKeysCollection__WEBPACK_IMPORTED_MODULE_0__.A(metadataKeysDto)}async generateKeyPair(){const externalGpgKeyPairDto=await this.port.request("passbolt.metadata.generate-metadata-key");return new _models_entity_gpgkey_external_externalGpgKeyPairEntity__WEBPACK_IMPORTED_MODULE_1__.A(externalGpgKeyPairDto)}async createKey(metadataKeyPair){if(!(metadataKeyPair instanceof _models_entity_gpgkey_external_externalGpgKeyPairEntity__WEBPACK_IMPORTED_MODULE_1__.A))throw new TypeError("The parameter `metadataKeyPair` should be of type ExternalGpgKeyPairEntity.");const metadataKeyDto=await this.port.request("passbolt.metadata.create-key",metadataKeyPair.toDto({public_key:!0,private_key:!0}));return new _models_entity_metadata_metadataKeyEntity__WEBPACK_IMPORTED_MODULE_2__.A(metadataKeyDto)}}}}]);