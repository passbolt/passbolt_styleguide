/*! For license information please see react-extension-components-Administration-DisplayContentTypesMetadataKeyAdministration-DisplayContentTypesMetadataKeyAdministration-test-stories.daea4158.iframe.bundle.js.LICENSE.txt */
(self.webpackChunkpassbolt_styleguide=self.webpackChunkpassbolt_styleguide||[]).push([[1155],{"./src/react-extension/components/Administration/DisplayContentTypesMetadataKeyAdministration/DisplayContentTypesMetadataKeyAdministration.test.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{GeneratedMetadataKey:()=>GeneratedMetadataKey,Initial:()=>Initial,MultipleActiveKeys:()=>MultipleActiveKeys,MultipleKeys:()=>MultipleKeys,SingleActiveMetadataKey:()=>SingleActiveMetadataKey,WithValidationError:()=>WithValidationError,__namedExportsOrder:()=>__namedExportsOrder,default:()=>DisplayContentTypesMetadataKeyAdministration_test_stories});var react=__webpack_require__("./node_modules/react/index.js"),DisplayContentTypesMetadataKeyAdministration=__webpack_require__("./src/react-extension/components/Administration/DisplayContentTypesMetadataKeyAdministration/DisplayContentTypesMetadataKeyAdministration.js"),ExtAppContext_test_data=__webpack_require__("./src/react-extension/contexts/ExtAppContext.test.data.js"),DialogContext_test_data=__webpack_require__("./src/react-extension/contexts/DialogContext.test.data.js"),resourceTypesCollection=__webpack_require__("./src/shared/models/entity/resourceType/resourceTypesCollection.js"),resourceTypesCollection_test_data=__webpack_require__("./src/shared/models/entity/resourceType/resourceTypesCollection.test.data.js"),metadataKeysSettingsEntity=__webpack_require__("./src/shared/models/entity/metadata/metadataKeysSettingsEntity.js"),metadataKeysSettingsEntity_test_data=__webpack_require__("./src/shared/models/entity/metadata/metadataKeysSettingsEntity.test.data.js"),metadataKeysCollection=__webpack_require__("./src/shared/models/entity/metadata/metadataKeysCollection.js"),metadataKeyEntity_test_data=__webpack_require__("./src/shared/models/entity/metadata/metadataKeyEntity.test.data.js"),externalGpgKeyCollection=__webpack_require__("./src/shared/models/entity/gpgkey/externalGpgKeyCollection.js"),externalGpgKeyEntity_test_data=__webpack_require__("./src/shared/models/entity/gpgkey/externalGpgKeyEntity.test.data.js"),keys=__webpack_require__("./test/fixture/pgpKeys/keys.js"),externalGpgKeyPairEntity=__webpack_require__("./src/shared/models/entity/gpgkey/external/externalGpgKeyPairEntity.js"),metadataKeyEntity=__webpack_require__("./src/shared/models/entity/metadata/metadataKeyEntity.js"),ActionFeedbackContext_test_data=__webpack_require__("./src/react-extension/contexts/ActionFeedbackContext.test.data.js"),AdministrationWorkspaceContext=__webpack_require__("./src/react-extension/contexts/AdministrationWorkspaceContext.js"),AdministrationWorkspaceContext_test_data=__webpack_require__("./src/react-extension/contexts/AdministrationWorkspaceContext.test.data.js");const metadataKeysInfoDto=[(0,externalGpgKeyEntity_test_data.w9)(),(0,externalGpgKeyEntity_test_data.sE)(),(0,externalGpgKeyEntity_test_data.Sm)(),(0,externalGpgKeyEntity_test_data.he)()];function defaultProps(props={}){const metadataKeysInfo=new externalGpgKeyCollection.A(metadataKeysInfoDto);return{context:(0,ExtAppContext_test_data.dO)(),dialogContext:(0,DialogContext_test_data.L)(),actionFeedbackContext:(0,ActionFeedbackContext_test_data.M)(),administrationWorkspaceContext:(0,AdministrationWorkspaceContext_test_data.M)({selectedAdministration:AdministrationWorkspaceContext.UZ.CONTENT_TYPES_METADATA_KEY}),metadataSettingsServiceWorkerService:{findKeysSettings:()=>new metadataKeysSettingsEntity.A((0,metadataKeysSettingsEntity_test_data.L)()),saveKeysSettings:settings=>settings},metadataKeysServiceWorkerService:{findAll:()=>new metadataKeysCollection.A([]),generateKeyPair:()=>new externalGpgKeyPairEntity.A({public_key:(0,externalGpgKeyEntity_test_data.he)(),private_key:(0,externalGpgKeyEntity_test_data.Zm)()}),createKey:()=>new metadataKeyEntity.A((0,metadataKeyEntity_test_data.L)({fingerprint:keys.u.eddsa_ed25519.fingerprint,armored_key:keys.u.eddsa_ed25519.public}))},gpgServiceWorkerService:{keyInfo:armoredKey=>metadataKeysInfo.getFirst("armored_key",armoredKey),keysInfo:()=>metadataKeysInfo},createPortal:jest.fn(),resourceTypes:new resourceTypesCollection.A((0,resourceTypesCollection_test_data.V1)()),t:text=>text,...props}}var dom_esm=__webpack_require__("./node_modules/@testing-library/dom/dist/@testing-library/dom.esm.js"),react_router=__webpack_require__("./node_modules/react-router/esm/react-router.js"),TranslationProvider=__webpack_require__("./src/react-extension/components/Common/Internationalisation/TranslationProvider.js"),DisplayAdministrationWorkspaceBreadcrumb=__webpack_require__("./src/react-extension/components/Administration/DisplayAdministrationWorkspaceBreadcrumb/DisplayAdministrationWorkspaceBreadcrumb.js");const DisplayContentTypesMetadataKeyAdministration_test_stories={title:"Components/Administration/DisplayContentTypesMetadataKeyAdministration",component:DisplayContentTypesMetadataKeyAdministration.A,decorators:[(Story,{args})=>react.createElement(react_router.MemoryRouter,{initialEntries:["/app/administration/content-types/metadata"]},react.createElement(TranslationProvider.A,{loadingPath:"/webAccessibleResources/locales/{{lng}}/{{ns}}.json"},react.createElement("div",{id:"container",className:"page administration"},react.createElement("div",{id:"app",className:"app",style:{margin:"-1rem"}},react.createElement("div",{className:"panel main"},react.createElement("div",{className:"panel left"},react.createElement("div",{className:"sidebar-content"},react.createElement("div",{className:"top-bar-left-navigation"},react.createElement("div",{className:"navigation"})),react.createElement("div",{className:"sidebar-content-left"}))),react.createElement("div",{className:"panel middle"},react.createElement("div",{className:"header"}),react.createElement("div",{className:"middle-right"},react.createElement("div",{className:"breadcrumbs-and-grid"},react.createElement("div",{className:"top-bar"},react.createElement(DisplayAdministrationWorkspaceBreadcrumb.A,{administrationWorkspaceContext:args.administrationWorkspaceContext})),react.createElement("div",{className:"main-page"},react.createElement(Story,args))),react.createElement("div",{className:"help-panel"},react.createElement("div",{className:"sidebar-help"},react.createElement("div",{id:"administration-help-panel"}))))))))))]},Initial={args:defaultProps()},WithValidationError={args:defaultProps(),play:async({canvasElement})=>{(0,dom_esm.ux)(canvasElement).getByTestId("submit-form").requestSubmit()}},GeneratedMetadataKey={args:defaultProps(),play:async({canvasElement})=>{(0,dom_esm.ux)(canvasElement).getByTestId("generate-key-buton").click()}},SingleActiveMetadataKey={args:function defaultSettingsAndSingleActiveKeyProps(props={}){const metadataKeysDto=[(0,metadataKeyEntity_test_data.L)({armored_key:keys.u.ada.public,fingerprint:keys.u.ada.fingerprint})];return defaultProps({metadataKeysServiceWorkerService:{findAll:()=>new metadataKeysCollection.A(metadataKeysDto)},...props})}()},MultipleActiveKeys={args:function defaultSettingsAndMultipleActiveKeysProps(props={}){const metadataKeysDto=[(0,metadataKeyEntity_test_data.L)({armored_key:keys.u.ada.public,fingerprint:keys.u.ada.fingerprint}),(0,metadataKeyEntity_test_data.L)({armored_key:keys.u.betty.public,fingerprint:keys.u.betty.fingerprint})];return defaultProps({metadataKeysServiceWorkerService:{findAll:()=>new metadataKeysCollection.A(metadataKeysDto)},...props})}()},MultipleKeys={args:function defaultSettingsAndMultipleKeysProps(props={}){const metadataKeysDto=[(0,metadataKeyEntity_test_data.L)({armored_key:keys.u.ada.public,fingerprint:keys.u.ada.fingerprint}),(0,metadataKeyEntity_test_data.L)({armored_key:keys.u.betty.public,fingerprint:keys.u.betty.fingerprint}),(0,metadataKeyEntity_test_data.L)({armored_key:keys.u.carol.public,fingerprint:keys.u.carol.fingerprint,expired:"2022-03-04T13:59:11+00:00"}),(0,metadataKeyEntity_test_data.L)({armored_key:keys.u.eddsa_ed25519.public,fingerprint:keys.u.eddsa_ed25519.fingerprint,expired:"2023-10-04T15:11:45+00:00"})];return defaultProps({metadataKeysServiceWorkerService:{findAll:()=>new metadataKeysCollection.A(metadataKeysDto)},...props})}()},__namedExportsOrder=["Initial","WithValidationError","GeneratedMetadataKey","SingleActiveMetadataKey","MultipleActiveKeys","MultipleKeys"];Initial.parameters={...Initial.parameters,docs:{...Initial.parameters?.docs,source:{originalSource:"{\n  args: defaultProps()\n}",...Initial.parameters?.docs?.source}}},WithValidationError.parameters={...WithValidationError.parameters,docs:{...WithValidationError.parameters?.docs,source:{originalSource:'{\n  args: defaultProps(),\n  // Trigger the form validation.\n  play: async ({\n    canvasElement\n  }) => {\n    const canvas = within(canvasElement);\n    const form = canvas.getByTestId("submit-form");\n    form.requestSubmit();\n  }\n}',...WithValidationError.parameters?.docs?.source}}},GeneratedMetadataKey.parameters={...GeneratedMetadataKey.parameters,docs:{...GeneratedMetadataKey.parameters?.docs,source:{originalSource:'{\n  args: defaultProps(),\n  // Trigger a key generation.\n  play: async ({\n    canvasElement\n  }) => {\n    const canvas = within(canvasElement);\n    const form = canvas.getByTestId("generate-key-buton");\n    form.click();\n  }\n}',...GeneratedMetadataKey.parameters?.docs?.source}}},SingleActiveMetadataKey.parameters={...SingleActiveMetadataKey.parameters,docs:{...SingleActiveMetadataKey.parameters?.docs,source:{originalSource:"{\n  args: defaultSettingsAndSingleActiveKeyProps()\n}",...SingleActiveMetadataKey.parameters?.docs?.source}}},MultipleActiveKeys.parameters={...MultipleActiveKeys.parameters,docs:{...MultipleActiveKeys.parameters?.docs,source:{originalSource:"{\n  args: defaultSettingsAndMultipleActiveKeysProps()\n}",...MultipleActiveKeys.parameters?.docs?.source}}},MultipleKeys.parameters={...MultipleKeys.parameters,docs:{...MultipleKeys.parameters?.docs,source:{originalSource:"{\n  args: defaultSettingsAndMultipleKeysProps()\n}",...MultipleKeys.parameters?.docs?.source}}}},"./src/img/svg/file_text.svg":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _path,_path2,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const __WEBPACK_DEFAULT_EXPORT__=function SvgFileText(props){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},props),_path||(_path=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z"})),_path2||(_path2=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M14 2v4a2 2 0 0 0 2 2h4M10 9H8M16 13H8M16 17H8"})))}},"./src/react-extension/components/Administration/DisplayContentTypesMetadataKeyAdministration/DisplayContentTypesMetadataKeyAdministration.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Administration_DisplayContentTypesMetadataKeyAdministration_DisplayContentTypesMetadataKeyAdministration});var prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),react=__webpack_require__("./node_modules/react/index.js"),es=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),memoize_one_esm=__webpack_require__("./node_modules/memoize-one/dist/memoize-one.esm.js"),AppContext=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),metadataSettingsServiceWorkerService=__webpack_require__("./src/shared/services/serviceWorker/metadata/metadataSettingsServiceWorkerService.js"),NotifyError=__webpack_require__("./src/react-extension/components/Common/Error/NotifyError/NotifyError.js"),DialogContext=__webpack_require__("./src/react-extension/contexts/DialogContext.js"),dateUtils=__webpack_require__("./src/shared/utils/dateUtils.js"),metadataKeysServiceWorkerService=__webpack_require__("./src/shared/services/serviceWorker/metadata/metadataKeysServiceWorkerService.js"),Fingerprint=__webpack_require__("./src/react-extension/components/Common/Fingerprint/Fingerprint.js"),externalGpgKeyEntity=__webpack_require__("./src/shared/models/entity/gpgkey/externalGpgKeyEntity.js"),externalGpgKeyCollection=__webpack_require__("./src/shared/models/entity/gpgkey/externalGpgKeyCollection.js");const gpgServiceWorkerService=class GpgServiceWorkerService{constructor(port){this.port=port}async keyInfo(armoredKey){const keyInfoDto=await this.port.request("passbolt.keyring.get-key-info",armoredKey);return new externalGpgKeyEntity.A(keyInfoDto)}async keysInfo(armoredKeys=[]){const keysInfoDto=[];for(const armoredKey of armoredKeys){const keyInfo=await this.keyInfo(armoredKey);keysInfoDto.push(keyInfo)}return new externalGpgKeyCollection.A(keysInfoDto)}};var metadataKeysCollection=__webpack_require__("./src/shared/models/entity/metadata/metadataKeysCollection.js"),metadataKeysSettingsEntity=__webpack_require__("./src/shared/models/entity/metadata/metadataKeysSettingsEntity.js"),externalGpgKeyPairEntity=__webpack_require__("./src/shared/models/entity/gpgkey/external/externalGpgKeyPairEntity.js");class MetadataKeysSettingsFormEntity extends metadataKeysSettingsEntity.A{constructor(dto,options={}){super(dto,options),this._props.generated_metadata_key&&(this._generated_metadata_key=new externalGpgKeyPairEntity.A(this._props.generated_metadata_key,{...options,clone:!1}),delete this._props.generated_metadata_key)}static getSchema(){return{type:"object",required:["allow_usage_of_personal_keys","zero_knowledge_key_share"],properties:{...metadataKeysSettingsEntity.A.getSchema().properties,generated_metadata_key:externalGpgKeyPairEntity.A.getSchema()}}}toDto(){return{...this._props,generated_metadata_key:this.generatedMetadataKey?.toDto({public_key:!0,private_key:!0})||null}}get generatedMetadataKey(){return this._generated_metadata_key||null}set generatedMetadataKey(generatedMetadataKey){if(null!==generatedMetadataKey&&!(generatedMetadataKey instanceof externalGpgKeyPairEntity.A))throw new TypeError("The parameter `generatedMetadataKey` should be of type ExternalGpgKeyPairEntity.");this._generated_metadata_key=generatedMetadataKey}}const metadataKeysSettingsFormEntity=MetadataKeysSettingsFormEntity;var metadataKeyEntity=__webpack_require__("./src/shared/models/entity/metadata/metadataKeyEntity.js");class DisplayContentTypesMetadataKeyAdministration extends react.Component{render(){return react.createElement("div",{className:"actions-wrapper"},react.createElement("button",{type:"button",className:"button primary",disabled:this.props.isProcessing,onClick:this.props.onSaveRequested},react.createElement("span",null,react.createElement(es.x6,null,"Save"))))}}DisplayContentTypesMetadataKeyAdministration.propTypes={isProcessing:prop_types_default().bool,onSaveRequested:prop_types_default().func,t:prop_types_default().func};const DisplayContentTypesMetadataKeyAdministrationActions=(0,es.CI)("common")(DisplayContentTypesMetadataKeyAdministration);DisplayContentTypesMetadataKeyAdministration.__docgenInfo={description:"",methods:[],displayName:"DisplayContentTypesMetadataKeyAdministration",props:{isProcessing:{description:"",type:{name:"bool"},required:!1},onSaveRequested:{description:"",type:{name:"func"},required:!1},t:{description:"",type:{name:"func"},required:!1}}};var entityValidationError=__webpack_require__("./src/shared/models/entity/abstract/entityValidationError.js"),ActionFeedbackContext=__webpack_require__("./src/react-extension/contexts/ActionFeedbackContext.js"),portals=__webpack_require__("./src/shared/utils/portals.js"),file_text=__webpack_require__("./src/img/svg/file_text.svg");class DisplayContentTypesMetadataKeyAdministration_DisplayContentTypesMetadataKeyAdministration extends react.Component{originalSettings=null;formSettings=null;constructor(props){super(props),this.metadataSettingsServiceWorkerService=props.metadataSettingsServiceWorkerService??new metadataSettingsServiceWorkerService.Ay(props.context.port),this.metadataKeysServiceWorkerService=props.metadataKeysServiceWorkerService??new metadataKeysServiceWorkerService.Ay(props.context.port),this.gpgServiceWorkerService=props.gpgServiceWorkerService??new gpgServiceWorkerService(props.context.port),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{isProcessing:!0,hasAlreadyBeenValidated:!1,settings:{allow_usage_of_personal_keys:!0,zero_knowledge_key_share:!1,generated_metadata_key:null},activeMetadataKeys:null,expiredMetadataKeys:null}}bindCallbacks(){this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.generateMetadataKey=this.generateMetadataKey.bind(this),this.save=this.save.bind(this)}async componentDidMount(){await this.loadKeysSettings(),await this.loadKeys(),this.setState({isProcessing:!1})}async loadKeysSettings(){try{const settings=await this.metadataSettingsServiceWorkerService.findKeysSettings();this.originalSettings=new metadataKeysSettingsFormEntity(settings.toDto(),{validate:!1}),this.formSettings=new metadataKeysSettingsFormEntity(settings.toDto(),{validate:!1}),this.setState({settings:this.formSettings.toDto()})}catch(error){await this.handleUnexpectedError(error)}}handleUnexpectedError(error){if(console.error(error),"UserAbortsOperationError"!==error.name)return this.props.dialogContext.open(NotifyError.A,{error})}async loadKeys(){try{const metadataKeys=await this.metadataKeysServiceWorkerService.findAll(),activeMetadataKeys=new metadataKeysCollection.A(metadataKeys);activeMetadataKeys.filterByCallback((metadataKey=>!metadataKey.expired));const expiredMetadataKeys=new metadataKeysCollection.A(metadataKeys);expiredMetadataKeys.filterByCallback((metadataKey=>metadataKey.expired));const armoredKeys=metadataKeys.items.map((metadataKey=>metadataKey.armoredKey)),metadataKeysInfo=await this.gpgServiceWorkerService.keysInfo(armoredKeys);this.setState({activeMetadataKeys,expiredMetadataKeys,metadataKeysInfo})}catch(error){await this.handleUnexpectedError(error)}}hasSettingsChanges=(0,memoize_one_esm.A)(((originalSettings,formSettings,formSettingsDto)=>originalSettings?.hasDiffProps(formSettings)||originalSettings?.generatedMetadataKey!==formSettings?.generatedMetadataKey));handleInputChange(event){if(this.hasAllInputDisabled())return;const{type,checked,value,name}=event.target;let parsedValue=value;"checkbox"===type&&(parsedValue=checked),"allow_usage_of_personal_keys"!==name&&"zero_knowledge_key_share"!==name||(parsedValue="true"===value),this.setFormPropertyValue(name,parsedValue)}setFormPropertyValue(name,parsedValue){this.formSettings.set(name,parsedValue,{validate:!1}),this.setState({settings:this.formSettings.toDto()})}hasAllInputDisabled(){return this.state.isProcessing}async generateMetadataKey(){const metadataKeysInfo=this.state.metadataKeysInfo,activeMetadataKeys=this.state.activeMetadataKeys;this.setState({isProcessing:!0});try{const metadataKeyPair=await this.metadataKeysServiceWorkerService.generateKeyPair(),metadataKeyInfo=await this.gpgServiceWorkerService.keyInfo(metadataKeyPair.publicKey.armoredKey);metadataKeysInfo.push(metadataKeyInfo);const metadataKey=new metadataKeyEntity.A({armored_key:metadataKeyPair.publicKey.armoredKey,fingerprint:metadataKeyInfo.fingerprint});activeMetadataKeys.push(metadataKey),this.formSettings.generatedMetadataKey=metadataKeyPair,this.setState({activeMetadataKeys,metadataKeysInfo,settings:this.formSettings.toDto()})}catch(error){await this.handleUnexpectedError(error)}this.setState({isProcessing:!1})}handleFormSubmit(event){event.preventDefault(),this.save()}async save(){if(this.state.isProcessing)return;this.setState({isProcessing:!0});const validationError=this.validateForm(this.state.settings);if(validationError?.hasErrors())this.setState({isProcessing:!1,hasAlreadyBeenValidated:!0});else{try{await this.saveMetadataKeysSettings(),await this.createMetadataKey(),await this.props.actionFeedbackContext.displaySuccess(this.props.t("The metadata key settings were updated."))}catch(error){await this.handleUnexpectedError(error)}this.setState({isProcessing:!1,settings:this.formSettings.toDto()})}}validateForm=(0,memoize_one_esm.A)((formSettingsDto=>{if(!this.formSettings)return null;let validationErrors=this.formSettings.validate();return this.state.activeMetadataKeys.length||(validationErrors=validationErrors||new entityValidationError.A,validationErrors.addError("generated_metadata_key","required",this.props.t("A shared metadata key is required."))),validationErrors}));async saveMetadataKeysSettings(){const metadataKeysSettings=new metadataKeysSettingsEntity.A(this.formSettings.toDto()),savedMetadataKeysSettings=await this.metadataSettingsServiceWorkerService.saveKeysSettings(metadataKeysSettings);this.originalSettings=new metadataKeysSettingsFormEntity({...this.originalSettings.toDto(),...savedMetadataKeysSettings.toDto()}),this.formSettings=new metadataKeysSettingsFormEntity({...this.formSettings.toDto(),...savedMetadataKeysSettings.toDto()})}async createMetadataKey(){if(!this.formSettings.generatedMetadataKey)return;const metadataKey=await this.metadataKeysServiceWorkerService.createKey(this.formSettings.generatedMetadataKey);this.state.activeMetadataKeys.pushOrReplace(metadataKey,{},{replacePropertyName:"fingerprint"}),this.formSettings.generatedMetadataKey=null}render(){const errors=this.state.hasAlreadyBeenValidated?this.validateForm(this.state.settings):null,hasSettingsChanges=this.hasSettingsChanges(this.originalSettings,this.formSettings,this.state.settings);return react.createElement("div",{className:"row"},react.createElement("div",{id:"content-types-metadata-key-settings",className:"main-column"},react.createElement("div",{className:"main-content"},react.createElement("form",{onSubmit:this.handleFormSubmit,"data-testid":"submit-form"},react.createElement("h3",{className:"title"},react.createElement("label",null,react.createElement(es.x6,null,"Metadata key"))),react.createElement("p",{className:"description"},react.createElement(es.x6,null,"This section controls the layer of encryption that is used to protect metadata such as the name of a resource, URIs, etc.")),react.createElement("h4",{className:"no-border"},react.createElement(es.x6,null,"Metadata key policy")),react.createElement("p",{className:"description"},react.createElement(es.x6,null,"It is possible for users to use their personal keys to encrypt resources metadata for more security. However you can elect to enforce the use of the shared metadata keys for all resources metadata for auditing purposes. Secrets such as passwords will always be encrypted using the user personal keys.")),react.createElement("div",{className:"radiolist-alt"},react.createElement("div",{className:"input radio "+(!0===this.state.settings.allow_usage_of_personal_keys?"checked":"")},react.createElement("input",{type:"radio",value:"true",onChange:this.handleInputChange,name:"allow_usage_of_personal_keys",checked:!0===this.state.settings.allow_usage_of_personal_keys,id:"allowUsageOfPersonalKeysInput",disabled:this.hasAllInputDisabled()}),react.createElement("label",{htmlFor:"allowUsageOfPersonalKeysInput"},react.createElement("span",{className:"name"},react.createElement(es.x6,null,"Allow the use of personal keys. (Recommended)")),react.createElement("span",{className:"info"},react.createElement(es.x6,null,"Users can use shared and personal keys. By default personal resources that are not shared will be encrypted with the users personal keys."),react.createElement("br",null)))),react.createElement("div",{className:"input radio "+(!1===this.state.settings.allow_usage_of_personal_keys?"checked":"")},react.createElement("input",{type:"radio",value:"false",onChange:this.handleInputChange,name:"allow_usage_of_personal_keys",checked:!1===this.state.settings.allow_usage_of_personal_keys,id:"disallowUsageOfPersonalKeysInput",disabled:this.hasAllInputDisabled()}),react.createElement("label",{htmlFor:"disallowUsageOfPersonalKeysInput"},react.createElement("span",{className:"name"},react.createElement(es.x6,null,"Enforce the use of shared metadata keys.")),react.createElement("span",{className:"info"},react.createElement(es.x6,null,"By default, metadata wil be encrypted with the shared keys. It is not possible to use personal keys to encrypt metadata."),react.createElement("br",null))))),react.createElement("h4",null,react.createElement(es.x6,null,"Zero knowledge (Coming soon)")),react.createElement("p",{className:"description"},react.createElement(es.x6,null,"This section defines how the shared metadata key is shared with users.")),react.createElement("div",{className:"radiolist-alt"},react.createElement("div",{className:"input radio no-hover "+(!1===this.state.settings.zero_knowledge_key_share?"checked":"")},react.createElement("input",{type:"radio",value:"true",name:"zero_knowledge_key_share",checked:!1===this.state.settings.zero_knowledge_key_share,id:"disableZeroKnowledgeKeyShareInput",disabled:!0}),react.createElement("label",{htmlFor:"disableZeroKnowledgeKeyShareInput"},react.createElement("span",{className:"name"},react.createElement(es.x6,null,"User-friendly mode (Better on-boarding)")),react.createElement("span",{className:"info"},react.createElement(es.x6,null,"The shared metadata key is accessible to the server and can be shared by the server when a user completes the setup. In practice, an attacker with full server access can see the shared metadata."),react.createElement("br",null)))),react.createElement("div",{className:"input radio no-hover "+(!0===this.state.settings.zero_knowledge_key_share?"checked":"")},react.createElement("input",{type:"radio",value:"true",name:"zero_knowledge_key_share",checked:!0===this.state.settings.zero_knowledge_key_share,id:"enableZeroKnowledgeKeyShareInput",disabled:!0}),react.createElement("label",{htmlFor:"enableZeroKnowledgeKeyShareInput"},react.createElement("span",{className:"name"},react.createElement(es.x6,null,"Zero-knowledge mode (More secure)")),react.createElement("span",{className:"info"},react.createElement(es.x6,null,"The shared metadata key is not available to the server and must be shared with users by the admins. New users are not allowed to create or access shared content until they are provided the metadata key. It is recommended to rotate the key if you switch to that mode."),react.createElement("br",null))))),react.createElement("h4",null,react.createElement(es.x6,null,"Shared metadata keys")),react.createElement("div",{className:`metadata-key-info ${errors?.hasError("generated_metadata_key","required")&&"error"}`},this.state.activeMetadataKeys?.length>0&&react.createElement("div",{id:"metadata-active-keys"},this.state.activeMetadataKeys?.items.map((metadataKey=>{const metadataKeyInfo=this.state.metadataKeysInfo?.getFirst("fingerprint",metadataKey.fingerprint);return react.createElement("table",{key:metadataKey.fingerprint,className:"table-info"},react.createElement("tbody",null,react.createElement("tr",{className:"fingerprint"},react.createElement("td",{className:"label"},react.createElement(es.x6,null,"Fingerprint")),react.createElement("td",{className:"value"},react.createElement(Fingerprint.A,{fingerprint:metadataKey.fingerprint}))),react.createElement("tr",{className:"algorithm"},react.createElement("td",{className:"label"},react.createElement(es.x6,null,"Algorithm")),react.createElement("td",{className:"value"},metadataKeyInfo?.algorithm," ",metadataKeyInfo?.curve)),react.createElement("tr",{className:"key-length"},react.createElement("td",{className:"label"},react.createElement(es.x6,null,"Key length")),react.createElement("td",{className:"value"},metadataKeyInfo?.length)),react.createElement("tr",{className:"created"},react.createElement("td",{className:"label"},react.createElement(es.x6,null,"Created")),metadataKey.created&&react.createElement("td",{className:"value"},react.createElement("span",{title:metadataKey.created},(0,dateUtils.kD)(metadataKey.created,this.props.t,this.props.context.locale))),!metadataKey.created&&react.createElement("td",{className:"empty-value"},react.createElement(es.x6,null,"Pending")))))}))),!this.state.activeMetadataKeys?.length&&react.createElement("div",{id:"no-metadata-active-keys"},react.createElement("table",{className:"table-info"},react.createElement("tbody",null,react.createElement("tr",null,react.createElement("td",{className:"empty-value"},react.createElement(es.x6,null,"You need to generate a new shared key to enable encrypted metadata.")),react.createElement("td",{className:"table-button"},react.createElement("button",{className:"button primary medium",type:"button",disabled:this.hasAllInputDisabled(),onClick:this.generateMetadataKey,"data-testid":"generate-key-buton"},react.createElement(es.x6,null,"Generate key")))),errors?.hasError("generated_metadata_key","required")&&react.createElement("tr",{className:"error-message"},react.createElement(es.x6,null,"A shared metadata key is required."))))),this.state.expiredMetadataKeys?.length>0&&react.createElement(react.Fragment,null,react.createElement("h4",null,react.createElement(es.x6,null,"Previous keys")),react.createElement("div",{id:"metadata-expired-keys"},this.state.expiredMetadataKeys?.items.map((metadataKey=>{const metadataKeyInfo=this.state.metadataKeysInfo.getFirst("fingerprint",metadataKey.fingerprint);return react.createElement("table",{key:metadataKey.fingerprint,className:"table-info"},react.createElement("tbody",null,react.createElement("tr",{className:"fingerprint"},react.createElement("td",{className:"label"},react.createElement(es.x6,null,"Fingerprint")),react.createElement("td",{className:"value"},react.createElement(Fingerprint.A,{fingerprint:metadataKey.fingerprint}))),react.createElement("tr",{className:"algorithm"},react.createElement("td",{className:"label"},react.createElement(es.x6,null,"Algorithm")),react.createElement("td",{className:"value"},metadataKeyInfo?.algorithm," ",metadataKeyInfo?.curve)),react.createElement("tr",{className:"key-length"},react.createElement("td",{className:"label"},react.createElement(es.x6,null,"Key length")),react.createElement("td",{className:"value"},metadataKeyInfo?.length)),react.createElement("tr",{className:"created"},react.createElement("td",{className:"label"},react.createElement(es.x6,null,"Created")),react.createElement("td",{className:"value"},react.createElement("span",{title:metadataKey.created},(0,dateUtils.kD)(metadataKey.created,this.props.t,this.props.context.locale)))),react.createElement("tr",{className:"expired"},react.createElement("td",{className:"label"},react.createElement(es.x6,null,"Expired")),react.createElement("td",{className:"value"},react.createElement("span",{title:metadataKey.expired},(0,dateUtils.kD)(metadataKey.expired,this.props.t,this.props.context.locale))))))}))))))),hasSettingsChanges&&react.createElement("div",{className:"warning message form-banner"},react.createElement("div",null,react.createElement("p",null,react.createElement(es.x6,null,"Don't forget to save your settings to apply your modification.")))),errors?.hasError("generated_metadata_key","required")&&react.createElement("div",{className:"warning message form-banner"},react.createElement("div",null,react.createElement("p",null,react.createElement(es.x6,null,"A shared metadata key is required to save the metadata keys settings."))))),react.createElement(DisplayContentTypesMetadataKeyAdministrationActions,{onSaveRequested:this.save,isProcessing:this.state.isProcessing}),(0,portals.m)(react.createElement("div",{className:"sidebar-help-section"},react.createElement("h3",null,react.createElement(es.x6,null,"Need help?")),react.createElement("p",null,react.createElement(es.x6,null,"For more information about the content type support and migration, checkout the dedicated page on the official website.")),react.createElement("a",{className:"button",target:"_blank",rel:"noopener noreferrer",href:"https://passbolt.com/docs"},react.createElement(file_text.A,null),react.createElement("span",null,react.createElement(es.x6,null,"Read the documentation")))),document.getElementById("administration-help-panel")))}}DisplayContentTypesMetadataKeyAdministration_DisplayContentTypesMetadataKeyAdministration.propTypes={context:prop_types_default().object,actionFeedbackContext:prop_types_default().object,dialogContext:prop_types_default().object,createPortal:prop_types_default().func,metadataSettingsServiceWorkerService:prop_types_default().object,metadataKeysServiceWorkerService:prop_types_default().object,gpgServiceWorkerService:prop_types_default().object,t:prop_types_default().func};const Administration_DisplayContentTypesMetadataKeyAdministration_DisplayContentTypesMetadataKeyAdministration=(0,AppContext.L)((0,DialogContext.z9)((0,ActionFeedbackContext.ot)((0,es.CI)("common")(DisplayContentTypesMetadataKeyAdministration_DisplayContentTypesMetadataKeyAdministration))));DisplayContentTypesMetadataKeyAdministration_DisplayContentTypesMetadataKeyAdministration.__docgenInfo={description:"",methods:[{name:"defaultState",docblock:"Get default state\n@returns {Object}",modifiers:["get"],params:[],returns:{type:{name:"Object"}},description:"Get default state"},{name:"bindCallbacks",docblock:"Bind callbacks methods",modifiers:[],params:[],returns:null,description:"Bind callbacks methods"},{name:"loadKeysSettings",docblock:"Load the metadata key settings.\nIf the settings cannot be loaded, display the error dialog.\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Load the metadata key settings.\nIf the settings cannot be loaded, display the error dialog."},{name:"handleUnexpectedError",docblock:"Handle unexpected error\n@param {Error} error The error\n@returns {Promise<string>} Return the dialog key identifier.",modifiers:[],params:[{name:"error",description:"The error",type:{name:"Error"},optional:!1}],returns:{description:"Return the dialog key identifier.",type:{name:"Promise",elements:[{name:"string"}]}},description:"Handle unexpected error"},{name:"loadKeys",docblock:"Load the metadata keys.\nIf the metadata keys cannot be loaded, display the error dialog.\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Load the metadata keys.\nIf the metadata keys cannot be loaded, display the error dialog."},{name:"handleInputChange",docblock:"Handle form input changes.\n@params {ReactEvent} The react event\n@returns {void}",modifiers:[],params:[{name:"event",optional:!1}],returns:{type:{name:"void"}},description:"Handle form input changes."},{name:"setFormPropertyValue",docblock:"Set a form property value. Trigger the validation if the form has already been submitted once.\n@param name\n@param parsedValue",modifiers:[],params:[{name:"name",optional:!1},{name:"parsedValue",optional:!1}],returns:null,description:"Set a form property value. Trigger the validation if the form has already been submitted once."},{name:"hasAllInputDisabled",docblock:"Should input be disabled? True if state is loading or processing\n@returns {boolean}",modifiers:[],params:[],returns:{type:{name:"boolean"}},description:"Should input be disabled? True if state is loading or processing"},{name:"generateMetadataKey",docblock:"Generate a new metadata key\n@return {Promise}",modifiers:["async"],params:[],returns:{type:{name:"Promise"}},description:"Generate a new metadata key"},{name:"handleFormSubmit",docblock:"Handle form submission that can be trigger when hitting `enter`\n@param {Event} event The html event triggering the form submit.",modifiers:[],params:[{name:"event",description:"The html event triggering the form submit.",type:{name:"Event"},optional:!1}],returns:null,description:"Handle form submission that can be trigger when hitting `enter`"},{name:"save",docblock:"Save the settings.\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Save the settings."},{name:"saveMetadataKeysSettings",docblock:"Save the metadata keys settings.\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Save the metadata keys settings."},{name:"createMetadataKey",docblock:"Create the metadata key.\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Create the metadata key."}],displayName:"DisplayContentTypesMetadataKeyAdministration",props:{context:{description:"",type:{name:"object"},required:!1},actionFeedbackContext:{description:"",type:{name:"object"},required:!1},dialogContext:{description:"",type:{name:"object"},required:!1},createPortal:{description:"",type:{name:"func"},required:!1},metadataSettingsServiceWorkerService:{description:"",type:{name:"object"},required:!1},metadataKeysServiceWorkerService:{description:"",type:{name:"object"},required:!1},gpgServiceWorkerService:{description:"",type:{name:"object"},required:!1},t:{description:"",type:{name:"func"},required:!1}}}},"./src/react-extension/components/Common/Fingerprint/Fingerprint.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);class Fingerprint extends react__WEBPACK_IMPORTED_MODULE_0__.Component{render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"fingerprint"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"fingerprint-line"},this.props.fingerprint?.substring(0,20)?.replace(/.{4}/g,"$& ")),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"fingerprint-line"},this.props.fingerprint?.substring(20)?.replace(/.{4}/g,"$& ")))}}Fingerprint.propTypes={fingerprint:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string.isRequired};const __WEBPACK_DEFAULT_EXPORT__=Fingerprint;Fingerprint.__docgenInfo={description:"",methods:[],displayName:"Fingerprint",props:{fingerprint:{description:"",type:{name:"string"},required:!0}}}},"./src/react-extension/contexts/ActionFeedbackContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ay:()=>ActionFeedbackContextProvider,b_:()=>ActionFeedbackContext,ot:()=>withActionFeedback});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__),uuid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js");const ActionFeedbackContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext({feedbacks:[],displaySuccess:()=>{},displayWarning:()=>{},displayError:()=>{},remove:()=>{}});class ActionFeedbackContextProvider extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.defaultState}get defaultState(){return{feedbacks:[],displaySuccess:this.displaySuccess.bind(this),displayWarning:this.displayWarning.bind(this),displayError:this.displayError.bind(this),remove:this.remove.bind(this)}}displaySuccess(feedbackToAdd){this.setState({feedbacks:[...this.state.feedbacks,{id:(0,uuid__WEBPACK_IMPORTED_MODULE_1__.A)(),type:"success",message:feedbackToAdd}]})}displayWarning(feedbackToAdd){this.setState({feedbacks:[...this.state.feedbacks,{id:(0,uuid__WEBPACK_IMPORTED_MODULE_1__.A)(),type:"warning",message:feedbackToAdd}]})}displayError(feedbackToAdd){this.setState({feedbacks:[...this.state.feedbacks,{id:(0,uuid__WEBPACK_IMPORTED_MODULE_1__.A)(),type:"error",message:feedbackToAdd}]})}remove(feedbackToRemove){this.setState({feedbacks:this.state.feedbacks.filter((feedback=>feedbackToRemove.id!==feedback.id))})}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(ActionFeedbackContext.Provider,{value:this.state},this.props.children)}}function withActionFeedback(WrappedComponent){return class WithActionFeedback extends react__WEBPACK_IMPORTED_MODULE_0__.Component{render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(ActionFeedbackContext.Consumer,null,(actionFeedbackContext=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(WrappedComponent,{actionFeedbackContext,...this.props})))}}}ActionFeedbackContextProvider.displayName="ActionFeedbackContextProvider",ActionFeedbackContextProvider.propTypes={children:prop_types__WEBPACK_IMPORTED_MODULE_2___default().any},ActionFeedbackContextProvider.__docgenInfo={description:"The related context provider",methods:[{name:"defaultState",docblock:"Returns the default component state",modifiers:["get"],params:[],returns:null,description:"Returns the default component state"},{name:"displaySuccess",docblock:"Display the feedback in a success mode\n@param feedbackToAdd A feedback",modifiers:[],params:[{name:"feedbackToAdd",description:"A feedback",optional:!1}],returns:null,description:"Display the feedback in a success mode"},{name:"displayWarning",docblock:"Display the feedback in a warning mode\n@param feedbackToAdd A feedback",modifiers:[],params:[{name:"feedbackToAdd",description:"A feedback",optional:!1}],returns:null,description:"Display the feedback in a warning mode"},{name:"displayError",docblock:"Display the feedback in a error mode\n@param feedbackToAdd A feedback",modifiers:[],params:[{name:"feedbackToAdd",description:"A feedback",optional:!1}],returns:null,description:"Display the feedback in a error mode"},{name:"remove",docblock:"Remove the feedback\n@param feedbackToRemove A feedback",modifiers:[],params:[{name:"feedbackToRemove",description:"A feedback",optional:!1}],returns:null,description:"Remove the feedback"}],displayName:"ActionFeedbackContextProvider",props:{children:{description:"",type:{name:"any"},required:!1}}}},"./src/react-extension/contexts/ActionFeedbackContext.test.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function defaultActionFeedbackContext(data={}){const defaultContext={displaySuccess:jest.fn(),displayError:jest.fn(),remove:jest.fn()};return Object.assign(defaultContext,data)}__webpack_require__.d(__webpack_exports__,{M:()=>defaultActionFeedbackContext})},"./src/react-extension/contexts/DialogContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ay:()=>DialogContextProvider,z9:()=>withDialog});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__),uuid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js");const DialogContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext({dialogs:[],open:()=>{},close:()=>{}});class DialogContextProvider extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.defaultState}get defaultState(){return{dialogs:[],open:(Dialog,DialogProps)=>{const dialogKey=(0,uuid__WEBPACK_IMPORTED_MODULE_1__.A)();return this.setState({dialogs:[...this.state.dialogs,{key:dialogKey,Dialog,DialogProps}]}),dialogKey},close:dialogKey=>this.setState({dialogs:this.state.dialogs.filter((dialog=>dialogKey!==dialog.key))}),closeAll:()=>this.setState({dialogs:[]})}}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DialogContext.Provider,{value:this.state},this.props.children)}}function withDialog(WrappedComponent){return class WithDialog extends react__WEBPACK_IMPORTED_MODULE_0__.Component{render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(DialogContext.Consumer,null,(dialogContext=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(WrappedComponent,{dialogContext,...this.props})))}}}DialogContextProvider.displayName="DialogContextProvider",DialogContextProvider.propTypes={children:prop_types__WEBPACK_IMPORTED_MODULE_2___default().any},DialogContextProvider.__docgenInfo={description:"The related context provider",methods:[{name:"defaultState",docblock:"Returns the default component state",modifiers:["get"],params:[],returns:null,description:"Returns the default component state"}],displayName:"DialogContextProvider",props:{children:{description:"",type:{name:"any"},required:!1}}}},"./src/react-extension/contexts/DialogContext.test.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function defaultDialogContext(context={}){const defaultContext={dialogs:[],open:jest.fn(),close:jest.fn(),closeAll:jest.fn()};return Object.assign(defaultContext,context)}__webpack_require__.d(__webpack_exports__,{L:()=>defaultDialogContext})},"./src/shared/models/entity/gpgkey/externalGpgKeyCollection.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _externalGpgKeyEntity__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/models/entity/gpgkey/externalGpgKeyEntity.js"),_abstract_entityCollection__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/shared/models/entity/abstract/entityCollection.js"),_abstract_entitySchema__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/shared/models/entity/abstract/entitySchema.js"),_abstract_entityCollectionError__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/shared/models/entity/abstract/entityCollectionError.js");class ExternalGpgKeyCollection extends _abstract_entityCollection__WEBPACK_IMPORTED_MODULE_1__.A{constructor(externalGpgKeyCollectionDto,options={}){super(_abstract_entitySchema__WEBPACK_IMPORTED_MODULE_2__.A.validate(ExternalGpgKeyCollection.ENTITY_NAME,externalGpgKeyCollectionDto,ExternalGpgKeyCollection.getSchema()),options);this._props.map((resource=>resource.id)).sort().sort(((a,b)=>{if(a===b)throw new _abstract_entityCollectionError__WEBPACK_IMPORTED_MODULE_3__.A(0,ExternalGpgKeyCollection.RULE_UNIQUE_ID,`Gpgkey fingerprint ${a} already exists.`)})),this._props.forEach((resource=>{this._items.push(new _externalGpgKeyEntity__WEBPACK_IMPORTED_MODULE_0__.A(resource,{clone:!1}))})),this._props=null}static getSchema(){return{type:"array",items:_externalGpgKeyEntity__WEBPACK_IMPORTED_MODULE_0__.A.getSchema()}}static get ENTITY_NAME(){return"externalGpgKey"}static get RULE_UNIQUE_ID(){return"fingerprint"}}const __WEBPACK_DEFAULT_EXPORT__=ExternalGpgKeyCollection},"./src/shared/models/entity/gpgkey/externalGpgKeyEntity.test.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Sm:()=>caroleExternalPublicGpgKeyEntityDto,Zm:()=>ed25519ExternalPrivateGpgKeyEntityDto,he:()=>ed25519ExternalPublicGpgKeyEntityDto,sE:()=>bettyExternalPublicGpgKeyEntityDto,w9:()=>adaExternalPrivateGpgKeyEntityDto});var _test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./test/fixture/pgpKeys/keys.js");const adaExternalPrivateGpgKeyEntityDto=(data={})=>{const defaultData={armored_key:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.ada.private,key_id:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.ada.key_id,user_ids:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.ada.user_ids,fingerprint:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.ada.fingerprint,expires:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.ada.expires,created:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.ada.created,algorithm:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.ada.algorithm.toLowerCase(),length:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.ada.length,curve:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.ada.curve,private:!0,revoked:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.ada.revoked};return Object.assign(defaultData,data)},bettyExternalPublicGpgKeyEntityDto=(data={})=>{const defaultData={armored_key:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.betty.public,key_id:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.betty.key_id,user_ids:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.betty.user_ids,fingerprint:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.betty.fingerprint,expires:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.betty.expires,created:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.betty.created,algorithm:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.betty.algorithm?.toLowerCase(),length:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.betty.length,curve:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.betty.curve,private:!1,revoked:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.betty.revoked};return Object.assign(defaultData,data)},caroleExternalPublicGpgKeyEntityDto=(data={})=>{const defaultData={armored_key:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.carol.public,key_id:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.carol.key_id,user_ids:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.carol.user_ids,fingerprint:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.carol.fingerprint,expires:"Infinity",created:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.carol.created,algorithm:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.carol.algorithm?.toLowerCase(),length:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.carol.length,curve:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.carol.curve,private:!1,revoked:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.carol.revoked};return Object.assign(defaultData,data)},ed25519ExternalPublicGpgKeyEntityDto=(data={})=>{const defaultData={armored_key:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.public,key_id:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.key_id,user_ids:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.user_ids,fingerprint:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.fingerprint,expires:"Infinity",created:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.created,algorithm:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.algorithm?.toLowerCase(),length:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.length,curve:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.curve,private:!1,revoked:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.revoked};return Object.assign(defaultData,data)},ed25519ExternalPrivateGpgKeyEntityDto=(data={})=>{const defaultData={armored_key:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.private,key_id:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.key_id,user_ids:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.user_ids,fingerprint:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.fingerprint,expires:"Infinity",created:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.created,algorithm:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.algorithm?.toLowerCase(),length:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.length,curve:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.curve,private:!0,revoked:_test_fixture_pgpKeys_keys__WEBPACK_IMPORTED_MODULE_0__.u.eddsa_ed25519.revoked};return Object.assign(defaultData,data)}},"./src/shared/models/entity/metadata/metadataKeysSettingsEntity.test.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{L:()=>defaultMetadataKeysSettingsDto});const defaultMetadataKeysSettingsDto=(data={})=>Object.assign({allow_usage_of_personal_keys:!0,zero_knowledge_key_share:!1},data)},"./src/shared/models/entity/resourceType/resourceTypeEntity.test.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$z:()=>TEST_RESOURCE_TYPE_V5_PASSWORD_STRING,Av:()=>TEST_RESOURCE_TYPE_PASSWORD_DESCRIPTION_TOTP,Bt:()=>TEST_RESOURCE_TYPE_PASSWORD_STRING,G6:()=>resourceTypePasswordDescriptionTotpDto,G9:()=>resourceTypeV5DefaultDto,J6:()=>TEST_RESOURCE_TYPE_V5_DEFAULT_TOTP,KD:()=>resourceTypePasswordAndDescriptionDto,Lt:()=>resourceTypeTotpDto,Tl:()=>resourceTypeV5PasswordStringDto,Vv:()=>TEST_RESOURCE_TYPE_V5_DEFAULT,Xq:()=>TEST_RESOURCE_TYPE_V5_TOTP,m$:()=>resourceTypePasswordStringDto,mF:()=>resourceTypeV5TotpDto,s_:()=>TEST_RESOURCE_TYPE_PASSWORD_AND_DESCRIPTION,tS:()=>resourceTypeV5DefaultTotpDto,vD:()=>TEST_RESOURCE_TYPE_TOTP});var uuid__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js");const TEST_RESOURCE_TYPE_PASSWORD_STRING=(0,uuid__WEBPACK_IMPORTED_MODULE_0__.A)(),TEST_RESOURCE_TYPE_PASSWORD_AND_DESCRIPTION=(0,uuid__WEBPACK_IMPORTED_MODULE_0__.A)(),TEST_RESOURCE_TYPE_PASSWORD_DESCRIPTION_TOTP=(0,uuid__WEBPACK_IMPORTED_MODULE_0__.A)(),TEST_RESOURCE_TYPE_TOTP=(0,uuid__WEBPACK_IMPORTED_MODULE_0__.A)(),TEST_RESOURCE_TYPE_V5_DEFAULT=(0,uuid__WEBPACK_IMPORTED_MODULE_0__.A)(),TEST_RESOURCE_TYPE_V5_PASSWORD_STRING=(0,uuid__WEBPACK_IMPORTED_MODULE_0__.A)(),TEST_RESOURCE_TYPE_V5_DEFAULT_TOTP=(0,uuid__WEBPACK_IMPORTED_MODULE_0__.A)(),TEST_RESOURCE_TYPE_V5_TOTP=(0,uuid__WEBPACK_IMPORTED_MODULE_0__.A)(),resourceTypePasswordStringDto=(data={})=>({id:TEST_RESOURCE_TYPE_PASSWORD_STRING,name:"Simple password",slug:"password-string",definition:{resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},username:{type:"string",maxLength:255,nullable:!0},uri:{type:"string",maxLength:1024,nullable:!0},description:{type:"string",maxLength:1e4,nullable:!0}}},secret:{type:"string",maxLength:4096}},...data}),resourceTypePasswordAndDescriptionDto=(data={})=>({id:TEST_RESOURCE_TYPE_PASSWORD_AND_DESCRIPTION,name:"Password with description",slug:"password-and-description",definition:{resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},username:{type:"string",maxLength:255,nullable:!0},uri:{type:"string",maxLength:1024,nullable:!0}}},secret:{type:"object",required:["password"],properties:{password:{type:"string",maxLength:4096},description:{type:"string",maxLength:1e4,nullable:!0}}}},...data}),resourceTypePasswordDescriptionTotpDto=(data={})=>({id:TEST_RESOURCE_TYPE_PASSWORD_DESCRIPTION_TOTP,name:"Password, Description and TOTP",slug:"password-description-totp",definition:{resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},username:{type:"string",maxLength:255,nullable:!0},uri:{type:"string",maxLength:1024,nullable:!0}}},secret:{type:"object",required:["password","totp"],properties:{password:{type:"string",maxLength:4096},description:{type:"string",maxLength:1e4,nullable:!0},totp:{type:"object",required:["secret_key","digits","algorithm"],properties:{algorithm:{type:"string",minLength:4,maxLength:6},secret_key:{type:"string",maxLength:1024},digits:{type:"number",minimum:6,maximum:8},period:{type:"number"}}}}}},...data}),resourceTypeTotpDto=(data={})=>({id:TEST_RESOURCE_TYPE_TOTP,name:"Standalone TOTP",slug:"totp",definition:{resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},uri:{type:"string",maxLength:1024,nullable:!0}}},secret:{type:"object",required:["totp"],properties:{totp:{type:"object",required:["secret_key","digits","algorithm"],properties:{algorithm:{type:"string",minLength:4,maxLength:6},secret_key:{type:"string",maxLength:1024},digits:{type:"number",minimum:6,maximum:8},period:{type:"number"}}}}}},...data}),resourceTypeV5DefaultDto=(data={})=>({id:TEST_RESOURCE_TYPE_V5_DEFAULT,name:"V5 Default",slug:"v5-default",definition:{resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},username:{type:"string",maxLength:255,nullable:!0},uris:{type:"array",items:{type:"string",maxLength:1024,nullable:!0}},description:{type:"string",maxLength:1e4,nullable:!0}}},secret:{type:"object",required:["password"],properties:{object_type:{type:"string",enum:["PASSBOLT_SECRET_DATA"]},password:{type:"string",maxLength:4096,nullable:!0},description:{type:"string",maxLength:1e4,nullable:!0}}}},...data}),resourceTypeV5PasswordStringDto=(data={})=>({id:TEST_RESOURCE_TYPE_V5_PASSWORD_STRING,name:"V5 Password",slug:"v5-password-string",definition:{resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},username:{type:"string",maxLength:255,nullable:!0},uris:{type:"array",items:{type:"string",maxLength:1024,nullable:!0}},description:{type:"string",maxLength:1e4,nullable:!0}}},secret:{type:"string",maxLength:4096}},...data}),resourceTypeV5DefaultTotpDto=(data={})=>({id:TEST_RESOURCE_TYPE_V5_DEFAULT_TOTP,name:"V5 Default with TOTP",slug:"v5-default-with-totp",definition:{resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},username:{type:"string",maxLength:255,nullable:!0},uris:{type:"array",items:{type:"string",maxLength:1024,nullable:!0}},description:{type:"string",maxLength:1e4,nullable:!0}}},secret:{type:"object",required:["password","totp"],properties:{object_type:{type:"string",enum:["PASSBOLT_SECRET_DATA"]},password:{type:"string",maxLength:4096,nullable:!0},description:{type:"string",maxLength:1e4,nullable:!0},totp:{type:"object",required:["secret_key","digits","algorithm"],properties:{algorithm:{type:"string",minLength:4,maxLength:6},secret_key:{type:"string",maxLength:1024},digits:{type:"number",minimum:6,maximum:8},period:{type:"number"}}}}}},...data}),resourceTypeV5TotpDto=(data={})=>({id:TEST_RESOURCE_TYPE_V5_TOTP,name:"V5 Standalone TOTP",slug:"v5-totp-standalone",definition:{resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},uris:{type:"array",items:{type:"string",maxLength:1024,nullable:!0}},description:{type:"string",maxLength:1e4,nullable:!0}}},secret:{type:"object",required:["totp"],properties:{object_type:{type:"string",enum:["PASSBOLT_SECRET_DATA"]},totp:{type:"object",required:["secret_key","digits","algorithm"],properties:{algorithm:{type:"string",minLength:4,maxLength:6},secret_key:{type:"string",maxLength:1024},digits:{type:"number",minimum:6,maximum:8},period:{type:"number"}}}}}},...data})},"./src/shared/models/entity/resourceType/resourceTypesCollection.test.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{V1:()=>resourceTypesCollectionDto,XB:()=>resourceTypesV4CollectionDto,Yd:()=>resourceTypesV5CollectionDto});var _resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/models/entity/resourceType/resourceTypeEntity.test.data.js");const resourceTypesCollectionDto=()=>[(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.m$)(),(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.KD)(),(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.G6)(),(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.Lt)(),(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.G9)(),(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.Tl)(),(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.tS)(),(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.mF)()],resourceTypesV4CollectionDto=()=>[(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.m$)(),(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.KD)(),(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.G6)(),(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.Lt)()],resourceTypesV5CollectionDto=()=>[(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.G9)(),(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.Tl)(),(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.tS)(),(0,_resourceTypeEntity_test_data__WEBPACK_IMPORTED_MODULE_0__.mF)()]},"./src/shared/utils/dateUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{B7:()=>formatDateForApi,Br:()=>formatExpirationDateTimeAgo,kD:()=>formatDateTimeAgo});var luxon__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/luxon/src/luxon.js");const formatDateTimeAgo=(date,translate,locale)=>{if(null===date)return"n/a";if("Infinity"===date)return translate("Never");const dateTime=luxon__WEBPACK_IMPORTED_MODULE_0__.c9.fromISO(date),duration=dateTime.diffNow().toMillis();return duration>-1e3&&duration<0?translate("Just now"):dateTime.toRelative({locale})},formatExpirationDateTimeAgo=(date,translate,locale)=>date?formatDateTimeAgo(date,translate,locale):translate("Never"),formatDateForApi=date=>date?.toUTC().toISO()||null},"?4f7e":()=>{}}]);