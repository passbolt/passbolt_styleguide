/*! For license information please see 7924.18b28aca.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkpassbolt_styleguide=self.webpackChunkpassbolt_styleguide||[]).push([[7924],{"./src/react-extension/components/Common/Tab/Tab.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);class Tab extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.bindCallback()}bindCallback(){this.handleClick=this.handleClick.bind(this)}handleClick(){this.props.onClick(this.props.name)}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("li",{className:"tab "+(this.props.isActive?"active":"")},react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{type:"button",className:"tab-link",onClick:this.handleClick},this.props.name))}}Tab.propTypes={name:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,type:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string.isRequired,isActive:prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool,onClick:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func,children:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any};const __WEBPACK_DEFAULT_EXPORT__=Tab;Tab.__docgenInfo={description:"Display of the Tab component",methods:[{name:"bindCallback",docblock:"Bind class methods callback",modifiers:[],params:[],returns:null,description:"Bind class methods callback"},{name:"handleClick",docblock:"Handle click\n@param event",modifiers:[],params:[],returns:null,description:"Handle click"}],displayName:"Tab",props:{name:{description:"",type:{name:"string"},required:!1},type:{description:"",type:{name:"string"},required:!0},isActive:{description:"",type:{name:"bool"},required:!1},onClick:{description:"",type:{name:"func"},required:!1},children:{description:"",type:{name:"any"},required:!1}}}},"./src/react-extension/components/Common/Tab/Tabs.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__),_Tab__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/react-extension/components/Common/Tab/Tab.js");class Tabs extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.getDefaultState(props),this.bindCallback()}getDefaultState(props){return{activeTabName:props.activeTabName}}bindCallback(){this.handleTabClick=this.handleTabClick.bind(this)}handleTabClick(tabItem){this.setState({activeTabName:tabItem.type}),"function"==typeof tabItem.onClick&&tabItem.onClick()}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"tabs"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("ul",{className:"tabs-nav"},this.props.children.map((({key,props})=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Tab__WEBPACK_IMPORTED_MODULE_1__.A,{key,name:props.name,type:props.type,onClick:()=>this.handleTabClick(props),isActive:props.type===this.state.activeTabName})))),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"tabs-active-content"},this.props.children.find((tab=>tab.props.type===this.state.activeTabName)).props.children))}}Tabs.propTypes={activeTabName:prop_types__WEBPACK_IMPORTED_MODULE_2___default().string,children:prop_types__WEBPACK_IMPORTED_MODULE_2___default().any};const __WEBPACK_DEFAULT_EXPORT__=Tabs;Tabs.__docgenInfo={description:"Tabs component to handle the display of selected tab",methods:[{name:"getDefaultState",docblock:"Default state\n@param props Component props",modifiers:[],params:[{name:"props",description:"Component props",optional:!1}],returns:null,description:"Default state"},{name:"bindCallback",docblock:"Bind class methods callback",modifiers:[],params:[],returns:null,description:"Bind class methods callback"},{name:"handleTabClick",docblock:"Toggle currently active tab\n@param tabItem The item which represents the tab",modifiers:[],params:[{name:"tabItem",description:"The item which represents the tab",optional:!1}],returns:null,description:"Toggle currently active tab"}],displayName:"Tabs",props:{activeTabName:{description:"",type:{name:"string"},required:!1},children:{description:"",type:{name:"any"},required:!1}}}},"./src/shared/models/entity/resource/resourceFormEntity.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>resourceFormEntity});var assertString=__webpack_require__("./node_modules/validator/es/lib/util/assertString.js"),ResourceEditCreateFormEnumerationTypes=__webpack_require__("./src/shared/models/resource/ResourceEditCreateFormEnumerationTypes.js"),entityV2=__webpack_require__("./src/shared/models/entity/abstract/entityV2.js"),entityValidationError=__webpack_require__("./src/shared/models/entity/abstract/entityValidationError.js"),resourceTypeSchemasDefinition=__webpack_require__("./src/shared/models/entity/resourceType/resourceTypeSchemasDefinition.js"),resourceTypesCollection=__webpack_require__("./src/shared/models/entity/resourceType/resourceTypesCollection.js"),secretDataEntity=__webpack_require__("./src/shared/models/entity/secretData/secretDataEntity.js");class SecretDataV4DefaultEntity extends secretDataEntity.A{constructor(dto={},options={}){super(dto,options)}static getSchema(){return{type:"object",required:["password"],properties:{password:{type:"string",maxLength:4096},description:{type:"string",maxLength:1e4,nullable:!0}}}}static createFromDefault(data={},options){return new SecretDataV4DefaultEntity({password:"",description:"",...data},options)}static getDefaultProp(propName){switch((0,assertString.A)(propName),propName){case"password":case"description":return"";default:return}}areSecretsDifferent(secretDto){return this.password!==secretDto.password||this.description!==secretDto.description}get password(){return this._props.password}get description(){return this._props.description}}const secretDataV4DefaultEntity=SecretDataV4DefaultEntity;var totpEntity=__webpack_require__("./src/shared/models/entity/totp/totpEntity.js");class SecretDataV4DefaultTotpEntity extends secretDataV4DefaultEntity{static getSchema(){return{type:"object",required:["password","totp"],properties:{...secretDataV4DefaultEntity.getSchema().properties,totp:totpEntity.A.getSchema()}}}static get associations(){return{totp:totpEntity.A}}static createFromDefault(data={},options){const defaultData={password:"",totp:totpEntity.A.createFromDefault({},{validate:!1}).toDto()};return new SecretDataV4DefaultTotpEntity({...defaultData,...data},options)}static getDefaultProp(propName){switch((0,assertString.A)(propName),propName){case"password":case"description":return"";case"totp":return totpEntity.A.createFromDefault({},{validate:!1}).toDto();default:return}}areSecretsDifferent(secretDto){const totp=this.totp.toDto(),isTotpDifferent=Object.keys(totp).some((key=>totp[key]!==secretDto.totp?.[key]));return this.password!==secretDto.password||isTotpDifferent||this.description!==secretDto.description}toDto(){const result=Object.assign({},this._props);return this.totp&&(result.totp=this.totp.toDto()),result}get totp(){return this._totp}}const secretDataV4DefaultTotpEntity=SecretDataV4DefaultTotpEntity;class secretDataV4PasswordStringEntity extends secretDataEntity.A{static getSchema(){return{type:"object",required:["password"],properties:{password:{type:"string",maxLength:4096}}}}static createFromDefault(data={},options){return new secretDataV4PasswordStringEntity({password:"",...data},options)}static getDefaultProp(propName){if((0,assertString.A)(propName),"password"===propName)return""}areSecretsDifferent(secretDto){return this.password!==secretDto.password}get password(){return this._props.password}}const secretData_secretDataV4PasswordStringEntity=secretDataV4PasswordStringEntity;class SecretDataV4StandaloneTotpEntity extends secretDataEntity.A{constructor(dto,options={}){super(dto,options),this._props.totp&&(this._totp=new totpEntity.A(this._props.totp,{...options,clone:!1}),delete this._props.totp)}static getSchema(){return{type:"object",required:["totp"],properties:{totp:totpEntity.A.getSchema()}}}static get associations(){return{totp:totpEntity.A}}static createFromDefault(data={},options){const defaultData={totp:totpEntity.A.createFromDefault({},{validate:!1}).toDto()};return new SecretDataV4StandaloneTotpEntity({...defaultData,...data},options)}static getDefaultProp(propName){if((0,assertString.A)(propName),"totp"===propName)return totpEntity.A.createFromDefault({},{validate:!1}).toDto()}areSecretsDifferent(secretDto){const totp=this.totp.toDto();return Object.keys(totp).some((key=>totp[key]!==secretDto.totp?.[key]))}toDto(){const result=Object.assign({},this._props);return this.totp&&(result.totp=this.totp.toDto()),result}get totp(){return this._totp}}const secretDataV4StandaloneTotpEntity=SecretDataV4StandaloneTotpEntity;var customFieldsCollection=__webpack_require__("./src/shared/models/entity/customField/customFieldsCollection.js"),customFieldEntity=__webpack_require__("./src/shared/models/entity/customField/customFieldEntity.js");class SecretDataV5DefaultEntity extends secretDataEntity.A{static getSchema(){return{type:"object",required:["object_type","password"],properties:{...secretDataEntity.A.getSchema().properties,password:{type:"string",maxLength:4096,nullable:!0},description:{type:"string",maxLength:1e4,nullable:!0},custom_fields:customFieldsCollection.A.getSchema()}}}static get associations(){return{custom_fields:customFieldsCollection.A}}marshall(){this._props.object_type||(this._props.object_type=secretDataEntity.h)}static createFromDefault(data={},options){const defaultData={object_type:secretDataEntity.h,password:""};return new SecretDataV5DefaultEntity({...defaultData,...data},options)}static getDefaultProp(propName){switch((0,assertString.A)(propName),propName){case"password":case"description":return"";case"custom_fields":return new customFieldsCollection.A([customFieldEntity.Ay.createFromDefault()]).toDto();default:return}}areSecretsDifferent(secretDto){if(this.password!==secretDto.password||this.description!==secretDto.description)return!0;const isCustomFieldDefined=void 0!==this.customFields&&null!==this.customFields,isOtherCustomFieldDefined=void 0!==secretDto.custom_fields&&null!==secretDto.custom_fields;if(!isCustomFieldDefined&&!isOtherCustomFieldDefined)return!1;if(!isCustomFieldDefined&&isOtherCustomFieldDefined||isCustomFieldDefined&&!isOtherCustomFieldDefined)return!0;const otherCollection=new customFieldsCollection.A(secretDto.custom_fields,{validate:!1});return customFieldsCollection.A.areCollectionsDifferent(this.customFields,otherCollection)}toDto(){const result=Object.assign({},this._props);return this.customFields&&(result.custom_fields=this.customFields.toDto()),result}get password(){return this._props.password}get description(){return this._props.description}get customFields(){return this._customFields||null}}const secretDataV5DefaultEntity=SecretDataV5DefaultEntity;class SecretDataV5DefaultTotpEntity extends secretDataV5DefaultEntity{static getSchema(){return{type:"object",required:["object_type","password","totp"],properties:{...secretDataV5DefaultEntity.getSchema().properties,totp:totpEntity.A.getSchema(),custom_fields:customFieldsCollection.A.getSchema()}}}static get associations(){return{totp:totpEntity.A,custom_fields:customFieldsCollection.A}}marshall(){this._props.object_type||(this._props.object_type=secretDataEntity.h)}static createFromDefault(data={},options){const defaultData={object_type:secretDataEntity.h,password:"",totp:totpEntity.A.createFromDefault({},{validate:!1}).toDto()};return new SecretDataV5DefaultTotpEntity({...defaultData,...data},options)}static getDefaultProp(propName){switch((0,assertString.A)(propName),propName){case"password":case"description":return"";case"totp":return totpEntity.A.createFromDefault({},{validate:!1}).toDto();case"custom_fields":return new customFieldsCollection.A([customFieldEntity.Ay.createFromDefault()]).toDto();default:return}}areSecretsDifferent(secretDto){if(this.password!==secretDto.password)return!0;if(this.description!==secretDto.description)return!0;const totp=this.totp.toDto();if(Object.keys(totp).some((key=>totp[key]!==secretDto.totp?.[key])))return!0;const isCustomFieldDefined=void 0!==this.customFields&&null!==this.customFields,isOtherCustomFieldDefined=void 0!==secretDto.custom_fields&&null!==secretDto.custom_fields;if(!isCustomFieldDefined&&!isOtherCustomFieldDefined)return!1;if(!isCustomFieldDefined&&isOtherCustomFieldDefined||isCustomFieldDefined&&!isOtherCustomFieldDefined)return!0;const otherCollection=new customFieldsCollection.A(secretDto.custom_fields,{validate:!1});return customFieldsCollection.A.areCollectionsDifferent(this.customFields,otherCollection)}toDto(){const result=Object.assign({},this._props);return this.totp&&(result.totp=this.totp.toDto()),this.customFields&&(result.custom_fields=this.customFields.toDto()),result}get totp(){return this._totp}get customFields(){return this._customFields||null}}const secretDataV5DefaultTotpEntity=SecretDataV5DefaultTotpEntity;class SecretDataV5PasswordStringEntity extends secretDataEntity.A{static getSchema(){return{type:"object",required:["object_type","password"],properties:{...secretDataEntity.A.getSchema().properties,password:{type:"string",maxLength:4096,nullable:!0}}}}marshall(){this._props.object_type||(this._props.object_type=secretDataEntity.h)}static createFromDefault(data={},options){const defaultData={object_type:secretDataEntity.h,password:""};return new SecretDataV5PasswordStringEntity({...defaultData,...data},options)}static getDefaultProp(propName){if((0,assertString.A)(propName),"password"===propName)return""}areSecretsDifferent(secretDto){return this.password!==secretDto.password}get password(){return this._props.password}}const secretDataV5PasswordStringEntity=SecretDataV5PasswordStringEntity;class SecretDataV5StandaloneCustomFieldsCollection extends secretDataEntity.A{constructor(dto,options={}){super(dto,options)}static getSchema(){return{type:"object",required:["object_type","custom_fields"],properties:{...secretDataEntity.A.getSchema().properties,custom_fields:customFieldsCollection.A.getSchema()}}}static get associations(){return{custom_fields:customFieldsCollection.A}}toDto(){const result=Object.assign({},this._props),customFields=this.customFields;return customFields&&(result.custom_fields=customFields.toDto()),result}get customFields(){return this._customFields}static createFromDefault(items=[]){const defaultData={object_type:secretDataEntity.h,custom_fields:items};return 0===items.length&&defaultData.custom_fields.push(customFieldEntity.Ay.createFromDefault()),new SecretDataV5StandaloneCustomFieldsCollection(defaultData)}static getDefaultProp(propName){if((0,assertString.A)(propName),"custom_fields"===propName)return new customFieldsCollection.A([customFieldEntity.Ay.createFromDefault()]).toDto()}areSecretsDifferent(secretDto){const otherCollection=new customFieldsCollection.A(secretDto.custom_fields,{validate:!1});return customFieldsCollection.A.areCollectionsDifferent(this.customFields,otherCollection)}}class SecretDataV5StandaloneTotpEntity extends secretDataEntity.A{constructor(dto,options={}){super(dto,options),this._props.totp&&(this._totp=new totpEntity.A(this._props.totp,{...options,clone:!1}),delete this._props.totp)}static getSchema(){return{type:"object",required:["object_type","totp"],properties:{...secretDataEntity.A.getSchema().properties,totp:totpEntity.A.getSchema()}}}static get associations(){return{totp:totpEntity.A}}marshall(){this._props.object_type||(this._props.object_type=secretDataEntity.h)}static createFromDefault(data={},options){const defaultData={object_type:secretDataEntity.h,totp:totpEntity.A.createFromDefault({},{validate:!1}).toDto()};return new SecretDataV5StandaloneTotpEntity({...defaultData,...data},options)}static getDefaultProp(propName){if((0,assertString.A)(propName),"totp"===propName)return totpEntity.A.createFromDefault({},{validate:!1}).toDto()}areSecretsDifferent(secretDto){const totp=this.totp.toDto();return Object.keys(totp).some((key=>totp[key]!==secretDto.totp?.[key]))}toDto(){const result=Object.assign({},this._props);return this.totp&&(result.totp=this.totp.toDto()),result}get totp(){return this._totp}}const secretDataV5StandaloneTotpEntity=SecretDataV5StandaloneTotpEntity;var resourceMetadataEntity=__webpack_require__("./src/shared/models/entity/resource/metadata/resourceMetadataEntity.js");class ResourceFormEntity extends entityV2.A{constructor(dtos={},options={}){super(dtos,options)}static get associations(){return{metadata:resourceMetadataEntity.A,secret:secretDataEntity.A}}static getSchema(){return{type:"object",required:["metadata","resource_type_id","secret"],properties:{id:{type:"string",format:"uuid"},resource_type_id:{type:"string",format:"uuid"},folder_parent_id:{type:"string",format:"uuid",nullable:!0},expired:{type:"string",format:"date-time",nullable:!0},metadata:resourceMetadataEntity.A.getSchema(),secret:{anyOf:[secretDataV5DefaultEntity.getSchema(),secretDataV5DefaultTotpEntity.getSchema(),secretDataV5StandaloneTotpEntity.getSchema(),secretDataV5PasswordStringEntity.getSchema(),secretDataV4DefaultEntity.getSchema(),secretDataV4DefaultTotpEntity.getSchema(),secretDataV4StandaloneTotpEntity.getSchema(),secretData_secretDataV4PasswordStringEntity.getSchema(),SecretDataV5StandaloneCustomFieldsCollection.getSchema()]}}}}createAssociations(options={}){const validationErrors=new entityValidationError.A;if(this._props.resource_type_id&&options.resourceTypes instanceof resourceTypesCollection.A){this.resourceTypes=options.resourceTypes;const resourceType=this.resourceTypes.getFirstById(this._props.resource_type_id),secretEntityClass=this.getSecretEntityClassByResourceType(resourceType.slug);if(!secretEntityClass)throw new Error("No secret association class has been found in resource types.");try{this._props.secret?this._secret=new secretEntityClass(this._props.secret,options):this._secret=secretEntityClass.createFromDefault(this._props.secret,options)}catch(error){if(!(error instanceof entityValidationError.A))throw error;validationErrors.addAssociationError("secret",error)}delete this._props.secret}try{super.createAssociations(options)}catch(error){Object.assign(validationErrors.details,error.details)}if(validationErrors.hasErrors())throw validationErrors}getSecretEntityClassByResourceType(resourceTypeSlug){switch((0,assertString.A)(resourceTypeSlug),resourceTypeSlug){case resourceTypeSchemasDefinition.gG:return secretDataV5DefaultEntity;case resourceTypeSchemasDefinition.a5:return secretDataV5DefaultTotpEntity;case resourceTypeSchemasDefinition.uQ:return secretDataV5StandaloneTotpEntity;case resourceTypeSchemasDefinition.Eh:return secretDataV5PasswordStringEntity;case resourceTypeSchemasDefinition.Bo:return secretDataV4DefaultEntity;case resourceTypeSchemasDefinition.fl:return secretDataV4DefaultTotpEntity;case resourceTypeSchemasDefinition.KY:return secretDataV4StandaloneTotpEntity;case resourceTypeSchemasDefinition._w:return secretData_secretDataV4PasswordStringEntity;case resourceTypeSchemasDefinition.qr:return SecretDataV5StandaloneCustomFieldsCollection;default:return null}}addSecret(secret,options){if((0,assertString.A)(secret),!Object.values(ResourceEditCreateFormEnumerationTypes.D).includes(secret))return;const currentResourceType=this.resourceTypes.getFirstById(this.resourceTypeId),secretPropName=secret.match(/secret\.(.+)$/)?.[1];if(!this.isResourceTypeHasSecretProperty(currentResourceType,secret)){const resourceDto=this.toDto();resourceDto.secret[secretPropName]="";const mutateResourceType=this.resourceTypes.getResourceTypeMatchingResource(resourceDto,currentResourceType.version),secretEntityClass=this.getSecretEntityClassByResourceType(mutateResourceType.slug);if(!secretEntityClass)throw new Error("No secret association class has been found in resource types.");this.set("secret",new secretEntityClass(this.secret.toDto(),{validate:!1})),currentResourceType.isV4()&&currentResourceType.isPasswordString()&&(this.set("secret.description",this.metadata?.description||"",options),this.set("metadata.description",null,options)),this.set("resource_type_id",mutateResourceType.id),this.set("metadata.resource_type_id",mutateResourceType.id)}this.set(secret,this.secret.constructor.getDefaultProp(secretPropName),options)}deleteSecret(secret,options){if((0,assertString.A)(secret),!Object.values(ResourceEditCreateFormEnumerationTypes.D).includes(secret))return;const secretPropName=secret.match(/secret\.(.+)$/)?.[1],resourceDto=this.toDto();delete resourceDto.secret[secretPropName];const currentResourceType=this.resourceTypes.getFirstById(this.resourceTypeId),mutateResourceType=this.resourceTypes.getResourceTypeMatchingResource(resourceDto,currentResourceType.version);if(currentResourceType.id!==mutateResourceType.id){const secretEntityClass=this.getSecretEntityClassByResourceType(mutateResourceType.slug);if(!secretEntityClass)throw new Error("No secret association class has been found in resource types.");this.set("secret",new secretEntityClass(resourceDto.secret,options)),this.set("resource_type_id",mutateResourceType.id),this.set("metadata.resource_type_id",mutateResourceType.id)}else this.set("secret",new this._secret.constructor(resourceDto.secret,options))}convertToNote(options){const resourceType=this.resourceTypes.getFirstBySlug(resourceTypeSchemasDefinition.Bo),secretEntityClass=this.getSecretEntityClassByResourceType(resourceType?.slug);if(!secretEntityClass)throw new Error("No secret association class has been found in resource types.");this.set("secret",new secretEntityClass(this.secret.toDto(),options)),this.set("secret.description",this.metadata?.description||"",options),this.set("metadata.description",null,options),this.set("resource_type_id",resourceType.id),this.set("metadata.resource_type_id",resourceType.id)}convertToMetadataDescription(options){const resourceType=this.resourceTypes.getFirstBySlug(resourceTypeSchemasDefinition._w),secretEntityClass=this.getSecretEntityClassByResourceType(resourceType?.slug);if(!secretEntityClass)throw new Error("No secret association class has been found in resource types.");this.set("metadata.description",this.secret?.description||"",options),this.set("secret.description",null,options),this.set("secret",new secretEntityClass(this.secret.toDto(),options)),this.set("resource_type_id",resourceType.id),this.set("metadata.resource_type_id",resourceType.id)}isResourceTypeHasSecretProperty(resourceType,secretProp){switch((0,assertString.A)(secretProp),secretProp){case ResourceEditCreateFormEnumerationTypes.D.PASSWORD:return resourceType.hasPassword();case ResourceEditCreateFormEnumerationTypes.D.TOTP:return resourceType.hasTotp();case ResourceEditCreateFormEnumerationTypes.D.NOTE:return resourceType.hasSecretDescription();case ResourceEditCreateFormEnumerationTypes.D.CUSTOM_FIELDS:return resourceType.hasCustomFields();default:return!1}}get resourceTypeId(){return this._props.resource_type_id}get metadata(){return this._metadata}get secret(){return this._secret}toDto(){const result=Object.assign({},this._props);return this._metadata&&(result.metadata=this.metadata.toDto(resourceMetadataEntity.A.DEFAULT_CONTAIN)),this._secret&&(result.secret=this.secret.toDto()),result}toResourceDto(){const result=Object.assign({},this._props);return this._metadata&&(result.metadata=this.metadata.toDto(resourceMetadataEntity.A.DEFAULT_CONTAIN),this.secret._customFields&&(result.metadata.custom_fields=this.secret._customFields.toMetadataDto())),result}toSecretDto(){if(this._secret){const result=this.secret.toDto();return this.secret._customFields&&(result.custom_fields=this.secret._customFields.toSecretDto()),result}return null}verifyHealth(){let validationError=null;return this.secret&&(validationError=this.validateMaxLengthAgainstSchema(this.secret.toDto(),this.secret,validationError,"secret"),this.secret.totp&&(validationError=this.validateMaxLengthAgainstSchema(this.secret.totp.toDto(),this.secret.totp,validationError,"secret.totp")),this.secret.customFields&&(validationError=this.validateCustomFields(this.secret.customFields,validationError))),this.metadata&&(validationError=this.validateMaxLengthAgainstSchema(this.metadata.toDto(resourceMetadataEntity.A.DEFAULT_CONTAIN),this.metadata,validationError,"metadata")),validationError}validateMaxLengthAgainstSchema(dataObject,entity,currentError,associationName=""){let error=currentError;return Object.entries(dataObject).forEach((([fieldName,fieldValue])=>{const fieldSchema=entity.constructor.getSchema().properties[fieldName];if(fieldSchema)if("array"===fieldSchema.type&&Array.isArray(fieldValue)){const maxItemLength=fieldSchema.items?.maxLength;void 0!==maxItemLength&&fieldValue.forEach(((value,index)=>{value?.length>=maxItemLength&&(error=error||new entityValidationError.A,error.addError(`${associationName}.${fieldName}.${index}`,"maxLength",`${associationName}.${fieldName} at index ${index} exceeds maximum length limit`))}))}else{const maxLength=fieldSchema.maxLength;void 0!==maxLength&&fieldValue?.length>=maxLength&&(error=error||new entityValidationError.A,error.addError(`${associationName}.${fieldName}`,"maxLength",`${associationName}.${fieldName} exceeds maximum length limit`))}})),error}validateCustomFields(customFields,currentError){let error=currentError;const uniqueKeys={};for(let i=0;i<customFields.length;i++){const customField=customFields.items[i],isKeyTooLong=customField.key.length>=customFieldEntity.bD,isValueTooLong=customField.value.length>=customFieldEntity.F8;customField.key.length>0&&null!=uniqueKeys[customField.key]?(error=error||new entityValidationError.A,error.addError(`custom_fields.${uniqueKeys[customField.key]}.key`,"unique","The key name is already used"),error.addError(`custom_fields.${i}.key`,"unique","The key name is already used")):uniqueKeys[customField.key]=i,(isKeyTooLong||isValueTooLong)&&(error=error||new entityValidationError.A,isKeyTooLong&&error.addError(`custom_fields.${i}.key`,"maxLength",`The custom field key at index ${i} reached the maximum length`),isValueTooLong&&error.addError(`custom_fields.${i}.value`,"maxLength",`The custom field value at index ${i} reached the maximum length`))}return error}validate(options={}){return super.validate(Object.assign(options,{skipSchemaAssociationValidation:!0}))}removeEmptySecret(options){(this.secret instanceof secretDataV4DefaultTotpEntity||this.secret instanceof secretDataV5DefaultTotpEntity)&&(this.secret.totp.hasSecretKey||this.deleteSecret(ResourceEditCreateFormEnumerationTypes.D.TOTP,options)),(this.secret instanceof secretDataV5DefaultEntity||this.secret instanceof secretDataV5DefaultTotpEntity)&&this.secret.customFields&&this.secret.customFields.isEmpty()&&this.deleteSecret(ResourceEditCreateFormEnumerationTypes.D.CUSTOM_FIELDS,options)}addRequiredSecret(options){const resourceType=this.resourceTypes.getFirstById(this._props.resource_type_id);resourceType.hasPassword()&&null==this.secret.password&&(resourceType.isV5()?this.secret.set("password",null,options):resourceType.isV4()&&this.secret.set("password","",options))}upgradeToV5(){const resourceType=this.resourceTypes.getFirstById(this.resourceTypeId);let v5ResourceTypeSlug=null;if(resourceType.slug===resourceTypeSchemasDefinition._w?v5ResourceTypeSlug=resourceTypeSchemasDefinition.gG:resourceType.slug in resourceTypeSchemasDefinition.WC&&(v5ResourceTypeSlug=resourceTypeSchemasDefinition.WC[resourceType.slug]),v5ResourceTypeSlug){const v5ResourceType=this.resourceTypes.getFirstBySlug(v5ResourceTypeSlug),secretEntityClass=this.getSecretEntityClassByResourceType(v5ResourceTypeSlug);if(!secretEntityClass)throw new Error("No secret association class has been found in resource types.");this.set("resource_type_id",v5ResourceType.id),this.set("metadata.resource_type_id",v5ResourceType.id),this.set("metadata.object_type",resourceMetadataEntity.A.METADATA_OBJECT_TYPE),this.set("secret",new secretEntityClass(this.secret.toDto()))}}marshall(){this._props.metadata||(this._props.metadata={resource_type_id:this._props.resource_type_id,name:"",uris:[],object_type:resourceMetadataEntity.A.METADATA_OBJECT_TYPE})}}const resourceFormEntity=ResourceFormEntity},"./src/shared/models/entity/secretData/secretDataEntity.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__,h:()=>SECRET_DATA_OBJECT_TYPE});var _abstract_entityV2__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/models/entity/abstract/entityV2.js");const SECRET_DATA_OBJECT_TYPE="PASSBOLT_SECRET_DATA";class SecretDataEntity extends _abstract_entityV2__WEBPACK_IMPORTED_MODULE_0__.A{static getSchema(){return{type:"object",required:[],properties:{object_type:{type:"string",enum:[SECRET_DATA_OBJECT_TYPE]}}}}get objectType(){return this._props.object_type}}const __WEBPACK_DEFAULT_EXPORT__=SecretDataEntity},"./src/shared/models/entity/totp/totpEntity.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__,e:()=>SUPPORTED_TOTP_ALGORITHMS});var _abstract_entityV2__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/models/entity/abstract/entityV2.js");const SUPPORTED_TOTP_ALGORITHMS=["SHA1","SHA256","SHA512"],DEFAULT_ALGORITHM=SUPPORTED_TOTP_ALGORITHMS[0];class TotpEntity extends _abstract_entityV2__WEBPACK_IMPORTED_MODULE_0__.A{static getSchema(){return{type:"object",required:["secret_key","period","digits","algorithm"],properties:{secret_key:{type:"string",minLength:1,pattern:/^[A-Z2-7]+=*$/,maxLength:1024},period:{type:"integer",minimum:1},digits:{type:"integer",minimum:6,maximum:8},algorithm:{type:"string",enum:SUPPORTED_TOTP_ALGORITHMS}}}}marshall(){"string"==typeof this._props.secret_key&&(this._props.secret_key=this._props.secret_key?.replace(/(\W|_|\s)/g,"").toUpperCase()),"string"==typeof this._props.algorithm&&(this._props.algorithm=this._props.algorithm?.toUpperCase()),super.marshall()}static createFromDefault(data={},options){return new TotpEntity({...{secret_key:"",period:30,digits:6,algorithm:DEFAULT_ALGORITHM},...data},options)}static createTotpFromUrl(url,options){const totp={secret_key:url.searchParams.get("secret"),algorithm:url.searchParams.get("algorithm")||DEFAULT_ALGORITHM,digits:parseInt(url.searchParams.get("digits"),10)||6,period:parseInt(url.searchParams.get("period"),10)||30};return new TotpEntity(totp,options)}get secretKey(){return this._props.secret_key}get period(){return this._props.period}get digits(){return this._props.digits}get algorithm(){return this._props.algorithm}get hasSecretKey(){return this.secretKey?.length>0}}const __WEBPACK_DEFAULT_EXPORT__=TotpEntity},"./src/shared/models/resource/ResourceEditCreateFormEnumerationTypes.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D:()=>ResourceEditCreateFormEnumerationTypes});const ResourceEditCreateFormEnumerationTypes={PASSWORD:"secret.password",TOTP:"secret.totp",CUSTOM_FIELDS:"secret.custom_fields",NOTE:"secret.description",DESCRIPTION:"metadata.description",URIS:"metadata.uris",APPEARANCE:"metadata.icon"}}}]);