/*! For license information please see react-extension-components-User-ConfirmDisableUserMFA-ConfirmDisableUserMFA-test-stories.39a3a141.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkpassbolt_styleguide=self.webpackChunkpassbolt_styleguide||[]).push([[1732],{"./src/react-extension/components/User/ConfirmDisableUserMFA/ConfirmDisableUserMFA.test.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Initial:()=>Initial,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _ConfirmDisableUserMFA__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/react-extension/components/User/ConfirmDisableUserMFA/ConfirmDisableUserMFA.js"),_test_mock_MockPort__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/react-extension/test/mock/MockPort.js"),_shared_models_entity_role_role_test_data__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/shared/models/entity/role/role.test.data.js");const __WEBPACK_DEFAULT_EXPORT__={title:"Components/User/ConfirmDisableUserMFA",component:_ConfirmDisableUserMFA__WEBPACK_IMPORTED_MODULE_0__.A},Initial={args:{userWorkspaceContext:{selectedUsers:[{id:"640ebc06-5ec1-5322-a1ae-6120ed2f3a74",role_id:_shared_models_entity_role_role_test_data__WEBPACK_IMPORTED_MODULE_1__.ol,role:{created:"2012-07-04T13:39:25+00:00",description:"Logged in user",id:_shared_models_entity_role_role_test_data__WEBPACK_IMPORTED_MODULE_1__.ol,modified:"2012-07-04T13:39:25+00:00",name:"user"},username:"carol@passbolt.com",active:!0,deleted:!1,created:"2020-05-11T09:32:49+00:00",modified:"2020-05-12T09:32:49+00:00",profile:{id:"48bcd9ac-a520-53e0-b3a4-9da7e57b91aa",user_id:"640ebc06-5ec1-5322-a1ae-6120ed2f3a74",first_name:"Carol",last_name:"Shaw",created:"2020-05-13T09:32:49+00:00",modified:"2020-05-13T09:32:49+00:00",avatar:{id:"0f769127-3053-45e4-bd8e-75e766bb4d52",user_id:"640ebc06-5ec1-5322-a1ae-6120ed2f3a74",foreign_key:"48bcd9ac-a520-53e0-b3a4-9da7e57b91aa",model:"Avatar",filename:"carol.png",filesize:733439,mime_type:"image/png",extension:"png",hash:"7445a736df60a1ac1bfdab8fc5b842a95c495aec",path:"Avatar/73/09/19/0f769127305345e4bd8e75e766bb4d52/0f769127305345e4bd8e75e766bb4d52.png",adapter:"Local",created:"2020-05-13T09:32:51+00:00",modified:"2020-05-13T09:32:51+00:00",url:{medium:"img/public/Avatar/73/09/19/0f769127305345e4bd8e75e766bb4d52/0f769127305345e4bd8e75e766bb4d52.a99472d5.png",small:"img/public/Avatar/73/09/19/0f769127305345e4bd8e75e766bb4d52/0f769127305345e4bd8e75e766bb4d52.65a0ba70.png"}}},__placeholder_last_logged_in__:"",last_logged_in:"",is_mfa_enabled:!1}]},onClose:()=>{},context:{port:new _test_mock_MockPort__WEBPACK_IMPORTED_MODULE_2__.A}}},__namedExportsOrder=["Initial"];Initial.parameters={...Initial.parameters,docs:{...Initial.parameters?.docs,source:{originalSource:'{\n  args: {\n    userWorkspaceContext: {\n      selectedUsers: [{\n        "id": "640ebc06-5ec1-5322-a1ae-6120ed2f3a74",\n        "role_id": TEST_ROLE_USER_ID,\n        "role": {\n          "created": "2012-07-04T13:39:25+00:00",\n          "description": "Logged in user",\n          "id": TEST_ROLE_USER_ID,\n          "modified": "2012-07-04T13:39:25+00:00",\n          "name": "user"\n        },\n        "username": "carol@passbolt.com",\n        "active": true,\n        "deleted": false,\n        "created": "2020-05-11T09:32:49+00:00",\n        "modified": "2020-05-12T09:32:49+00:00",\n        "profile": {\n          "id": "48bcd9ac-a520-53e0-b3a4-9da7e57b91aa",\n          "user_id": "640ebc06-5ec1-5322-a1ae-6120ed2f3a74",\n          "first_name": "Carol",\n          "last_name": "Shaw",\n          "created": "2020-05-13T09:32:49+00:00",\n          "modified": "2020-05-13T09:32:49+00:00",\n          "avatar": {\n            "id": "0f769127-3053-45e4-bd8e-75e766bb4d52",\n            "user_id": "640ebc06-5ec1-5322-a1ae-6120ed2f3a74",\n            "foreign_key": "48bcd9ac-a520-53e0-b3a4-9da7e57b91aa",\n            "model": "Avatar",\n            "filename": "carol.png",\n            "filesize": 733439,\n            "mime_type": "image\\/png",\n            "extension": "png",\n            "hash": "7445a736df60a1ac1bfdab8fc5b842a95c495aec",\n            "path": "Avatar\\/73\\/09\\/19\\/0f769127305345e4bd8e75e766bb4d52\\/0f769127305345e4bd8e75e766bb4d52.png",\n            "adapter": "Local",\n            "created": "2020-05-13T09:32:51+00:00",\n            "modified": "2020-05-13T09:32:51+00:00",\n            "url": {\n              "medium": "img\\/public\\/Avatar\\/73\\/09\\/19\\/0f769127305345e4bd8e75e766bb4d52\\/0f769127305345e4bd8e75e766bb4d52.a99472d5.png",\n              "small": "img\\/public\\/Avatar\\/73\\/09\\/19\\/0f769127305345e4bd8e75e766bb4d52\\/0f769127305345e4bd8e75e766bb4d52.65a0ba70.png"\n            }\n          }\n        },\n        "__placeholder_last_logged_in__": "",\n        "last_logged_in": "",\n        is_mfa_enabled: false\n      }]\n    },\n    onClose: () => {},\n    context: {\n      port: new MockPort()\n    }\n  }\n}',...Initial.parameters?.docs?.source}}}},"./src/react-extension/components/User/ConfirmDisableUserMFA/ConfirmDisableUserMFA.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_10__),_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/react-extension/contexts/ActionFeedbackContext.js"),_contexts_DialogContext__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/react-extension/contexts/DialogContext.js"),_Common_Dialog_DialogWrapper_DialogWrapper__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/react-extension/components/Common/Dialog/DialogWrapper/DialogWrapper.js"),_Common_Inputs_FormSubmitButton_FormSubmitButton__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormSubmitButton.js"),_Common_Inputs_FormSubmitButton_FormCancelButton__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormCancelButton.js"),_contexts_UserWorkspaceContext__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/react-extension/contexts/UserWorkspaceContext.js"),_Common_Error_NotifyError_NotifyError__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/react-extension/components/Common/Error/NotifyError/NotifyError.js"),react_i18next__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js");class ConfirmDisableUserMFA extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props,context){super(props,context),this.state=this.defaultState,this.bindEventHandlers()}get defaultState(){return{actions:{processing:!1}}}bindEventHandlers(){this.handleConfirm=this.handleConfirm.bind(this),this.handleClose=this.handleClose.bind(this)}get user(){return this.props.userWorkspaceContext.selectedUsers[0]}get isProcessing(){return this.state.actions.processing}get areActionsDisabled(){return this.isProcessing}handleConfirm(event){event.preventDefault(),this.disableMFA()}handleClose(){this.close()}async disableMFA(){await this.setState({actions:{processing:!0}}),await this.props.context.port.request("passbolt.mfa.disable-for-user",this.user.id).then(this.onDisableMFASuccess.bind(this)).catch(this.onDisableMFAFailure.bind(this))}async onDisableMFASuccess(){await this.setState({actions:{processing:!1}}),this.props.actionFeedbackContext.displaySuccess(this.translate("Multi-factor authentication has been disabled successfully")),this.props.onClose()}onDisableMFAFailure(error){this.setState({actions:{processing:!1}});const errorDialogProps={error};this.props.dialogContext.open(_Common_Error_NotifyError_NotifyError__WEBPACK_IMPORTED_MODULE_8__.A,errorDialogProps)}close(){this.props.onClose()}get translate(){return this.props.t}render(){const name=`${this.user.profile.first_name} ${this.user.profile.last_name}`,username=this.user.username;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Dialog_DialogWrapper_DialogWrapper__WEBPACK_IMPORTED_MODULE_4__.A,{title:this.translate("Are you sure?"),onClose:this.handleClose,disabled:this.areActionsDisabled},react__WEBPACK_IMPORTED_MODULE_0__.createElement("form",{onSubmit:this.handleConfirm,noValidate:!0},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"form-content"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_9__.x6,null,"You are about to disable second-factor authentication (MFA) for the user ",react__WEBPACK_IMPORTED_MODULE_0__.createElement("strong",null,{name}," (",{username},")"),".")),react__WEBPACK_IMPORTED_MODULE_0__.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_9__.x6,null,"Existing settings will be lost. This action cannot be undone."))),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"submit-wrapper clearfix"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Inputs_FormSubmitButton_FormCancelButton__WEBPACK_IMPORTED_MODULE_6__.A,{disabled:this.areActionsDisabled,onClick:this.handleClose}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Inputs_FormSubmitButton_FormSubmitButton__WEBPACK_IMPORTED_MODULE_5__.A,{value:this.translate("Disable MFA"),warning:!0,processing:this.isProcessing,disabled:this.areActionsDisabled}))))}}ConfirmDisableUserMFA.propTypes={context:prop_types__WEBPACK_IMPORTED_MODULE_10___default().any,actionFeedbackContext:prop_types__WEBPACK_IMPORTED_MODULE_10___default().any,onClose:prop_types__WEBPACK_IMPORTED_MODULE_10___default().func,dialogContext:prop_types__WEBPACK_IMPORTED_MODULE_10___default().any,userWorkspaceContext:prop_types__WEBPACK_IMPORTED_MODULE_10___default().any,t:prop_types__WEBPACK_IMPORTED_MODULE_10___default().func};const __WEBPACK_DEFAULT_EXPORT__=(0,_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_1__.L)((0,_contexts_UserWorkspaceContext__WEBPACK_IMPORTED_MODULE_7__.zY)((0,_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_2__.ot)((0,_contexts_DialogContext__WEBPACK_IMPORTED_MODULE_3__.z9)((0,react_i18next__WEBPACK_IMPORTED_MODULE_9__.CI)("common")(ConfirmDisableUserMFA)))));ConfirmDisableUserMFA.__docgenInfo={description:"",methods:[{name:"defaultState",docblock:"Returns the component default state",modifiers:["get"],params:[],returns:null,description:"Returns the component default state"},{name:"bindEventHandlers",docblock:"Bind event handlers\n@returns {void}",modifiers:[],params:[],returns:{type:{name:"void"}},description:"Bind event handlers"},{name:"user",docblock:"Returns the current selected user",modifiers:["get"],params:[],returns:null,description:"Returns the current selected user"},{name:"isProcessing",docblock:"Returns true if the confirm action is processing",modifiers:["get"],params:[],returns:null,description:"Returns true if the confirm action is processing"},{name:"areActionsDisabled",docblock:"Returns truc if the actions must be disabled",modifiers:["get"],params:[],returns:null,description:"Returns truc if the actions must be disabled"},{name:"handleConfirm",docblock:"Handle the will to confirm",modifiers:[],params:[{name:"event",optional:!1}],returns:null,description:"Handle the will to confirm"},{name:"handleClose",docblock:"Handle the will to close",modifiers:[],params:[],returns:null,description:"Handle the will to close"},{name:"disableMFA",docblock:"Disable the selected user's MFA",modifiers:["async"],params:[],returns:null,description:"Disable the selected user's MFA"},{name:"onDisableMFASuccess",docblock:"Whenever the user MFA has been disabled successfully",modifiers:["async"],params:[],returns:null,description:"Whenever the user MFA has been disabled successfully"},{name:"onDisableMFAFailure",docblock:"Whenever the user MFA has been disabled with failure",modifiers:[],params:[{name:"error",optional:!1}],returns:null,description:"Whenever the user MFA has been disabled with failure"},{name:"close",docblock:"Close the current dialog",modifiers:[],params:[],returns:null,description:"Close the current dialog"},{name:"translate",docblock:"Get the translate function\n@returns {function(...[*]=)}",modifiers:["get"],params:[],returns:{},description:"Get the translate function"}],displayName:"ConfirmDisableUserMFA",props:{context:{description:"",type:{name:"any"},required:!1},actionFeedbackContext:{description:"",type:{name:"any"},required:!1},onClose:{description:"",type:{name:"func"},required:!1},dialogContext:{description:"",type:{name:"any"},required:!1},userWorkspaceContext:{description:"",type:{name:"any"},required:!1},t:{description:"",type:{name:"func"},required:!1}}}},"./src/react-extension/contexts/ActionFeedbackContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ay:()=>ActionFeedbackContextProvider,b_:()=>ActionFeedbackContext,ot:()=>withActionFeedback});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__),uuid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js");const ActionFeedbackContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext({feedbacks:[],displaySuccess:()=>{},displayWarning:()=>{},displayError:()=>{},remove:()=>{}});class ActionFeedbackContextProvider extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.defaultState}get defaultState(){return{feedbacks:[],displaySuccess:this.displaySuccess.bind(this),displayWarning:this.displayWarning.bind(this),displayError:this.displayError.bind(this),remove:this.remove.bind(this)}}displaySuccess(feedbackToAdd){this.setState({feedbacks:[...this.state.feedbacks,{id:(0,uuid__WEBPACK_IMPORTED_MODULE_1__.A)(),type:"success",message:feedbackToAdd}]})}displayWarning(feedbackToAdd){this.setState({feedbacks:[...this.state.feedbacks,{id:(0,uuid__WEBPACK_IMPORTED_MODULE_1__.A)(),type:"warning",message:feedbackToAdd}]})}displayError(feedbackToAdd){this.setState({feedbacks:[...this.state.feedbacks,{id:(0,uuid__WEBPACK_IMPORTED_MODULE_1__.A)(),type:"error",message:feedbackToAdd}]})}remove(feedbackToRemove){this.setState({feedbacks:this.state.feedbacks.filter((feedback=>feedbackToRemove.id!==feedback.id))})}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(ActionFeedbackContext.Provider,{value:this.state},this.props.children)}}function withActionFeedback(WrappedComponent){return class WithActionFeedback extends react__WEBPACK_IMPORTED_MODULE_0__.Component{render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(ActionFeedbackContext.Consumer,null,(actionFeedbackContext=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(WrappedComponent,{actionFeedbackContext,...this.props})))}}}ActionFeedbackContextProvider.displayName="ActionFeedbackContextProvider",ActionFeedbackContextProvider.propTypes={children:prop_types__WEBPACK_IMPORTED_MODULE_2___default().any},ActionFeedbackContextProvider.__docgenInfo={description:"The related context provider",methods:[{name:"defaultState",docblock:"Returns the default component state",modifiers:["get"],params:[],returns:null,description:"Returns the default component state"},{name:"displaySuccess",docblock:"Display the feedback in a success mode\n@param feedbackToAdd A feedback",modifiers:[],params:[{name:"feedbackToAdd",description:"A feedback",optional:!1}],returns:null,description:"Display the feedback in a success mode"},{name:"displayWarning",docblock:"Display the feedback in a warning mode\n@param feedbackToAdd A feedback",modifiers:[],params:[{name:"feedbackToAdd",description:"A feedback",optional:!1}],returns:null,description:"Display the feedback in a warning mode"},{name:"displayError",docblock:"Display the feedback in a error mode\n@param feedbackToAdd A feedback",modifiers:[],params:[{name:"feedbackToAdd",description:"A feedback",optional:!1}],returns:null,description:"Display the feedback in a error mode"},{name:"remove",docblock:"Remove the feedback\n@param feedbackToRemove A feedback",modifiers:[],params:[{name:"feedbackToRemove",description:"A feedback",optional:!1}],returns:null,description:"Remove the feedback"}],displayName:"ActionFeedbackContextProvider",props:{children:{description:"",type:{name:"any"},required:!1}}}},"./src/react-extension/contexts/LoadingContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$A:()=>withLoading,Ay:()=>LoadingContextProvider});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);const LoadingContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext({counter:[],add:()=>{},remove:()=>{}});class LoadingContextProvider extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.defaultState}get defaultState(){return{counter:0,add:()=>{this.setState({counter:this.state.counter+1})},remove:()=>{this.setState({counter:Math.min(this.state.counter-1,0)})}}}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(LoadingContext.Provider,{value:this.state},this.props.children)}}function withLoading(WrappedComponent){return class WithLoading extends react__WEBPACK_IMPORTED_MODULE_0__.Component{render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(LoadingContext.Consumer,null,(loadingContext=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(WrappedComponent,{loadingContext,...this.props})))}}}LoadingContextProvider.propTypes={children:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any},LoadingContextProvider.__docgenInfo={description:"The related context provider",methods:[{name:"defaultState",docblock:"The component default state",modifiers:["get"],params:[],returns:null,description:"The component default state"}],displayName:"LoadingContextProvider",props:{children:{description:"",type:{name:"any"},required:!1}}}},"./src/react-extension/test/mock/MockPort.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function delay(t,v){return new Promise((resolve=>{setTimeout((()=>resolve(v)),t)}))}__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=class MockPort{constructor(storage){this.storage=storage,this.onListeners={},this.requestListeners={},this.emitListener={},this.onConnectErrorHandler={}}async emit(name,eventObject){let result;return console.debug(`PORT EMIT: ${name}`),console.debug("Arguments",eventObject),this.emitListener[name]?(result=await this.emitListener[name](eventObject),console.debug("response: ",result)):console.debug(`The emit ${name} has not been mocked`),delay(0,result)}on(name,callback){console.debug(`PORT ON: ${name}`),console.debug("PORT ON PARAMETERS:",callback),this.addOnListener(name,callback)}async request(name){let result;if(console.debug(`PORT REQUEST: ${name}`),console.debug("PORT REQUEST PARAMETERS:",Array.prototype.slice.call(arguments)),this.requestListeners[name]){const listenerArguments=Array.prototype.slice.call(arguments,1,arguments.length);console.debug("listenerArguments",listenerArguments),listenerArguments.push(this.storage),console.debug("listenerArguments",listenerArguments),result=await this.requestListeners[name](...listenerArguments),console.debug("response: ",result)}else console.debug(`The request ${name} has not been mocked`);return delay(0,result)}addEmitListener(name){console.debug(`PORT EMIT: ${name}`),console.debug("PORT EMIT PARAMETERS:",Array.prototype.slice.call(arguments))}addOnListener(name,callback){this.emitListener[name]=callback}addRequestListener(name,callback){this.requestListeners[name]=callback}onConnectError(callback){this.onConnectErrorHandler.callback=callback}}},"./src/shared/context/Rbac/RbacContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{eu:()=>RbacContext,Ay:()=>Rbac_RbacContext,x6:()=>withRbac});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),AppContext=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),controlFunctionEnumeration=__webpack_require__("./src/shared/services/rbacs/controlFunctionEnumeration.js"),denyControlFunction=__webpack_require__("./src/shared/services/rbacs/controlFunctions/denyControlFunction.js"),allowControlFunction=__webpack_require__("./src/shared/services/rbacs/controlFunctions/allowControlFunction.js");class GetControlFunctionService{static getByRbac(rbac){const controlFunction=controlFunctionEnumeration.HJ[rbac.controlFunction];return controlFunction||(console.warn(`Could not find control function for the given rbac entity (${rbac.id})`),denyControlFunction.A)}static getDefaultForAdminAndUiAction(uiActionName){return controlFunctionEnumeration.Y9[uiActionName]||allowControlFunction.A}static getDefaultForUserAndUiAction(uiActionName){return controlFunctionEnumeration.uy[uiActionName]||allowControlFunction.A}}var roleEntity=__webpack_require__("./src/shared/models/entity/role/roleEntity.js");class CanUse{static canRoleUseUiAction(user,rbacs,actionName){if(window.chrome?.webview){const rbac=rbacs.findRbacByActionName(actionName);return this.getByRbacOrDefault(rbac,actionName,user)}const role=new roleEntity.A(user.role);if(role.isAdmin()){return GetControlFunctionService.getDefaultForAdminAndUiAction(actionName).execute()}const rbac=rbacs.findRbacByRoleAndUiActionName(role,actionName);return this.getByRbacOrDefault(rbac,actionName,user)}static getByRbacOrDefault(rbac,actionName,user){if(rbac){return GetControlFunctionService.getByRbac(rbac).execute(user)}return GetControlFunctionService.getDefaultForUserAndUiAction(actionName).execute()}}const RbacContext=react.createContext({canIUseUiAction:()=>{}});class RbacContextProvider extends react.Component{constructor(props){super(props),this.state=this.defaultState}get defaultState(){return{canIUseUiAction:this.canIUseUiAction.bind(this)}}canIUseUiAction(actionName){return CanUse.canRoleUseUiAction(this.props.context.loggedInUser,this.props.context.rbacs,actionName)}render(){return react.createElement(RbacContext.Provider,{value:this.state},this.props.children)}}RbacContextProvider.propTypes={context:prop_types_default().any,children:prop_types_default().any};const Rbac_RbacContext=(0,AppContext.L)(RbacContextProvider);function withRbac(WrappedComponent){return class WithRbac extends react.Component{render(){return react.createElement(RbacContext.Consumer,null,(rbacContext=>react.createElement(WrappedComponent,{rbacContext,...this.props})))}}}RbacContextProvider.__docgenInfo={description:"The related context provider",methods:[{name:"defaultState",docblock:"Returns the default component state",modifiers:["get"],params:[],returns:null,description:"Returns the default component state"},{name:"canIUseUiAction",docblock:"Check if the user can use the given ui action.\n@param {string} actionName The name of the UI action to check for.\n@return {boolean}",modifiers:[],params:[{name:"actionName",description:"The name of the UI action to check for.",type:{name:"string"},optional:!1}],returns:{type:{name:"boolean"}},description:"Check if the user can use the given ui action."}],displayName:"RbacContextProvider",props:{context:{description:"",type:{name:"any"},required:!1},children:{description:"",type:{name:"any"},required:!1}}}},"./src/shared/models/entity/role/role.test.data.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Dm:()=>userRoleDto,ES:()=>TEST_ROLE_ADMIN_ID,bd:()=>adminRoleDto,ol:()=>TEST_ROLE_USER_ID});var uuid__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js");const TEST_ROLE_USER_ID=(0,uuid__WEBPACK_IMPORTED_MODULE_0__.A)(),TEST_ROLE_ADMIN_ID=(0,uuid__WEBPACK_IMPORTED_MODULE_0__.A)(),userRoleDto=data=>({id:TEST_ROLE_USER_ID,name:"user",...data}),adminRoleDto=data=>({id:TEST_ROLE_ADMIN_ID,name:"admin",...data})},"./src/shared/models/entity/role/roleEntity.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _abstract_entityV2__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/models/entity/abstract/entityV2.js");class RoleEntity extends _abstract_entityV2__WEBPACK_IMPORTED_MODULE_0__.A{static getSchema(){return{type:"object",required:["id","name"],properties:{id:{type:"string",format:"uuid"},name:{type:"string",enum:[RoleEntity.ROLE_ADMIN,RoleEntity.ROLE_USER,RoleEntity.ROLE_GUEST,RoleEntity.ROLE_ROOT]},description:{type:"string",maxLength:255},created:{type:"string",format:"date-time"},modified:{type:"string",format:"date-time"}}}}get id(){return this._props.id}get name(){return this._props.name}get description(){return this._props.description||null}get created(){return this._props.created||null}get modified(){return this._props.modified||null}isAdmin(){return this.name===RoleEntity.ROLE_ADMIN}static get ENTITY_NAME(){return"Role"}static get ROLE_ADMIN(){return"admin"}static get ROLE_USER(){return"user"}static get ROLE_GUEST(){return"guest"}static get ROLE_ROOT(){return"root"}}const __WEBPACK_DEFAULT_EXPORT__=RoleEntity},"./src/shared/services/rbacs/controlFunctionEnumeration.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{HJ:()=>controlFunctionResolutions,HK:()=>controlFunctions,Y9:()=>defaultAdminUiActionControlResolution,uy:()=>defaultUserUiActionControlResolution});var allowControlFunction=__webpack_require__("./src/shared/services/rbacs/controlFunctions/allowControlFunction.js"),ControlFunction=__webpack_require__("./src/shared/services/rbacs/controlFunctions/ControlFunction.js");class AllowIfGroupManagerInOneGroupFunction extends ControlFunction.A{static execute(user){return user.groups_users.some((group=>group.is_admin))}}var denyControlFunction=__webpack_require__("./src/shared/services/rbacs/controlFunctions/denyControlFunction.js"),uiActionEnumeration=__webpack_require__("./src/shared/services/rbacs/uiActionEnumeration.js");const controlFunctions={ALLOW:"Allow",DENY:"Deny",ALLOW_IF_GROUP_MANAGER_IN_ONE_GROUP:"AllowIfGroupManagerInOneGroup"},controlFunctionResolutions={[controlFunctions.ALLOW]:allowControlFunction.A,[controlFunctions.DENY]:denyControlFunction.A,[controlFunctions.ALLOW_IF_GROUP_MANAGER_IN_ONE_GROUP]:AllowIfGroupManagerInOneGroupFunction},defaultAdminUiActionControlResolution={[uiActionEnumeration.e.FOLDERS_USE]:controlFunctionResolutions[controlFunctions.ALLOW]},defaultUserUiActionControlResolution={[uiActionEnumeration.e.ADMINSTRATION_VIEW_WORKSPACE]:controlFunctionResolutions[controlFunctions.DENY]}},"./src/shared/services/rbacs/controlFunctions/ControlFunction.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>ControlFunction});class ControlFunction{}},"./src/shared/services/rbacs/controlFunctions/allowControlFunction.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>AllowControlFunction});var _ControlFunction__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/services/rbacs/controlFunctions/ControlFunction.js");class AllowControlFunction extends _ControlFunction__WEBPACK_IMPORTED_MODULE_0__.A{static execute(){return!0}}},"./src/shared/services/rbacs/controlFunctions/denyControlFunction.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>DenyControlFunction});var _ControlFunction__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/shared/services/rbacs/controlFunctions/ControlFunction.js");class DenyControlFunction extends _ControlFunction__WEBPACK_IMPORTED_MODULE_0__.A{static execute(){return!1}}},"./src/shared/services/rbacs/uiActionEnumeration.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{e:()=>uiActions});const uiActions={FOLDERS_USE:"Folders.use",RESOURCES_IMPORT:"Resources.import",RESOURCES_EXPORT:"Resources.export",RESOURCES_SEE_ACTIVITIES:"Resources.seeActivities",RESOURCES_SEE_COMMENTS:"Resources.seeComments",SECRETS_PREVIEW:"Secrets.preview",SECRETS_COPY:"Secrets.copy",SHARE_VIEW_LIST:"Share.viewList",TAGS_USE:"Tags.use",USERS_VIEW_WORKSPACE:"Users.viewWorkspace",MOBILE_TRANSFER:"Mobile.transfer",DESKTOP_TRANSFER:"Desktop.transfer",PROFIL_ACCOUNT_RECOVERY:"Profil.accountRecovery",ADMINSTRATION_VIEW_WORKSPACE:"Administration.viewWorkspace",DUO_CONFIGURATION:"Duo.configuration",AVATAR_UPLOAD:"Avatar.upload",SHARE_FOLDER:"Folders.share"}},"./node_modules/validator/es/lib/util/assertString.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function assertString(input){if(!("string"==typeof input||input instanceof String)){var invalidType=_typeof(input);throw null===input?invalidType="null":"object"===invalidType&&(invalidType=input.constructor.name),new TypeError("Expected a string but received a ".concat(invalidType))}}__webpack_require__.d(__webpack_exports__,{A:()=>assertString})}}]);