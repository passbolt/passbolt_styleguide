/*! For license information please see 1348.9f03e27f.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkpassbolt_styleguide=self.webpackChunkpassbolt_styleguide||[]).push([[1348],{"./src/img/svg/reply.svg":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _path,_path2,_path3,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const __WEBPACK_DEFAULT_EXPORT__=function SvgReply(props){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:19,height:18,fill:"none",viewBox:"0 0 19 18"},props),_path||(_path=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6.755 15a6.75 6.75 0 1 0-2.925-2.925L2.33 16.5z"})),_path2||(_path2=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8.33 11.25 6.08 9l2.25-2.25"})),_path3||(_path3=react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6.08 9h5.25a1.5 1.5 0 0 1 1.5 1.5v.75"})))}},"./src/react-extension/components/ResourceComment/AddResourceComment/AddResourceComment.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_Common_Avatar_UserAvatar__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/react-extension/components/Common/Avatar/UserAvatar.js"),_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/react-extension/contexts/ActionFeedbackContext.js"),prop_types__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_6__),_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),_contexts_LoadingContext__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/react-extension/contexts/LoadingContext.js"),react_i18next__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js");class AddResourceComment extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.getDefaultState(),this.bindCallbacks(),this.createRefs()}componentDidMount(){this.textareaRef.current.focus()}getDefaultState(){return{content:"",actions:{processing:!1},errors:{}}}bindCallbacks(){this.handleSubmitEvent=this.handleSubmitEvent.bind(this),this.handleCancelEvent=this.handleCancelEvent.bind(this),this.handleContentChanged=this.handleContentChanged.bind(this),this.handleEscapeKeyPressed=this.handleEscapeKeyPressed.bind(this)}createRefs(){this.textareaRef=react__WEBPACK_IMPORTED_MODULE_0__.createRef()}get isValid(){return Object.values(this.state.errors).every((value=>!value))}async handleSubmitEvent(event){if(event.preventDefault(),await this.validate(),this.isValid)try{await this.setState({actions:{processing:!0}}),this.props.loadingContext.add();const addedComment=await this.add();await this.handleSubmitSuccess(addedComment)}catch(error){await this.handleSubmitFailure(error)}}async handleSubmitSuccess(addedComment){this.props.loadingContext.remove(),await this.props.actionFeedbackContext.displaySuccess(this.translate("The comment has been added successfully")),this.props.onAdd(addedComment)}async handleSubmitFailure(error){this.props.loadingContext.remove(),await this.props.actionFeedbackContext.displayError(error.message),await this.setState({actions:{processing:!1},errors:{technicalError:error.message}})}handleCancelEvent(){this.props.onCancel()}handleContentChanged(event){this.setState({content:event.target.value})}handleEscapeKeyPressed(event){27===event.keyCode&&this.props.cancellable&&(event.stopPropagation(),this.props.onCancel())}async add(){const commentToAdd=this.state.content.trim(),payload={foreign_key:this.props.resource.id,foreign_model:"Resource",content:commentToAdd,user_id:this.props.context.loggedInUser.id};return await this.props.context.port.request("passbolt.comments.create",payload)}async validate(){const errors={isEmpty:""===this.state.content.trim(),isTooLong:this.state.content.length>256};await this.setState({errors})}get translate(){return this.props.t}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("form",{className:"comment",autoComplete:"off"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"left-column"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Avatar_UserAvatar__WEBPACK_IMPORTED_MODULE_1__.A,{user:this.props.context.loggedInUser,baseUrl:this.props.context.siteSettings.settings.app.url,className:"author profile picture avatar"})),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"right-column"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"form-content"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"input textarea required"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("textarea",{ref:this.textareaRef,placeholder:this.translate("Add a comment"),"aria-required":!0,onChange:this.handleContentChanged,onKeyDown:this.handleEscapeKeyPressed,disabled:this.state.actions.processing}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"error-message"},this.state.errors.isEmpty&&this.translate("A comment is required."),this.state.errors.isTooLong&&this.translate("A comment must be less than 256 characters"),this.state.errors.technicalError)),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"metadata"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",{className:"author username"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_5__.x6,null,"You")),react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",{className:"modified"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_5__.x6,null,"right now"))),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"actions"},this.props.cancellable&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{type:"button",className:"link cancel",onClick:this.handleCancelEvent,disabled:this.state.actions.processing},react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_5__.x6,null,"Cancel"))),react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{className:"button primary comment-submit",type:"submit",onClick:this.handleSubmitEvent,disabled:this.state.actions.processing},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_5__.x6,null,"Save"))))))}}AddResourceComment.propTypes={context:prop_types__WEBPACK_IMPORTED_MODULE_6___default().any,resource:prop_types__WEBPACK_IMPORTED_MODULE_6___default().object,onAdd:prop_types__WEBPACK_IMPORTED_MODULE_6___default().func,onCancel:prop_types__WEBPACK_IMPORTED_MODULE_6___default().func,cancellable:prop_types__WEBPACK_IMPORTED_MODULE_6___default().bool,actionFeedbackContext:prop_types__WEBPACK_IMPORTED_MODULE_6___default().any,loadingContext:prop_types__WEBPACK_IMPORTED_MODULE_6___default().any,t:prop_types__WEBPACK_IMPORTED_MODULE_6___default().func};const __WEBPACK_DEFAULT_EXPORT__=(0,_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_3__.L)((0,_contexts_LoadingContext__WEBPACK_IMPORTED_MODULE_4__.$A)((0,_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_2__.ot)((0,react_i18next__WEBPACK_IMPORTED_MODULE_5__.CI)("common")(AddResourceComment))));AddResourceComment.__docgenInfo={description:"This component allows the current user to add a new comment on a resource",methods:[{name:"getDefaultState",docblock:"Get default state\n@returns {*}",modifiers:[],params:[],returns:{type:{name:"mixed"}},description:"Get default state"},{name:"bindCallbacks",docblock:"Bind callbacks methods",modifiers:[],params:[],returns:null,description:"Bind callbacks methods"},{name:"createRefs",docblock:"Create DOM nodes or React elements references in order to be able to access them programmatically.",modifiers:[],params:[],returns:null,description:"Create DOM nodes or React elements references in order to be able to access them programmatically."},{name:"isValid",docblock:"@returns {boolean} Returns true if the form is valid",modifiers:["get"],params:[],returns:{description:"Returns true if the form is valid",type:{name:"boolean"}},description:null},{name:"handleSubmitEvent",docblock:"Handle the submitting of the new comment\n@param event The event object",modifiers:["async"],params:[{name:"event",description:"The event object",optional:!1}],returns:null,description:"Handle the submitting of the new comment"},{name:"handleSubmitSuccess",docblock:"Whenever the submit action has been successful\n@param addedComment The added comment",modifiers:["async"],params:[{name:"addedComment",description:"The added comment",optional:!1}],returns:null,description:"Whenever the submit action has been successful"},{name:"handleSubmitFailure",docblock:"Whenever the submit action has not been successful\n@param error\n@returns {Promise<void>}",modifiers:["async"],params:[{name:"error",optional:!1}],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Whenever the submit action has not been successful"},{name:"handleCancelEvent",docblock:"Handle the cancellation of the add of the comment",modifiers:[],params:[],returns:null,description:"Handle the cancellation of the add of the comment"},{name:"handleContentChanged",docblock:"Whenever the content has changed\n@param event The DOM event",modifiers:[],params:[{name:"event",description:"The DOM event",optional:!1}],returns:null,description:"Whenever the content has changed"},{name:"handleEscapeKeyPressed",docblock:"Whenever the user press the escape key\n@param event Keypressed event",modifiers:[],params:[{name:"event",description:"Keypressed event",optional:!1}],returns:null,description:"Whenever the user press the escape key"},{name:"add",docblock:"Add a new comment\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Add a new comment"},{name:"validate",docblock:"Validate the form.",modifiers:["async"],params:[],returns:null,description:"Validate the form."},{name:"translate",docblock:"Get the translate function\n@returns {function(...[*]=)}",modifiers:["get"],params:[],returns:{},description:"Get the translate function"}],displayName:"AddResourceComment",props:{context:{description:"",type:{name:"any"},required:!1},resource:{description:"",type:{name:"object"},required:!1},onAdd:{description:"",type:{name:"func"},required:!1},onCancel:{description:"",type:{name:"func"},required:!1},cancellable:{description:"",type:{name:"bool"},required:!1},actionFeedbackContext:{description:"",type:{name:"any"},required:!1},loadingContext:{description:"",type:{name:"any"},required:!1},t:{description:"",type:{name:"func"},required:!1}}}},"./src/react-extension/components/ResourceComment/ConfirmResourceCommentDeletion/ConfirmResourceCommentDeletion.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),prop_types__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_8__),_Common_Inputs_FormSubmitButton_FormSubmitButton__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormSubmitButton.js"),_Common_Inputs_FormSubmitButton_FormCancelButton__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/react-extension/components/Common/Inputs/FormSubmitButton/FormCancelButton.js"),_Common_Dialog_DialogWrapper_DialogWrapper__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/react-extension/components/Common/Dialog/DialogWrapper/DialogWrapper.js"),_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/react-extension/contexts/ActionFeedbackContext.js"),_contexts_LoadingContext__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/react-extension/contexts/LoadingContext.js"),react_i18next__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js");class ConfirmDeleteDialog extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props,context){super(props,context),this.state=this.defaultState,this.bindEventHandlers()}get defaultState(){return{actions:{processing:!1}}}bindEventHandlers(){this.handleClose=this.handleClose.bind(this),this.handleConfirm=this.handleConfirm.bind(this)}async handleConfirm(event){event.preventDefault();try{await this.setState({actions:{processing:!0}}),this.props.loadingContext.add(),await this.props.context.port.request("passbolt.comments.delete",this.props.context.resourceCommentId),this.props.loadingContext.remove(),await this.props.actionFeedbackContext.displaySuccess(this.translate("The comment has been deleted successfully")),await this.setState({actions:{processing:!1}}),this.props.context.setContext({resourceCommentId:null,mustRefreshComments:!0}),this.props.onClose()}catch(error){await this.setState({actions:{processing:!1}}),await this.props.actionFeedbackContext.displayError(error),this.props.context.setContext({resourceCommentId:null,mustRefreshComments:!1}),this.props.onClose()}}handleClose(){this.props.context.setContext({resourceCommentId:null}),this.props.onClose()}get translate(){return this.props.t}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Dialog_DialogWrapper_DialogWrapper__WEBPACK_IMPORTED_MODULE_4__.A,{className:"comment-delete-dialog",title:this.translate("Delete comment?"),onClose:this.handleClose,disabled:this.state.actions.processing},react__WEBPACK_IMPORTED_MODULE_0__.createElement("form",{className:"comment-delete-form",onSubmit:this.handleConfirm,noValidate:!0},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"form-content"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_7__.x6,null,"Are you sure you want to delete the comment?")),react__WEBPACK_IMPORTED_MODULE_0__.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_7__.x6,null,"Once the comment is deleted, it will be removed permanently and will not be recoverable."))),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"submit-wrapper clearfix"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Inputs_FormSubmitButton_FormCancelButton__WEBPACK_IMPORTED_MODULE_3__.A,{disabled:this.state.actions.processing,onClick:this.handleClose}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Common_Inputs_FormSubmitButton_FormSubmitButton__WEBPACK_IMPORTED_MODULE_2__.A,{disabled:this.state.actions.processing,processing:this.state.processing,value:this.translate("Delete"),warning:!0})))))}}ConfirmDeleteDialog.propTypes={context:prop_types__WEBPACK_IMPORTED_MODULE_8___default().any,actionFeedbackContext:prop_types__WEBPACK_IMPORTED_MODULE_8___default().object,loadingContext:prop_types__WEBPACK_IMPORTED_MODULE_8___default().object,onClose:prop_types__WEBPACK_IMPORTED_MODULE_8___default().func,t:prop_types__WEBPACK_IMPORTED_MODULE_8___default().func};const __WEBPACK_DEFAULT_EXPORT__=(0,_shared_context_AppContext_AppContext__WEBPACK_IMPORTED_MODULE_1__.L)((0,_contexts_LoadingContext__WEBPACK_IMPORTED_MODULE_6__.$A)((0,_contexts_ActionFeedbackContext__WEBPACK_IMPORTED_MODULE_5__.ot)((0,react_i18next__WEBPACK_IMPORTED_MODULE_7__.CI)("common")(ConfirmDeleteDialog))));ConfirmDeleteDialog.__docgenInfo={description:"",methods:[{name:"defaultState",docblock:"Return default state\n@returns {Object} default state",modifiers:["get"],params:[],returns:{description:"default state",type:{name:"Object"}},description:"Return default state"},{name:"bindEventHandlers",docblock:"Bind callbacks methods",modifiers:[],params:[],returns:null,description:"Bind callbacks methods"},{name:"handleConfirm",docblock:"Handle the confirm event\n@params {ReactEvent} The react event\n@return {Promise}",modifiers:["async"],params:[{name:"event",optional:!1}],returns:{type:{name:"Promise"}},description:"Handle the confirm event"},{name:"handleClose",docblock:"Handle close button click.",modifiers:[],params:[],returns:null,description:"Handle close button click."},{name:"translate",docblock:"Get the translate function\n@returns {function(...[*]=)}",modifiers:["get"],params:[],returns:{},description:"Get the translate function"}],displayName:"ConfirmDeleteDialog",props:{context:{description:"",type:{name:"any"},required:!1},actionFeedbackContext:{description:"",type:{name:"object"},required:!1},loadingContext:{description:"",type:{name:"object"},required:!1},onClose:{description:"",type:{name:"func"},required:!1},t:{description:"",type:{name:"func"},required:!1}}}},"./src/react-extension/components/ResourceComment/DisplayResourceCommentList/DisplayResourceCommentList.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>DisplayResourceCommentList_DisplayResourceCommentList});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),AppContext=__webpack_require__("./src/shared/context/AppContext/AppContext.js"),UserAvatar=__webpack_require__("./src/react-extension/components/Common/Avatar/UserAvatar.js"),es=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),DialogContext=__webpack_require__("./src/react-extension/contexts/DialogContext.js"),ConfirmResourceCommentDeletion=__webpack_require__("./src/react-extension/components/ResourceComment/ConfirmResourceCommentDeletion/ConfirmResourceCommentDeletion.js"),svg_delete=__webpack_require__("./src/img/svg/delete.svg");class DeleteComment extends react.Component{constructor(props){super(props),this.bindEventHandlers()}bindEventHandlers(){this.delete=this.delete.bind(this)}delete(){this.props.context.setContext({resourceCommentId:this.props.commentId}),this.props.dialogContext.open(ConfirmResourceCommentDeletion.A)}render(){return react.createElement("button",{type:"button",className:"delete-comment button-transparent inline",onClick:this.delete},react.createElement(svg_delete.A,{name:"trash"}))}}DeleteComment.propTypes={context:prop_types_default().any,commentId:prop_types_default().string,dialogContext:prop_types_default().any};const DeleteResourceComment_DeleteComment=(0,AppContext.L)((0,DialogContext.z9)((0,es.CI)("common")(DeleteComment)));DeleteComment.__docgenInfo={description:"This component allows to delete a resource comment ( at least call-to-action )",methods:[{name:"bindEventHandlers",docblock:"Binds the component event handlers",modifiers:[],params:[],returns:null,description:"Binds the component event handlers"},{name:"delete",docblock:"Call to delete the comment",modifiers:[],params:[],returns:null,description:"Call to delete the comment"}],displayName:"DeleteComment",props:{context:{description:"",type:{name:"any"},required:!1},commentId:{description:"",type:{name:"string"},required:!1},dialogContext:{description:"",type:{name:"any"},required:!1}}};var luxon=__webpack_require__("./node_modules/luxon/src/luxon.js"),spinner=__webpack_require__("./src/img/svg/spinner.svg"),dateUtils=__webpack_require__("./src/shared/utils/dateUtils.js"),userUtils=__webpack_require__("./src/shared/utils/userUtils.js");class DisplayResourceCommentList extends react.Component{constructor(props){super(props),this.state=this.getDefaultState()}getDefaultState(){return{comments:[],actions:{loading:!1}}}async componentDidMount(){await this.fetch()}componentDidUpdate(prevProps){this.checkRefresh(prevProps.mustRefresh)}async fetch(){this.setState({actions:{loading:!0}});const resourceId=this.props.resource.id,comments=await this.props.context.port.request("passbolt.comments.find-all-by-resource",resourceId);this.setState({comments:comments.sort(((comment1,comment2)=>luxon.c9.fromISO(comment2.created)<luxon.c9.fromISO(comment1.created)?-1:1))}),this.props.onFetch(comments),this.setState({actions:{loading:!1}})}checkRefresh(previousValue){(this.props.mustRefresh&&!previousValue||this.props.context.mustRefreshComments)&&this.fetch(),this.props.context.mustRefreshComments&&this.props.context.setContext({mustRefreshComments:!1})}canDeleteComment(comment){return this.isOwner(comment)}isOwner(comment){return this.props.context.loggedInUser.id===comment.created_by}isUserSuspended(user){return this.props.context.siteSettings.canIUse("disableUser")&&(0,userUtils.B7)(user)}render(){return react.createElement(react.Fragment,null,!this.state.actions.loading&&react.createElement(react.Fragment,null,this.state.comments.map(((comment,index)=>react.createElement("div",{key:index,className:"comment "+(this.isUserSuspended(comment.creator)?"from-suspended-user":"")},react.createElement("div",{className:"left-column"},react.createElement(UserAvatar.A,{user:comment.creator,baseUrl:this.props.context.siteSettings.settings.app.url,className:"author profile picture avatar"})),react.createElement("div",{className:"right-column"},react.createElement("p",null," ",comment.content," "),react.createElement("div",{className:"metadata"},this.isOwner(comment)&&react.createElement("span",{className:"author username"},react.createElement(es.x6,null,"You")),!this.isOwner(comment)&&react.createElement("span",{className:"author username"},comment.creator.profile.first_name," ",comment.creator.profile.last_name,this.isUserSuspended(comment.creator)&&react.createElement("span",{className:"suspended"}," ",react.createElement(es.x6,null,"(suspended)"))),react.createElement("span",{className:"modified"},(0,dateUtils.kD)(comment.created,this.props.t,this.props.context.locale)),this.canDeleteComment(comment)&&react.createElement("div",{className:"actions"},react.createElement(DeleteResourceComment_DeleteComment,{commentId:comment.id})))))))),this.state.actions.loading&&react.createElement("div",{className:"processing-wrapper"},react.createElement(spinner.A,null),react.createElement("span",{className:"processing-text"},react.createElement(es.x6,null,"Retrieving comments"))))}}const DisplayResourceCommentList_DisplayResourceCommentList=(0,AppContext.L)((0,es.CI)("common")(DisplayResourceCommentList));DisplayResourceCommentList.propTypes={context:prop_types_default().any,resource:prop_types_default().object,onFetch:prop_types_default().func,mustRefresh:prop_types_default().bool,t:prop_types_default().func},DisplayResourceCommentList.__docgenInfo={description:"",methods:[{name:"getDefaultState",docblock:"Get default state\n@returns {*}",modifiers:[],params:[],returns:{type:{name:"mixed"}},description:"Get default state"},{name:"fetch",docblock:"Fetch the comments of the resource",modifiers:["async"],params:[],returns:null,description:"Fetch the comments of the resource"},{name:"checkRefresh",docblock:"Check if the comment list must be refreshed\n@param previousValue The previous props value of the mustRefresh flag",modifiers:[],params:[{name:"previousValue",description:"The previous props value of the mustRefresh flag",optional:!1}],returns:null,description:"Check if the comment list must be refreshed"},{name:"canDeleteComment",docblock:"Returns true if the givne comment can be deleted\n@param comment A comment",modifiers:[],params:[{name:"comment",description:"A comment",optional:!1}],returns:null,description:"Returns true if the givne comment can be deleted"},{name:"isOwner",docblock:"Returns true if the the comment owner is the current logged in user\n@param comment A comment",modifiers:[],params:[{name:"comment",description:"A comment",optional:!1}],returns:null,description:"Returns true if the the comment owner is the current logged in user"},{name:"isUserSuspended",docblock:"Returns true if the feature flag disableUser is enabled and the given user is suspended.\n@param {object} user\n@returns {boolean}",modifiers:[],params:[{name:"user",type:{name:"object"},optional:!1}],returns:{type:{name:"boolean"}},description:"Returns true if the feature flag disableUser is enabled and the given user is suspended."}],displayName:"DisplayResourceCommentList",props:{context:{description:"",type:{name:"any"},required:!1},resource:{description:"",type:{name:"object"},required:!1},onFetch:{description:"",type:{name:"func"},required:!1},mustRefresh:{description:"",type:{name:"bool"},required:!1},t:{description:"",type:{name:"func"},required:!1}}}},"./src/react-extension/components/ResourceDetails/DisplayResourceDetails/DisplayResourceDetailsComment.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_ResourceComment_AddResourceComment_AddResourceComment__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/react-extension/components/ResourceComment/AddResourceComment/AddResourceComment.js"),prop_types__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_8__),_ResourceComment_DisplayResourceCommentList_DisplayResourceCommentList__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/react-extension/components/ResourceComment/DisplayResourceCommentList/DisplayResourceCommentList.js"),_contexts_ResourceWorkspaceContext__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/react-extension/contexts/ResourceWorkspaceContext.js"),react_i18next__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),_img_svg_reply_svg__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/img/svg/reply.svg"),_img_svg_caret_down_svg__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/img/svg/caret_down.svg"),_img_svg_caret_right_svg__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/img/svg/caret_right.svg");class DisplayResourceDetailsComment extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.state=this.getDefaultState(),this.bindCallbacks()}getDefaultState(){return{open:!1,comments:[],canAdd:!1,canAddByIcon:!1,mustRefresh:!1}}componentDidUpdate(prevProps){this.handleResourceChange(prevProps.resourceWorkspaceContext.details.resource)}bindCallbacks(){this.handleTitleClickedEvent=this.handleTitleClickedEvent.bind(this),this.handleAddedEvent=this.handleAddedEvent.bind(this),this.handleCancelledAddEvent=this.handleCancelledAddEvent.bind(this),this.handleRequestedAddEvent=this.handleRequestedAddEvent.bind(this),this.handleFetchedEvent=this.handleFetchedEvent.bind(this)}async handleResourceChange(previousResource){this.state.open&&this.resource.id!==previousResource.id&&await this.setState({mustRefresh:!0})}async handleTitleClickedEvent(){const open=!this.state.open;this.setState({open})}async handleAddedEvent(){await this.setState({mustRefresh:!0,canAdd:!1,canAddByIcon:!0})}async handleCancelledAddEvent(){await this.setState({canAdd:!1})}async handleRequestedAddEvent(){await this.setState({canAdd:!0})}async handleFetchedEvent(comments){const hasComments=comments&&comments.length>0;await this.setState({mustRefresh:!1,canAdd:!hasComments,canAddByIcon:hasComments})}get resource(){return this.props.resourceWorkspaceContext.details.resource}get mustShowAddComment(){return this.state.canAddByIcon&&!this.state.canAdd}render(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"detailed-comments accordion sidebar-section "+(this.state.open?"":"closed")},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"accordion-header"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("h4",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{className:"link no-border",type:"button",onClick:this.handleTitleClickedEvent},react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",{className:"accordion-title"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_4__.x6,null,"Comments")),this.state.open&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_img_svg_caret_down_svg__WEBPACK_IMPORTED_MODULE_6__.A,null),!this.state.open&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_img_svg_caret_right_svg__WEBPACK_IMPORTED_MODULE_7__.A,null)))),this.state.open&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"accordion-content"},this.mustShowAddComment&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"add-comments"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{type:"button",className:"section-action",onClick:this.handleRequestedAddEvent},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_img_svg_reply_svg__WEBPACK_IMPORTED_MODULE_5__.A,null),react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_i18next__WEBPACK_IMPORTED_MODULE_4__.x6,null,"Add comment"))),this.state.canAdd&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ResourceComment_AddResourceComment_AddResourceComment__WEBPACK_IMPORTED_MODULE_1__.A,{resource:this.resource,onAdd:this.handleAddedEvent,onCancel:this.handleCancelledAddEvent,cancellable:this.state.canAddByIcon}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ResourceComment_DisplayResourceCommentList_DisplayResourceCommentList__WEBPACK_IMPORTED_MODULE_2__.A,{resource:this.resource,onFetch:this.handleFetchedEvent,mustRefresh:this.state.mustRefresh})))}}DisplayResourceDetailsComment.propTypes={resourceWorkspaceContext:prop_types__WEBPACK_IMPORTED_MODULE_8___default().any};const __WEBPACK_DEFAULT_EXPORT__=(0,_contexts_ResourceWorkspaceContext__WEBPACK_IMPORTED_MODULE_3__.Qw)((0,react_i18next__WEBPACK_IMPORTED_MODULE_4__.CI)("common")(DisplayResourceDetailsComment));DisplayResourceDetailsComment.__docgenInfo={description:"",methods:[{name:"getDefaultState",docblock:"Get default state\n@returns {*}",modifiers:[],params:[],returns:{type:{name:"mixed"}},description:"Get default state"},{name:"bindCallbacks",docblock:"Bind callbacks methods",modifiers:[],params:[],returns:null,description:"Bind callbacks methods"},{name:"handleResourceChange",docblock:"Check if the resource has changed and fetch\n@param previousResource",modifiers:["async"],params:[{name:"previousResource",optional:!1}],returns:null,description:"Check if the resource has changed and fetch"},{name:"handleTitleClickedEvent",docblock:"Whenever the user clicks on the section title",modifiers:["async"],params:[],returns:null,description:"Whenever the user clicks on the section title"},{name:"handleAddedEvent",docblock:"Whenever the user added a new comment\n@returns {Promise<void>}",modifiers:["async"],params:[],returns:{type:{name:"Promise",elements:[{name:"void"}]}},description:"Whenever the user added a new comment"},{name:"handleCancelledAddEvent",docblock:"Whenever the user cancelled the adding of new comment",modifiers:["async"],params:[],returns:null,description:"Whenever the user cancelled the adding of new comment"},{name:"handleRequestedAddEvent",docblock:"Whenever the user requested to add a new comment ( call-to-action )",modifiers:["async"],params:[],returns:null,description:"Whenever the user requested to add a new comment ( call-to-action )"},{name:"handleFetchedEvent",docblock:"Whenever the comments to display has been fetched\n@param comments The fetched comments",modifiers:["async"],params:[{name:"comments",description:"The fetched comments",optional:!1}],returns:null,description:"Whenever the comments to display has been fetched"},{name:"resource",docblock:"Get the current detailed resource",modifiers:["get"],params:[],returns:null,description:"Get the current detailed resource"},{name:"mustShowAddComment",docblock:"Must show add delete button\n@returns {boolean}",modifiers:["get"],params:[],returns:{type:{name:"boolean"}},description:"Must show add delete button"}],displayName:"DisplayResourceDetailsComment",props:{resourceWorkspaceContext:{description:"",type:{name:"any"},required:!1}}}}}]);